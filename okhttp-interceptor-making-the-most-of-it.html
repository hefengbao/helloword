<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>OkHttp Interceptor - Making the most of it | HelloWorld</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="In this blog, we will learn how to work with the OkHttp Interceptors. We will also see the real use cases where we can use it and how we can use it to get the most of it. In Android, we have so many u">
<meta property="og:type" content="article">
<meta property="og:title" content="OkHttp Interceptor - Making the most of it">
<meta property="og:url" content="https://hefengbao.github.io/helloworld/okhttp-interceptor-making-the-most-of-it.html">
<meta property="og:site_name" content="HelloWorld">
<meta property="og:description" content="In this blog, we will learn how to work with the OkHttp Interceptors. We will also see the real use cases where we can use it and how we can use it to get the most of it. In Android, we have so many u">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://hefengbao.github.io/helloworld/images/okhttp-interceptor-explain.jpg">
<meta property="og:image" content="https://hefengbao.github.io/helloworld/images/okhttp-cache-control-explain.jpg">
<meta property="article:published_time" content="2020-04-02T02:43:50.000Z">
<meta property="article:modified_time" content="2020-04-02T02:43:50.000Z">
<meta property="article:author" content="He Fengbao">
<meta property="article:tag" content="okhttp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hefengbao.github.io/helloworld/images/okhttp-interceptor-explain.jpg">
  
    <link rel="alternate" href="/helloworld/atom.xml" title="HelloWorld" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/helloworld/css/style.css">

<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/helloworld/" id="logo">HelloWorld</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/helloworld/">Home</a>
        
          <a class="main-nav-link" href="/helloworld/archives">Archives</a>
        
          <a class="main-nav-link" href="/helloworld/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/helloworld/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://hefengbao.github.io/helloworld"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-OkHttp-Interceptor-Making-the-most-of-it" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/helloworld/okhttp-interceptor-making-the-most-of-it.html" class="article-date">
  <time datetime="2020-04-02T02:43:50.000Z" itemprop="datePublished">2020-04-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/helloworld/categories/Android/">Android</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      OkHttp Interceptor - Making the most of it
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>In this blog, we will learn how to work with the OkHttp Interceptors. We will also see the real use cases where we can use it and how we can use it to get the most of it. In Android, we have so many use-cases that can be done using the OkHttp Interceptors.</p>
<p>Today, we will cover the following sections to master it:</p>
<ol>
<li>What are Interceptors?</li>
<li>Types of Interceptors.</li>
<li>How to add Interceptors in OkHttpClient?</li>
<li>Creating the Interceptor.</li>
<li>Real use-cases using the Interceptors.</li>
</ol>
<h4 id="What-are-Interceptors"><a href="#What-are-Interceptors" class="headerlink" title="What are Interceptors?"></a>What are Interceptors?</h4><blockquote>
<p>According to documentation, Interceptors are a powerful mechanism that can monitor, rewrite, and retry the API call. So basically, when we do some API call, we can monitor the call or perform some tasks.</p>
</blockquote>
<p>In simple words, Interceptors are like the security personnel in the security check process at the Airport. They check our boarding pass, put a stamp on it and then would allow us to pass.</p>
<img src="/helloworld/images/okhttp-interceptor-explain.jpg" class="">

<p>We can use the interceptors to do so many things, for example, monitor the API calls centrally. Generally, we need to add the logger for each network call, but by using the interceptor, we can add one logger centrally and that will work for all the network calls. Another use-case can be caching the response of network calls to build the offline-first app, we will learn it later in this blog in detail.</p>
<h4 id="Types-of-Interceptors"><a href="#Types-of-Interceptors" class="headerlink" title="Types of Interceptors"></a>Types of Interceptors</h4><p>We have two types of interceptors as follows:</p>
<ul>
<li><strong>Application Interceptors</strong>: These are interceptors that are added between the Application Code(our written code) and the OkHttp Core Library. These are the ones that we add using <strong>addInterceptor().</strong></li>
<li><strong>Network Interceptors:</strong> These are interceptors that are added between the OkHttp Core Library and the Server. These can be added to OkHttpClient using <strong>addNetworkInterceptor().</strong></li>
</ul>
<h4 id="How-to-add-interceptors-in-OkHttpClient"><a href="#How-to-add-interceptors-in-OkHttpClient" class="headerlink" title="How to add interceptors in OkHttpClient?"></a>How to add interceptors in OkHttpClient?</h4><p>While building the <strong>OkHttpClient</strong> object, we can add the interceptor like below:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">fun <span class="title">myHttpClient</span><span class="params">()</span>: OkHttpClient </span>&#123;</span><br><span class="line">    val builder = OkHttpClient().newBuilder()</span><br><span class="line">        .addInterceptor(<span class="comment">/*our interceptor*/</span>)</span><br><span class="line">    <span class="keyword">return</span> builder.build()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Here, in <strong>addInterceptor</strong> we pass the interceptor that we have created. Now, let’s see how to create the Interceptor.</p>
<h4 id="Creating-the-Interceptor"><a href="#Creating-the-Interceptor" class="headerlink" title="Creating the Interceptor"></a>Creating the Interceptor</h4><p>To create the interceptor, we need to create a class by implementing the Interceptor interface like below:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">class MyInterceptor : Interceptor &#123;</span><br><span class="line">    <span class="function">override fun <span class="title">intercept</span><span class="params">(chain: Interceptor.Chain)</span>: Response </span>&#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * Our API Call will be intercepted here</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Here, in the <strong>intercept()</strong>, we can perform any action which we want inside it.</p>
<p>And to use the interceptor, we can use like below:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">fun <span class="title">myHttpClient</span><span class="params">()</span>: OkHttpClient </span>&#123;</span><br><span class="line">    val builder = OkHttpClient().newBuilder()</span><br><span class="line">        .addInterceptor(MyInterceptor())</span><br><span class="line">    <span class="keyword">return</span> builder.build()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>We can add the MyInterceptor in <strong>addInterceptor().</strong></p>
<p>Now, let’s discuss more real use-cases where we can use the Interceptors.</p>
<h4 id="Real-use-cases-using-the-Interceptors"><a href="#Real-use-cases-using-the-Interceptors" class="headerlink" title="Real use-cases using the Interceptors"></a>Real use-cases using the Interceptors</h4><p>The following are the common use-cases in Android:</p>
<h4 id="Logging-the-errors-centrally"><a href="#Logging-the-errors-centrally" class="headerlink" title="Logging the errors centrally"></a><strong>Logging the errors centrally</strong></h4><p>First, we need to create the <strong>ErrorInterceptor</strong> like below:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">class ErrorInterceptor : Interceptor &#123;</span><br><span class="line">    <span class="function">override fun <span class="title">intercept</span><span class="params">(chain: Interceptor.Chain)</span>: Response </span>&#123;</span><br><span class="line"></span><br><span class="line">        val request: Request = chain.request()</span><br><span class="line">        val response = chain.proceed(request)</span><br><span class="line">        when (response.code()) &#123;</span><br><span class="line">            <span class="number">400</span> -&gt; &#123;</span><br><span class="line">                <span class="comment">//Show Bad Request Error Message</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="number">401</span> -&gt; &#123;</span><br><span class="line">                <span class="comment">//Show UnauthorizedError Message</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="number">403</span> -&gt; &#123;</span><br><span class="line">                <span class="comment">//Show Forbidden Message</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="number">404</span> -&gt; &#123;</span><br><span class="line">                <span class="comment">//Show NotFound Message</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// ... and so on</span></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> response</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>First, we get the request from <strong>chain.request()</strong></li>
<li>Then, we get the response returned from the server, by passing the request in <strong>chain.proceed(request)</strong></li>
<li>Now, we can check for the response code and perform an action.</li>
<li>We can pass the error to the view using via the interfaces or by using something like RxJava, EventBus, and etc.</li>
<li>Let’s say if we get a <strong>401 error</strong> i.e. <strong>Unauthorized</strong> then we can perform an action to clear the app data/log out the user or any action which we want to perform.</li>
</ul>
<p>Now, to use this ErrorInterceptor in our OkHttpClient, we can add like below:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.addInterceptor(ErrorInterceptor())</span><br></pre></td></tr></table></figure>

<p>This is how we can create a centralized Error Logger using the Interceptor.</p>
<p>OkHttp has a built-in logger which is very useful for debugging.</p>
<p><a target="_blank" rel="noopener" href="https://blog.mindorks.com/how-to-enable-logging-in-okhttp">To learn more about the built-in logger, click here</a>.</p>
<p><strong>Note:</strong> If we want to log the details for the redirection of URL, consider using the interceptor at the network layer using the <strong>addNetworkInterceptor()</strong>.</p>
<h4 id="Caching-the-response"><a href="#Caching-the-response" class="headerlink" title="Caching the response"></a><strong>Caching the response</strong></h4><p>If we want to cache the response of the API call so that if we call the API again, the response comes out from Cache.</p>
<p>Let’s say we have the API call from Client to Server and <em>Cache-Control</em> header is enabled from the server, then OkHttp Core will respect that header and cache the response for a certain time being which was sent from the server.</p>
<p>But what if the Cache-Control is not enabled from the server. We still can cache the response from OkHttp Client using Interceptor.</p>
<img src="/helloworld/images/okhttp-cache-control-explain.jpg" class="">

<p>Just see the above image. Here, what we have to do is that we have to intercept the Response before going inside the OkHttp Core and add the header (Cache-Control), so it will be treated as if the response(with the Cache-Control header) has come from the server, and OkHttp Core will respect that and cache the response.</p>
<p>We will create an interceptor like below:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">class CacheInterceptor : Interceptor &#123;</span><br><span class="line">    <span class="function">override fun <span class="title">intercept</span><span class="params">(chain: Interceptor.Chain)</span>: Response </span>&#123;</span><br><span class="line">        val response: Response = chain.proceed(chain.request())</span><br><span class="line">        val cacheControl = CacheControl.Builder()</span><br><span class="line">            .maxAge(<span class="number">10</span>, TimeUnit.DAYS)</span><br><span class="line">            .build()</span><br><span class="line">        <span class="keyword">return</span> response.newBuilder()</span><br><span class="line">            .header(<span class="string">&quot;Cache-Control&quot;</span>, cacheControl.toString())</span><br><span class="line">            .build()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Here, we have a CacheControl which is used to provide the header for Cache-Control.</p>
<p>Finally, we can add like below:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.addNetworkInterceptor(CacheInterceptor())</span><br></pre></td></tr></table></figure>

<p>Here, if we see, we are not using the <strong>addInterceptor()</strong> but using <strong>addNetworkInterceptor()</strong> for the use case. This is because in this case, the operation is happening at the network layer.</p>
<p><strong>But, there is something important, we need to consider while building the offline-first app.</strong></p>
<p>The cached response will be returned only when the Internet is available as OkHttp is designed like that.</p>
<ul>
<li>When the Internet is available and data is cached, it returns the data from the cache.</li>
<li><strong>Even when the data is cached</strong> and the Internet is not available, it returns with the error “<em>no internet available</em>“.</li>
</ul>
<p><strong>What to do now?</strong></p>
<p>We can use the following <strong>ForceCacheInterceptor</strong> at the Application layer in addition to the above one <strong>(CacheInterceptor, only if not enabled from the server)</strong>. To implement in the code, we will create a ForceCacheInterceptor like below:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">class ForceCacheInterceptor : Interceptor &#123;</span><br><span class="line">    <span class="function">override fun <span class="title">intercept</span><span class="params">(chain: Interceptor.Chain)</span>: Response </span>&#123;</span><br><span class="line">        val builder: Request.Builder = chain.request().newBuilder()</span><br><span class="line">        <span class="keyword">if</span> (!IsInternetAvailable()) &#123;</span><br><span class="line">            builder.cacheControl(CacheControl.FORCE_CACHE);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> chain.proceed(builder.build());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>We can add the Interceptor in OkHttpClient like below:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.addNetworkInterceptor(CacheInterceptor()) <span class="comment">// only if not enabled from the server</span></span><br><span class="line">.addInterceptor(ForceCacheInterceptor())</span><br></pre></td></tr></table></figure>

<p>Here, we are adding the ForceCacheInterceptor to OkHttpClient using addInterceptor() and not addNetworkInterceptor() as we want it to work on the Application layer.</p>
<h4 id="Adding-the-Header-like-Access-Token-centrally"><a href="#Adding-the-Header-like-Access-Token-centrally" class="headerlink" title="Adding the Header like Access Token centrally"></a><strong>Adding the Header like Access Token centrally</strong></h4><p>Let’s say that we have to make the API calls and we have to add Authorization Header in all the API calls. Either we can use it individually or we can centralize that using the Interceptor.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">class AuthTokenInterceptor : Interceptor &#123;</span><br><span class="line">    <span class="function">override fun <span class="title">intercept</span><span class="params">(chain: Interceptor.Chain)</span>: Response </span>&#123;</span><br><span class="line"></span><br><span class="line">        val originalRequest = chain.request()</span><br><span class="line">        val requestBuilder = originalRequest.newBuilder()</span><br><span class="line">            .header(<span class="string">&quot;Authorization&quot;</span>, <span class="string">&quot;AuthToken&quot;</span>)</span><br><span class="line">        val request = requestBuilder.build()</span><br><span class="line">        <span class="keyword">return</span> chain.proceed(request)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>First, we get the token for the header from our local storage like a SharedPreference.</li>
<li>Here, we intercept the original request which we triggered from the application using <strong>chain.reques</strong>t() and set it to <strong>originalRequest.</strong></li>
<li>Then, we build the request again by adding the <strong>Header</strong> with the key and value which is required to make the network call.</li>
<li>Then, we will build the request again and return the response using <strong>chain.proceed(request)</strong> by passing the new request which is having the Authorization header.</li>
</ul>
<p>This is how we can centralize the Header which is common in all the API Calls. Now to use it in the OkHttpClient, we will do like below:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.addInterceptor(AuthTokenInterceptor())</span><br></pre></td></tr></table></figure>

<p>Let’s go to another use-case.</p>
<h4 id="Refreshing-the-Access-Token-at-Single-Place"><a href="#Refreshing-the-Access-Token-at-Single-Place" class="headerlink" title="Refreshing the Access Token at Single Place"></a><strong>Refreshing the Access Token at Single Place</strong></h4><p>Let us say we have a use-case that when we get a <strong>401 error</strong> in the Error Interceptor and we need to refresh the auth token as we have an Unauthorized error. We can do that using the below:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">override fun <span class="title">intercept</span><span class="params">(chain: Interceptor.Chain)</span>: Response </span>&#123;</span><br><span class="line"></span><br><span class="line">    val accessToken = <span class="comment">//our access Token</span></span><br><span class="line">    val request = chain.request().newBuilder()</span><br><span class="line">        .addHeader(<span class="string">&quot;Authorization&quot;</span>, accessToken)</span><br><span class="line">        .build()</span><br><span class="line">    val response = chain.proceed(request)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (response.code() == <span class="number">401</span>) &#123;</span><br><span class="line">            val newToken: String = <span class="comment">//fetch from some other source</span></span><br><span class="line">            <span class="keyword">if</span> (newToken != <span class="keyword">null</span>) &#123;</span><br><span class="line">               val newRequest =  chain.request().newBuilder()</span><br><span class="line">                    .addHeader(<span class="string">&quot;Authorization&quot;</span>, newToken)</span><br><span class="line">                    .build()</span><br><span class="line">                <span class="keyword">return</span> chain.proceed(newRequest)</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> response</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>If we get the response.code() as <strong>401</strong> i.e. <strong>Unauthorized,</strong> we will refresh the token here, then modify the request by adding the new header and make the new request to the server.</li>
</ul>
<p><strong>Note:</strong> Another way that is more flexible when it comes to refreshing the Access Token is to use the Authenticator interface of OkHttp.</p>
<p>Now, let’s move to another use-case.</p>
<h4 id="Enabling-Gzip-at-Android-End"><a href="#Enabling-Gzip-at-Android-End" class="headerlink" title="Enabling Gzip at Android End"></a><strong>Enabling Gzip at Android End</strong></h4><p>Gzip is used for data compression. In Android as well, we can use the Gzip for the compression using the interceptor.</p>
<p>So, while getting a response, OkHttp automatically respects the header (<strong>content encoding</strong>) and decompresses the data and returns, but let’s say when we have to send compressed data to a server, then we have to write our own interceptor.</p>
<p>We can find the <strong>GzipRequestInterceptor</strong> class <strong><a target="_blank" rel="noopener" href="https://github.com/amitshekhariitbhu/Fast-Android-Networking/blob/master/android-networking/src/main/java/com/androidnetworking/interceptors/GzipRequestInterceptor.java">here</a></strong>.</p>
<p>To use the interceptor we can use like below:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.addInterceptor(GzipRequestInterceptor())</span><br></pre></td></tr></table></figure>

<p>So, these are the real use-cases, how can we use the interceptors in our Android App. We can do a lot of things with interceptors. Let’s start making the most of it.</p>
<p>来源：</p>
<p><a target="_blank" rel="noopener" href="https://blog.mindorks.com/okhttp-interceptor-making-the-most-of-it">https://blog.mindorks.com/okhttp-interceptor-making-the-most-of-it</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://hefengbao.github.io/helloworld/okhttp-interceptor-making-the-most-of-it.html" data-id="ckpqdom9r00cf1r8jdtidbgdk" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/helloworld/tags/okhttp/" rel="tag">okhttp</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/helloworld/how-to-enable-logging-in-okhttp.html" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          How to enable logging in OkHttp ?
        
      </div>
    </a>
  
  
    <a href="/helloworld/windows-10-php-env.html" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">windows10 搭建 php 环境</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Android/">Android</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Database/">Database</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Database/MySQL/">MySQL</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Database/Oracle/">Oracle</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Gradle/">Gradle</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Hexo/">Hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Java/">Java</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/JavaScript/">JavaScript</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Kotlin/">Kotlin</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Linux/">Linux</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Linux/Ubuntu/">Ubuntu</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/PHP/">PHP</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/PHP/Laravel/">Laravel</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Server/">Server</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Server/LNMP/">LNMP</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Server/MinIO/">MinIO</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Server/Nginx/">Nginx</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Server/Redis/">Redis</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Server/Supervisor/">Supervisor</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Server/WAMP/">WAMP</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Vue/">Vue</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Web/">Web</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Web/HTML/">HTML</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Windows/">Windows</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/%E5%B7%A5%E5%85%B7/">工具</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/%E5%B7%A5%E5%85%B7/Composer/">Composer</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/%E5%B7%A5%E5%85%B7/PhpStorm/">PhpStorm</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/">版本控制</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/Git/">Git</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/Gitlab/">Gitlab</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/VisualSVN/">VisualSVN</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/%E8%B5%84%E6%96%99/">资料</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/JavaScript/" rel="tag">JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/LNMP/" rel="tag">LNMP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/Laravel/" rel="tag">Laravel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/MinIO/" rel="tag">MinIO</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/OAuth-2-0/" rel="tag">OAuth 2.0</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/VisualSVN/" rel="tag">VisualSVN</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/WAMP/" rel="tag">WAMP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/android/" rel="tag">android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/android-studio/" rel="tag">android-studio</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/composer/" rel="tag">composer</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/crontab/" rel="tag">crontab</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/database/" rel="tag">database</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/elasticsearch/" rel="tag">elasticsearch</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/ffmpeg/" rel="tag">ffmpeg</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/git/" rel="tag">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/gitlab/" rel="tag">gitlab</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/gradle/" rel="tag">gradle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/hexo/" rel="tag">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/homestead/" rel="tag">homestead</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/html/" rel="tag">html</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/http/" rel="tag">http</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/iptables/" rel="tag">iptables</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/java/" rel="tag">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/josn-ld/" rel="tag">josn-ld</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/json/" rel="tag">json</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/kotlin/" rel="tag">kotlin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/laravel/" rel="tag">laravel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/mysql/" rel="tag">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/nginx/" rel="tag">nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/okhttp/" rel="tag">okhttp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/oracle/" rel="tag">oracle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/pdo-oci/" rel="tag">pdo_oci</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/php/" rel="tag">php</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/phpmyadmin/" rel="tag">phpmyadmin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/phpstorm/" rel="tag">phpstorm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/plsql/" rel="tag">plsql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/proguard/" rel="tag">proguard</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/redis/" rel="tag">redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/room/" rel="tag">room</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/server/" rel="tag">server</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/snowflake/" rel="tag">snowflake</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/supervisor/" rel="tag">supervisor</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/ubuntu/" rel="tag">ubuntu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/vscode/" rel="tag">vscode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/vue/" rel="tag">vue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/vue-router/" rel="tag">vue-router</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/web/" rel="tag">web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/wsl/" rel="tag">wsl</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/zmq/" rel="tag">zmq</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/" rel="tag">微服务</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/%E6%95%B0%E6%8D%AE%E9%9B%86/" rel="tag">数据集</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/%E8%B5%84%E6%96%99/" rel="tag">资料</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2/" rel="tag">项目部署</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/helloworld/tags/JavaScript/" style="font-size: 10px;">JavaScript</a> <a href="/helloworld/tags/LNMP/" style="font-size: 10px;">LNMP</a> <a href="/helloworld/tags/Laravel/" style="font-size: 10px;">Laravel</a> <a href="/helloworld/tags/MinIO/" style="font-size: 10px;">MinIO</a> <a href="/helloworld/tags/OAuth-2-0/" style="font-size: 10px;">OAuth 2.0</a> <a href="/helloworld/tags/VisualSVN/" style="font-size: 10px;">VisualSVN</a> <a href="/helloworld/tags/WAMP/" style="font-size: 13.33px;">WAMP</a> <a href="/helloworld/tags/android/" style="font-size: 18.33px;">android</a> <a href="/helloworld/tags/android-studio/" style="font-size: 10px;">android-studio</a> <a href="/helloworld/tags/composer/" style="font-size: 13.33px;">composer</a> <a href="/helloworld/tags/crontab/" style="font-size: 10px;">crontab</a> <a href="/helloworld/tags/database/" style="font-size: 10px;">database</a> <a href="/helloworld/tags/elasticsearch/" style="font-size: 10px;">elasticsearch</a> <a href="/helloworld/tags/ffmpeg/" style="font-size: 10px;">ffmpeg</a> <a href="/helloworld/tags/git/" style="font-size: 11.67px;">git</a> <a href="/helloworld/tags/gitlab/" style="font-size: 11.67px;">gitlab</a> <a href="/helloworld/tags/gradle/" style="font-size: 10px;">gradle</a> <a href="/helloworld/tags/hexo/" style="font-size: 11.67px;">hexo</a> <a href="/helloworld/tags/homestead/" style="font-size: 11.67px;">homestead</a> <a href="/helloworld/tags/html/" style="font-size: 10px;">html</a> <a href="/helloworld/tags/http/" style="font-size: 10px;">http</a> <a href="/helloworld/tags/iptables/" style="font-size: 10px;">iptables</a> <a href="/helloworld/tags/java/" style="font-size: 10px;">java</a> <a href="/helloworld/tags/josn-ld/" style="font-size: 10px;">josn-ld</a> <a href="/helloworld/tags/json/" style="font-size: 10px;">json</a> <a href="/helloworld/tags/kotlin/" style="font-size: 20px;">kotlin</a> <a href="/helloworld/tags/laravel/" style="font-size: 16.67px;">laravel</a> <a href="/helloworld/tags/linux/" style="font-size: 15px;">linux</a> <a href="/helloworld/tags/mysql/" style="font-size: 13.33px;">mysql</a> <a href="/helloworld/tags/nginx/" style="font-size: 11.67px;">nginx</a> <a href="/helloworld/tags/okhttp/" style="font-size: 11.67px;">okhttp</a> <a href="/helloworld/tags/oracle/" style="font-size: 13.33px;">oracle</a> <a href="/helloworld/tags/pdo-oci/" style="font-size: 10px;">pdo_oci</a> <a href="/helloworld/tags/php/" style="font-size: 13.33px;">php</a> <a href="/helloworld/tags/phpmyadmin/" style="font-size: 10px;">phpmyadmin</a> <a href="/helloworld/tags/phpstorm/" style="font-size: 10px;">phpstorm</a> <a href="/helloworld/tags/plsql/" style="font-size: 10px;">plsql</a> <a href="/helloworld/tags/proguard/" style="font-size: 10px;">proguard</a> <a href="/helloworld/tags/redis/" style="font-size: 11.67px;">redis</a> <a href="/helloworld/tags/room/" style="font-size: 10px;">room</a> <a href="/helloworld/tags/server/" style="font-size: 10px;">server</a> <a href="/helloworld/tags/snowflake/" style="font-size: 10px;">snowflake</a> <a href="/helloworld/tags/supervisor/" style="font-size: 10px;">supervisor</a> <a href="/helloworld/tags/ubuntu/" style="font-size: 13.33px;">ubuntu</a> <a href="/helloworld/tags/vscode/" style="font-size: 10px;">vscode</a> <a href="/helloworld/tags/vue/" style="font-size: 11.67px;">vue</a> <a href="/helloworld/tags/vue-router/" style="font-size: 10px;">vue-router</a> <a href="/helloworld/tags/web/" style="font-size: 10px;">web</a> <a href="/helloworld/tags/wsl/" style="font-size: 11.67px;">wsl</a> <a href="/helloworld/tags/zmq/" style="font-size: 10px;">zmq</a> <a href="/helloworld/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/" style="font-size: 10px;">微服务</a> <a href="/helloworld/tags/%E6%95%B0%E6%8D%AE%E9%9B%86/" style="font-size: 10px;">数据集</a> <a href="/helloworld/tags/%E8%B5%84%E6%96%99/" style="font-size: 13.33px;">资料</a> <a href="/helloworld/tags/%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2/" style="font-size: 10px;">项目部署</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2021/06/">六月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2021/03/">三月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2021/02/">二月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2020/12/">十二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2020/11/">十一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2020/08/">八月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2020/06/">六月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2020/05/">五月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2020/04/">四月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2020/02/">二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2020/01/">一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2019/12/">十二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2019/11/">十一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2019/10/">十月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2019/08/">八月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2019/07/">七月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2019/06/">六月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2019/05/">五月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2019/04/">四月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2019/03/">三月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2019/02/">二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2019/01/">一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2018/12/">十二月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2018/11/">十一月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2018/09/">九月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2018/08/">八月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2018/07/">七月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2018/06/">六月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2018/05/">五月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2018/04/">四月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2018/03/">三月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2017/11/">十一月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2017/10/">十月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2017/08/">八月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2017/07/">七月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2017/06/">六月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2017/05/">五月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2017/04/">四月 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/helloworld/wsl.html">wsl</a>
          </li>
        
          <li>
            <a href="/helloworld/android-webview.html">Android Webview</a>
          </li>
        
          <li>
            <a href="/helloworld/android-constraintlayout.html">Android ConstraintLayout</a>
          </li>
        
          <li>
            <a href="/helloworld/android-media.html">Android Media</a>
          </li>
        
          <li>
            <a href="/helloworld/android-fragment.html">Android Fragment</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 He Fengbao<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/helloworld/" class="mobile-nav-link">Home</a>
  
    <a href="/helloworld/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/helloworld/about" class="mobile-nav-link">About</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/helloworld/fancybox/jquery.fancybox.css">

  
<script src="/helloworld/fancybox/jquery.fancybox.pack.js"></script>




<script src="/helloworld/js/script.js"></script>




  </div>
</body>
</html>