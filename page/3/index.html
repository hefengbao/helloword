<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>HelloWorld</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="好记性不如烂笔头，保存在收藏夹里的链接，过段时间后就可能打不开了，摘录是不错的保存方式。">
<meta property="og:type" content="website">
<meta property="og:title" content="HelloWorld">
<meta property="og:url" content="https://hefengbao.github.io/helloworld/page/3/index.html">
<meta property="og:site_name" content="HelloWorld">
<meta property="og:description" content="好记性不如烂笔头，保存在收藏夹里的链接，过段时间后就可能打不开了，摘录是不错的保存方式。">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="He Fengbao">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/helloworld/atom.xml" title="HelloWorld" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/helloworld/css/style.css">

<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/helloworld/" id="logo">HelloWorld</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/helloworld/">Home</a>
        
          <a class="main-nav-link" href="/helloworld/archives">Archives</a>
        
          <a class="main-nav-link" href="/helloworld/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/helloworld/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://hefengbao.github.io/helloworld"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-Android-Styling-Prefer-Theme-Attributes" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/helloworld/android-styling-prefer-theme-attributes.html" class="article-date">
  <time datetime="2020-08-02T07:12:58.000Z" itemprop="datePublished">2020-08-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/helloworld/categories/Android/">Android</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/helloworld/android-styling-prefer-theme-attributes.html">Android Styling: Prefer Theme Attributes</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>In the previous posts in this series on Android styling, we looked at the difference between themes and styles and why it’s a good idea to factor out things that you wish to vary by theme and common theme attributes to use:</p>
<p><a target="_blank" rel="noopener" href="https://medium.com/androiddevelopers/android-styling-themes-vs-styles-ebe05f917578">Android Styling: Themes vs StylesThe Android styling system offers a powerful way to specify your app’s visual design, but it can be easy to misuse…medium.com</a></p>
<p><a target="_blank" rel="noopener" href="https://medium.com/androiddevelopers/android-styling-common-theme-attributes-8f7c50c9eaba">Android Styling: Common Theme AttributesIn the previous article in this series on Android styling, we looked at the difference between themes and styles and…medium.com</a></p>
<p>This enables us to create fewer layouts or styles, isolating changes within a theme. In practice, you largely want to vary colors by theme and as such you should always* refer to colors via theme attributes.</p>
<blockquote>
<p><em>Always\</em> refer to colors via theme attributes*</p>
</blockquote>
<p>That means you can consider code like this to be a smell:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Copyright 2019 Google LLC.	</span></span><br><span class="line"><span class="comment">   SPDX-License-Identifier: Apache-2.0 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">View</span> …</span></span><br><span class="line"><span class="tag">  <span class="attr">android:background</span>=<span class="string">&quot;@color/white&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://gist.github.com/nickbutcher/c4cc6ee85d8f53c95dfb07a49c73bd1d#file-prefer_theme_attrs_color_res-xml">prefer_theme_attrs_color_res.xml</a> hosted with ❤ by <a target="_blank" rel="noopener" href="https://github.com/">GitHub</a></p>
<p>Instead you should refer to a theme attribute, allowing you to vary the color by theme, for example, providing a different value in <a target="_blank" rel="noopener" href="https://developer.android.com/guide/topics/ui/look-and-feel/darktheme">dark theme</a>:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Copyright 2019 Google LLC.	</span></span><br><span class="line"><span class="comment">   SPDX-License-Identifier: Apache-2.0 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">View</span> …</span></span><br><span class="line"><span class="tag">  <span class="attr">android:background</span>=<span class="string">&quot;?attr/colorSurface&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://gist.github.com/nickbutcher/7886005615abde4d3b196f192dc961da#file-prefer_theme_attrs_color_attr-xml">prefer_theme_attrs_color_attr.xml</a> hosted with ❤ by <a target="_blank" rel="noopener" href="https://github.com/">GitHub</a></p>
<p>Even if you’re not currently supporting alternate themes (what–no dark theme??), I’d recommend following this approach as it’ll make adopting theming much easier.</p>
<h1 id="Qualified-Colors"><a href="#Qualified-Colors" class="headerlink" title="Qualified Colors?"></a>Qualified Colors?</h1><p>You <em>can</em> vary colors by providing alternate values in different configurations (e.g. <code>@color/foo</code> defined in both <code>res/**values**/colors.xml</code> and an alternate value set in <code>res/**values-night**/colors.xml</code>) but I’d recommend using theme attributes instead.</p>
<p>Varying at the color layer forces you to give <strong>semantic names</strong> to colors i.e. you likely wouldn’t name a color <code>@color/white</code> and provide a dark variant in the <code>-night</code> configuration — that would be pretty confusing. Instead you might be tempted to use a <em>semantic</em> name, like <code>@color/background</code>. The problem with this is that it combines both the declaration of the color and providing the value. As such it gives no indication that this can or will vary by theme.</p>
<p>Varying <code>@colors</code> can also encourage you to create more colors. If a different situation calls for a new semantically named color with the same value (i.e. not a background but should be the same color), then you still need to create a new entry in your colors file.</p>
<p>By using a theme attribute we separate the declaration of semantic colors from providing their values and make call-sites clearer that the color will vary by theme (as they use the <code>?attr/</code> syntax). Keeping your color declarations to literally named values encourages you to define a palette of colors used by your app and vary them at the theme level, keeping your colors file small and maintainable.</p>
<blockquote>
<p><em>Define a palette of colors used by your app and vary them at the theme level</em></p>
</blockquote>
<p>The added benefit of this approach is that layouts/styles referring to these colors become more reusable. Because themes can be overlaid or varied, the indirection means you don’t need to create alternate layouts or styles just to vary some colors — you can use the same layouts with a different theme.</p>
<h1 id="Always"><a href="#Always" class="headerlink" title="Always?"></a>Always?</h1><p>I placed an asterix on <em>“always\</em> refer to colors via theme attributes”* because there may be occasions where you explicitly don’t want to vary a color by theme. For example, the <a target="_blank" rel="noopener" href="https://material.io/design/color/dark-theme.html#ui-application">Material Design guidelines</a> call out occasions where you may wish to use the same brand color in both light and dark themes.</p>
<img src="/helloworld/images/2020080207.png" class="">

<p>In these rare cases, it’s perfectly valid to refer directly to a color resource:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Copyright 2019 Google LLC.	</span></span><br><span class="line"><span class="comment">   SPDX-License-Identifier: Apache-2.0 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">FloatingActionButton</span> …</span></span><br><span class="line"><span class="tag">  <span class="attr">app:backgroundTint</span>=<span class="string">&quot;@color/owl_pink_500&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://gist.github.com/nickbutcher/2264b82b8d36eb1d9fd67c80dd25b940#file-prefer_theme_attrs_constant_color_exception-xml">prefer_theme_attrs_constant_color_exception.xml</a> hosted with ❤ by <a target="_blank" rel="noopener" href="https://github.com/">GitHub</a></p>
<h1 id="State-of-the-art"><a href="#State-of-the-art" class="headerlink" title="State of the art"></a>State of the art</h1><p>Another situation where you might not refer directly to a theme attribute in your layouts/styles is when using <code>ColorStateList</code><a target="_blank" rel="noopener" href="https://developer.android.com/reference/android/content/res/ColorStateList">s</a>.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Copyright 2019 Google LLC.	</span></span><br><span class="line"><span class="comment">   SPDX-License-Identifier: Apache-2.0 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">View</span> …</span></span><br><span class="line"><span class="tag">  <span class="attr">android:background</span>=<span class="string">&quot;@color/primary_20&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://gist.github.com/nickbutcher/4b6969e1d21b0f02fa20604d2926569b#file-prefer_theme_attrs_csl_exception-xml">prefer_theme_attrs_csl_exception.xml</a> hosted with ❤ by <a target="_blank" rel="noopener" href="https://github.com/">GitHub</a></p>
<p>This might be valid if <code>primary_20</code> is a <code>ColorStateList</code> which itself refers to theme attributes for the color values (see below). While commonly used to provide different colors in different states (pressed, disabled etc) <code>ColorStateList</code>s have another capability that can be useful for theming. They let you specify an alpha value to be applied to a color:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Copyright 2019 Google LLC.	</span></span><br><span class="line"><span class="comment">   SPDX-License-Identifier: Apache-2.0 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">selector</span> …</span></span><br><span class="line">  &lt;item android:alpha=&quot;0.20&quot; android:color=&quot;?attr/colorPrimary&quot; /&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">selector</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://gist.github.com/nickbutcher/d5f6466cb68e6cdfeb5bf21b9d98d8cb#file-prefer_theme_attrs_csl-xml">prefer_theme_attrs_csl.xml</a> hosted with ❤ by <a target="_blank" rel="noopener" href="https://github.com/">GitHub</a></p>
<p>This kind of single-item-<code>ColorStateList</code> (i.e. only supplying a single, default color, not different colors per state) helps reduce the number of color resources that you need to maintain. That is rather than defining a new color resource that manually sets an alpha value on your primary color (per configuration!) instead this alters whatever <code>colorPrimary</code> is in the current theme. If your primary color changes you only need to update it in a single place, not hunting down all instances of where it has been tweaked.</p>
<p>While useful, there are some caveats to this technique to be aware of.</p>
<p>\1. If the specified color <em>also</em> has an alpha value, then the alphas are <em>combined</em> e.g. applying 50% alpha to 50% opaque white would yield 25% white:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Copyright 2019 Google LLC.	</span></span><br><span class="line"><span class="comment">   SPDX-License-Identifier: Apache-2.0 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">selector</span> …</span></span><br><span class="line">  &lt;item android:alpha=&quot;0.50&quot; android:color=&quot;#80ffffff&quot; /&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">selector</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://gist.github.com/nickbutcher/06d23f5814992c449a793e9c7768039c#file-prefer_theme_attrs_csl_combined_alpha-xml">prefer_theme_attrs_csl_combined_alpha.xml</a> hosted with ❤ by <a target="_blank" rel="noopener" href="https://github.com/">GitHub</a></p>
<p>For this reason, it’s preferable to specify theme colors as fully opaque and use <code>ColorStateList</code>s to modify their alphas.</p>
<p>\2. The alpha component was only added in API 23 so if your min sdk is lower than this, be sure to use <code>AppCompatResources.getColorStateList</code> which backports this behavior (and always use the <code>android:alpha</code> namespace, never the <code>app:alpha</code> namespace).</p>
<p>\3. Often we use a shorthand to set a color as a drawable e.g.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Copyright 2019 Google LLC.	</span></span><br><span class="line"><span class="comment">   SPDX-License-Identifier: Apache-2.0 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">View</span> …</span></span><br><span class="line"><span class="tag">  <span class="attr">android:background</span>=<span class="string">&quot;@color/foo&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://gist.github.com/nickbutcher/ae17cd8bc8030bec7c330ad0d93746ef#file-prefer_theme_attrs_view_background_color-xml">prefer_theme_attrs_view_background_color.xml</a> hosted with ❤ by <a target="_blank" rel="noopener" href="https://github.com/">GitHub</a></p>
<p>A <code>View</code>’s background is a drawable, this shorthand coerces the given color to a <code>ColorDrawable</code>. However there is no way to convert a <code>ColorStateList</code> to a <code>Drawable</code> (before API 29 when <code>ColorStateListDrawable</code> was introduced to solve this issue). We can however work around this restriction:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Copyright 2019 Google LLC.	</span></span><br><span class="line"><span class="comment">   SPDX-License-Identifier: Apache-2.0 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">View</span> …</span></span><br><span class="line"><span class="tag">  <span class="attr">android:background</span>=<span class="string">&quot;@drawable/a_solid_white_rectangle_shape_drawable&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">app:backgroundTint</span>=<span class="string">&quot;@color/some_color_state_list&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://gist.github.com/nickbutcher/ffffbe1b63a23147d1cc878098867084#file-prefer_theme_attrs_view_background_tint-xml">prefer_theme_attrs_view_background_tint.xml</a> hosted with ❤ by <a target="_blank" rel="noopener" href="https://github.com/">GitHub</a></p>
<p>Be sure that your background tint supports the states your view needs e.g. if it needs to change when disabled.</p>
<h1 id="Enforcement"><a href="#Enforcement" class="headerlink" title="Enforcement"></a>Enforcement</h1><p>So you’re convinced that you should be using theme attributes and <code>ColorStateList</code>s, but how do you enforce this across your codebase or team? You can try to be vigilant during code reviews but this doesn’t scale well. A better approach is to rely on tooling to catch this. This article outlines how to add a lint check to look for literal color uses and could be extended to cover all advice in this article:</p>
<p><a target="_blank" rel="noopener" href="https://proandroiddev.com/making-android-lint-theme-aware-6285737b13bc">Making Android Lint Theme AwareUse Android Lint API to identify screens and drawable not ready for dark theme. Also, use it to maintain dark theme…proandroiddev.com</a></p>
<h1 id="Be-Indirect"><a href="#Be-Indirect" class="headerlink" title="Be Indirect"></a>Be Indirect</h1><p>Using theme attributes and <code>ColorStateList</code>s to factor colors out to your theme makes your layouts and styles more <em>flexible</em>, promoting reuse and keeping your codebase lean and maintainable.</p>
<p>Join us in the next post where we’ll look more at using themes and how they interact:</p>
<p><a target="_blank" rel="noopener" href="https://medium.com/androiddevelopers/android-styling-themes-overlay-1ffd57745207">Android Styling: Themes OverlayIn previous articles in this series on Android styling, we’ve looked at the difference between styles and themes…medium.com
  </a></p>
<p><a target="_blank" rel="noopener" href="https://medium.com/androiddevelopers/android-styling-prefer-theme-attributes-412caa748774">https://medium.com/androiddevelopers/android-styling-prefer-theme-attributes-412caa748774</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://hefengbao.github.io/helloworld/android-styling-prefer-theme-attributes.html" data-id="ckpqdomad00eo1r8jbuxl3mzc" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/helloworld/tags/android/" rel="tag">android</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Android-Styling-Common-Theme-Attributes" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/helloworld/android-styling-common-theme-attributes.html" class="article-date">
  <time datetime="2020-08-02T07:12:25.000Z" itemprop="datePublished">2020-08-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/helloworld/categories/Android/">Android</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/helloworld/android-styling-common-theme-attributes.html">Android Styling: Common Theme Attributes</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>In the previous article in this series on Android styling, we looked at the difference between themes and styles and how themes allow you to write more flexible styles and layouts which isolate changes:</p>
<p><a target="_blank" rel="noopener" href="https://medium.com/androiddevelopers/android-styling-themes-vs-styles-ebe05f917578">Android Styling: Themes vs StylesThe Android styling system offers a powerful way to specify your app’s visual design, but it can be easy to misuse…medium.com</a></p>
<p>Specifically we recommended using theme attributes to provide a point of indirection to resources, so that you can vary them (e.g. in <a target="_blank" rel="noopener" href="https://developer.android.com/guide/topics/ui/look-and-feel/darktheme">dark theme</a>). That is, if you find yourself writing a direct resource reference (or worse yet, a hardcoded value 😱) in a layout or style, consider if you should use a theme attribute instead.</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;!-- Copyright 2019 Google LLC.	</span><br><span class="line">   SPDX-License-Identifier: Apache-2.0 --&gt;</span><br><span class="line">&lt;ConstraintLayout ...</span><br><span class="line"><span class="deletion">-  android:foreground=&quot;@drawable/some_ripple&quot;</span></span><br><span class="line"><span class="deletion">-  android:background=&quot;@color/blue&quot; /&gt;</span></span><br><span class="line"><span class="addition">+  android:foreground=&quot;?attr/selectableItemBackground&quot;</span></span><br><span class="line"><span class="addition">+  android:background=&quot;?attr/colorPrimarySurface&quot; /&gt;</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://gist.github.com/nickbutcher/7975a81a31afa7bebfc17d2e825168d3#file-common_theme_attrs_prefer-xml-diff">common_theme_attrs_prefer.xml.diff</a> hosted with ❤ by <a target="_blank" rel="noopener" href="https://github.com/">GitHub</a></p>
<p>But what theme attributes are available to use? This post highlights the common ones that you should know about; those that come from Material, AppCompat or the platform. This is not a complete list (for that I’d recommend browsing the attrs files linked below where they are defined) but these are the attributes that I use all the time.</p>
<h1 id="Colors"><a href="#Colors" class="headerlink" title="Colors"></a>Colors</h1><p>Many of these colors come from the <a target="_blank" rel="noopener" href="https://material.io/design/color/">Material color system</a>, which defines semantic names for colors that you can use throughout your app (<a target="_blank" rel="noopener" href="https://material.io/develop/android/theming/color">implemented as theme attrs</a>).</p>
<img src="/helloworld/images/2020080202.png" class="">

<ul>
<li><code>?attr/colorPrimary</code> The primary branding color for the app.</li>
<li><code>?attr/colorSecondary</code> The secondary branding color for the app, usually a bright complement to the primary branding color.</li>
<li><code>?attr/colorOn[Primary, Secondary, Surface etc]</code> A color which contrasts against the named color.</li>
<li><code>?attr/color[Primary, Secondary]Variant</code> An alternate shade of the given color.</li>
<li><code>?attr/colorSurface</code> A color for surfaces of components, such as cards, sheets, and menus.</li>
<li><code>?android:attr/colorBackground</code> The background for the screen.</li>
<li><code>?attr/colorPrimarySurface</code> switches between <code>colorPrimary</code> in the Light themes, <code>colorSurface</code> in the Dark theme.</li>
<li><code>?attr/colorError</code> A color for displaying errors.</li>
</ul>
<p>Other handy colors:</p>
<ul>
<li><code>?attr/colorControlNormal</code> The color applied to icons/controls in their normal state.</li>
<li><code>?attr/colorControlActivated</code> The color applied to icons/controls in their activated state (e.g. checked).</li>
<li><code>?attr/colorControlHighlight</code> The color applied to control highlights (e.g. ripples, list selectors).</li>
<li><code>?android:attr/textColorPrimary</code> The most prominent text color.</li>
<li><code>?android:attr/textColorSecondary</code> Secondary text color.</li>
</ul>
<h1 id="Dimens"><a href="#Dimens" class="headerlink" title="Dimens"></a>Dimens</h1><ul>
<li><code>?attr/listPreferredItemHeight</code> Standard (min) height for list items.</li>
<li><code>?attr/actionBarSize</code> The height of a toolbar.</li>
</ul>
<h1 id="Drawables"><a href="#Drawables" class="headerlink" title="Drawables"></a>Drawables</h1><ul>
<li><code>?attr/selectableItemBackground</code> A ripple/highlight for interactive items (also handy for foregrounds!!)</li>
<li><code>?attr/selectableItemBackgroundBorderless</code> An unbounded ripple.</li>
<li><code>?attr/dividerVertical</code> A drawable that may be used as a vertical divider between visual elements.</li>
<li><code>?attr/dividerHorizontal</code> A drawable that may be used as a horizontal divider between visual elements.</li>
</ul>
<h1 id="TextAppearances"><a href="#TextAppearances" class="headerlink" title="TextAppearances"></a>TextAppearances</h1><p>Material <a target="_blank" rel="noopener" href="https://material.io/design/typography/the-type-system.html#type-scale">defines</a> a type scale — a discrete set of text styles that you should use throughout your app, each of which is <a target="_blank" rel="noopener" href="https://material.io/develop/android/theming/typography/">provided</a> as a theme attribute which can be set as a <code>textAppearance</code>. Check out the <a target="_blank" rel="noopener" href="https://material.io/design/typography/the-type-system.html#">Material type scale generator</a> to help generate a scale for different fonts.</p>
<img src="/helloworld/images/2020080203.png" class="">

<ul>
<li><code>?attr/textAppearanceHeadline1</code> defaults to light 96sp text.</li>
<li><code>?attr/textAppearanceHeadline2</code> defaults to light 60sp text.</li>
<li><code>?attr/textAppearanceHeadline3</code> defaults to regular 48sp text.</li>
<li><code>?attr/textAppearanceHeadline4</code> defaults to regular 34sp text.</li>
<li><code>?attr/textAppearanceHeadline5</code> defaults to regular 24sp text.</li>
<li><code>?attr/textAppearanceHeadline6</code> defaults to medium 20sp text.</li>
<li><code>?attr/textAppearanceSubtitle1</code> defaults to regular 16sp text.</li>
<li><code>?attr/textAppearanceSubtitle2</code> defaults to medium 14sp text.</li>
<li><code>?attr/textAppearanceBody1</code> defaults to regular 16sp text.</li>
<li><code>?attr/textAppearanceBody2</code> defaults to regular 14sp text.</li>
<li><code>?attr/textAppearanceCaption</code> defaults to regular 12sp text.</li>
<li><code>?attr/textAppearanceButton</code> defaults to medium all caps 14sp text.</li>
<li><code>?attr/textAppearanceOverline</code> defaults to regular all caps 10sp text.</li>
</ul>
<h1 id="Shape"><a href="#Shape" class="headerlink" title="Shape"></a>Shape</h1><p>Material employs a <a target="_blank" rel="noopener" href="https://material.io/design/shape">shape system</a> which is <a target="_blank" rel="noopener" href="https://material.io/develop/android/theming/shape/">implemented</a> as theme attrs for small, medium and large components. Note that if you’re setting a shape appearance on a custom component, you likely want to use a <code>MaterialShapeDrawable</code> as it’s background which understands and implements the shaping.</p>
<img src="/helloworld/images/2020080204.png" class="">

<ul>
<li><code>?attr/shapeAppearanceSmallComponent</code> used for Buttons, Chips, Text Fields etc. Defaults to rounded 4dp corners.</li>
<li><code>?attr/shapeAppearanceMediumComponent</code> used for Cards, Dialogs, Date Pickers etc. Defaults to rounded 4dp corners.</li>
<li><code>?attr/shapeAppearanceLargeComponent</code> used for Bottom Sheets etc. Defaults to rounded 0dp corners (i.e. square!)</li>
</ul>
<h1 id="Button-Styles"><a href="#Button-Styles" class="headerlink" title="Button Styles"></a>Button Styles</h1><img src="/helloworld/images/2020080205.png" class="">

<p>This might seem super specific, but Material defines three <em>types</em> of buttons: <a target="_blank" rel="noopener" href="https://material.io/components/buttons/#contained-button">Contained</a>, <a target="_blank" rel="noopener" href="https://material.io/components/buttons/#text-button">Text</a> and <a target="_blank" rel="noopener" href="https://material.io/components/buttons/#outlined-button">Outlined</a>. MDC offers theme attrs that you can use to set the <code>style</code> of a <code>MaterialButton</code>:</p>
<ul>
<li><code>?attr/materialButtonStyle</code> defaults to contained (or just omit the style).</li>
<li><code>?attr/borderlessButtonStyle</code> for a text style button.</li>
<li><code>?attr/materialButtonOutlinedStyle</code> for outlined style.</li>
</ul>
<h1 id="Floats"><a href="#Floats" class="headerlink" title="Floats"></a>Floats</h1><ul>
<li><code>?android:attr/disabledAlpha</code> Default disabled alpha for widgets.</li>
<li><code>?android:attr/primaryContentAlpha</code> The alpha applied to the foreground elements.</li>
<li><code>?android:attr/secondaryContentAlpha</code> The alpha applied to secondary elements.</li>
</ul>
<h1 id="App-vs-Android-namespace"><a href="#App-vs-Android-namespace" class="headerlink" title="App vs Android namespace"></a>App vs Android namespace</h1><p>You might have noticed that some attributes are referenced by<br><code>?**android**:attr/foo</code> and others just by <code>?attr/bar</code>. This is because some are defined by the Android platform, and as such you need the <code>android</code> part to reference them by their namespace (just like with view attributes in layouts: <code>android:id</code>). Those without come from static libraries (i.e. AppCompat or MDC) which are compiled into your application, so don’t need the namespace (similar to how you might use <code>app:baz</code> in a layout). Some elements are defined <em>both</em> in the platform and in a library e.g. <code>colorPrimary</code>. In these cases, prefer the non-platform version, as this can be used on all API levels i.e. they’re duplicated in a library precisely to backport them. In these cases, I’ve listed the non-platform versions above.</p>
<blockquote>
<p>prefer non-platform attributes which can be used on all API levels</p>
</blockquote>
<h1 id="More-Resources"><a href="#More-Resources" class="headerlink" title="More Resources"></a>More Resources</h1><p>For a complete list of the theme attributes available to use, go to the source of truth:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://android.googlesource.com/platform/frameworks/base/+/refs/heads/master/core/res/res/values/attrs.xml">Android platform</a></li>
<li><a target="_blank" rel="noopener" href="https://android.googlesource.com/platform/frameworks/support/+/androidx-master-dev/appcompat/appcompat/src/main/res/values/attrs.xml">AppCompat</a></li>
</ul>
<p>Material Design Components:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/material-components/material-components-android/blob/master/lib/java/com/google/android/material/color/res/values/attrs.xml">Color</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/material-components/material-components-android/blob/master/lib/java/com/google/android/material/shape/res/values/attrs.xml">Shape</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/material-components/material-components-android/blob/master/lib/java/com/google/android/material/typography/res/values/attrs.xml">Type</a></li>
</ul>
<h1 id="Do-It-Yourself"><a href="#Do-It-Yourself" class="headerlink" title="Do It Yourself"></a>Do It Yourself</h1><p>Sometimes there isn’t a theme attribute which abstracts something you’d like to vary by theme. No worries… create your own! Here’s an example from the <a target="_blank" rel="noopener" href="https://github.com/google/iosched">Google I/O app</a> which shows a list of conference sessions in two screens.</p>
<img src="/helloworld/images/2020080206.png" class="">

<p>Two screens listing conference sessions</p>
<p>They’re largely similar but the left screen must leave space for the sticky time headers while the right screen does not. We implemented this by abstracting where to align items behind a theme attribute so that we can vary them by theme and use the same layout across two different screens:</p>
<p>\1. Define the theme attribute in <a target="_blank" rel="noopener" href="https://github.com/google/iosched/blob/89df01ebc19d9a46495baac4690c2ebfa74946dc/mobile/src/main/res/values/attrs.xml#L41">attrs.xml</a></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Copyright 2019 Google LLC.	</span></span><br><span class="line"><span class="comment">   SPDX-License-Identifier: Apache-2.0 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">&quot;sessionListKeyline&quot;</span> <span class="attr">format</span>=<span class="string">&quot;dimension&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://gist.github.com/nickbutcher/05fa9dcf1e344dab77edc06e68dc85c0#file-common_theme_attrs_custom_attr-xml">common_theme_attrs_custom_attr.xml</a> hosted with ❤ by <a target="_blank" rel="noopener" href="https://github.com/">GitHub</a></p>
<p>\2. Provide <a target="_blank" rel="noopener" href="https://github.com/google/iosched/blob/89df01ebc19d9a46495baac4690c2ebfa74946dc/mobile/src/main/res/values/themes.xml#L51">different</a> <a target="_blank" rel="noopener" href="https://github.com/google/iosched/blob/89df01ebc19d9a46495baac4690c2ebfa74946dc/mobile/src/main/res/values/themes.xml#L78">values</a> in different themes:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Copyright 2019 Google LLC.	</span></span><br><span class="line"><span class="comment">   SPDX-License-Identifier: Apache-2.0 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">&quot;Theme.IOSched.Schedule&quot;</span>&gt;</span></span><br><span class="line">  …</span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">&quot;sessionListKeyline&quot;</span>&gt;</span>72dp<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">&quot;Theme.IOSched.Speaker&quot;</span>&gt;</span></span><br><span class="line">  …</span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">&quot;sessionListKeyline&quot;</span>&gt;</span>16dp<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://gist.github.com/nickbutcher/f34af81ac45d2db42e88ed44ff055f79#file-common_theme_attrs_custom_attr_values-xml">common_theme_attrs_custom_attr_values.xml</a> hosted with ❤ by <a target="_blank" rel="noopener" href="https://github.com/">GitHub</a></p>
<p>\3. <a target="_blank" rel="noopener" href="https://github.com/google/iosched/blob/89df01ebc19d9a46495baac4690c2ebfa74946dc/mobile/src/main/res/layout/item_session.xml#L61">Use</a> the theme attr in the <em>single</em> layout used on <strong>both</strong> screens (each using one of the above themes):</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Copyright 2019 Google LLC.	</span></span><br><span class="line"><span class="comment">   SPDX-License-Identifier: Apache-2.0 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Guideline</span> …</span></span><br><span class="line"><span class="tag">  <span class="attr">app:layout_constraintGuide_begin</span>=<span class="string">&quot;?attr/sessionListKeyline&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://gist.github.com/nickbutcher/0402c4f66a7c41935245f3566aee5239#file-common_theme_attrs_custom_attr_usage-xml">common_theme_attrs_custom_attr_usage.xml</a> hosted with ❤ by <a target="_blank" rel="noopener" href="https://github.com/">GitHub</a></p>
<h1 id="Question-mark-everything"><a href="#Question-mark-everything" class="headerlink" title="Question (mark) everything"></a>Question (mark) everything</h1><p>Knowing what theme attributes are available, equips you to use them when writing your layouts, styles or drawables. Using theme attributes makes it much easier to support theming (like <a target="_blank" rel="noopener" href="https://developer.android.com/guide/topics/ui/look-and-feel/darktheme">dark theme</a>) and to write more flexible, maintainable code. For a deep dive on this, join us in our next post in this series:</p>
<p><a target="_blank" rel="noopener" href="https://medium.com/androiddevelopers/android-styling-prefer-theme-attributes-412caa748774">Android Styling: Prefer Theme AttributesTheme attribute all the thingsmedium.com
  </a></p>
<p><a target="_blank" rel="noopener" href="https://medium.com/androiddevelopers/android-styling-common-theme-attributes-8f7c50c9eaba">https://medium.com/androiddevelopers/android-styling-common-theme-attributes-8f7c50c9eaba</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://hefengbao.github.io/helloworld/android-styling-common-theme-attributes.html" data-id="ckpqdomab00eh1r8jdo276he2" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/helloworld/tags/android/" rel="tag">android</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Android-Styling-Themes-vs-Styles" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/helloworld/android-styling-themes-vs-styles.html" class="article-date">
  <time datetime="2020-08-02T06:56:10.000Z" itemprop="datePublished">2020-08-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/helloworld/categories/Android/">Android</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/helloworld/android-styling-themes-vs-styles.html">Android Styling: Themes vs Styles</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>The <a target="_blank" rel="noopener" href="https://developer.android.com/guide/topics/ui/look-and-feel/themes">Android styling system</a> offers a powerful way to specify your app’s visual design, but it can be easy to misuse. Proper use of it can make themes and styles easier to maintain, make branding updates less scary and make it straightforward to support dark modes. This is the first in a series of articles where <a target="_blank" rel="noopener" href="https://medium.com/u/9303277cb6db?source=post_page-----ebe05f917578----------------------">Chris Banes</a> and I will set out to demystify Android styling so that you can make stylish apps without pulling your hair out.</p>
<p>In this first article, I’ll take a look at the building blocks of the styling system: themes and styles.</p>
<h1 id="Theme-Style"><a href="#Theme-Style" class="headerlink" title="Theme != Style"></a>Theme != Style</h1><p>Both themes and styles use the same <code>&lt;style&gt;</code> syntax but serve very different purposes. You can think of both as key-value stores where the keys are attributes and the values are resources. Let’s take a look at each.</p>
<h1 id="What’s-in-a-style"><a href="#What’s-in-a-style" class="headerlink" title="What’s in a style?"></a>What’s in a style?</h1><p>A style is a collection of view attribute values. You can think of a style as a <code>Map&lt;**view** attribute, resource&gt;</code>. That is the keys are all view attributes i.e. attributes that a widget declares and you might set in a layout file. Styles are specific to a single type of widget because different widgets support different sets of attributes:</p>
<blockquote>
<p>Styles are a collection of view attributes; specific to a single type of widget</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Copyright 2019 Google LLC.	</span></span><br><span class="line"><span class="comment">   SPDX-License-Identifier: Apache-2.0 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">&quot;Widget.Plaid.Button.InlineAction&quot;</span> <span class="attr">parent</span>=<span class="string">&quot;…&quot;</span>&gt;</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">&quot;android:gravity&quot;</span>&gt;</span>center_horizontal<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">&quot;android:textAppearance&quot;</span>&gt;</span>@style/TextAppearance.CommentAuthor<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">&quot;android:drawablePadding&quot;</span>&gt;</span>@dimen/spacing_micro<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://gist.github.com/nickbutcher/209ed867f74ac5cd251f68dba7e0da18#file-themes_vs_styles_style-xml">themes_vs_styles_style.xml</a> hosted with ❤ by <a target="_blank" rel="noopener" href="https://github.com/">GitHub</a></p>
<p>As you can see, each of the keys in the style are things you <em>could</em> set in a layout:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Copyright 2019 Google LLC.	</span></span><br><span class="line"><span class="comment">   SPDX-License-Identifier: Apache-2.0 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Button</span> …</span></span><br><span class="line"><span class="tag">  <span class="attr">android:gravity</span>=<span class="string">&quot;center_horizontal&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">android:textAppearance</span>=<span class="string">&quot;@style/TextAppearance.CommentAuthor&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">android:drawablePadding</span>=<span class="string">&quot;@dimen/spacing_micro&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://gist.github.com/nickbutcher/e904e2e3008de4285f56540539332bf8#file-themes_vs_styles_view_attrs-xml">themes_vs_styles_view_attrs.xml</a> hosted with ❤ by <a target="_blank" rel="noopener" href="https://github.com/">GitHub</a></p>
<p>Extracting them to a style makes it easy to reuse across multiple views and maintain.</p>
<h1 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h1><p>Styles are used by individual views from a layout:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Copyright 2019 Google LLC.	</span></span><br><span class="line"><span class="comment">   SPDX-License-Identifier: Apache-2.0 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Button</span> …</span></span><br><span class="line"><span class="tag">  <span class="attr">style</span>=<span class="string">&quot;@style/Widget.Plaid.Button.InlineAction&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://gist.github.com/nickbutcher/e111751dc60c0a72c2550bee28ced9b3#file-themes_vs_styles_style_usage-xml">themes_vs_styles_style_usage.xml</a> hosted with ❤ by <a target="_blank" rel="noopener" href="https://github.com/">GitHub</a></p>
<p>Views can only apply a single style — contrast this to other styling systems such as css on the web where components can set multiple css classes.</p>
<h1 id="Scope"><a href="#Scope" class="headerlink" title="Scope"></a>Scope</h1><p>A style applied to a view <strong>only</strong> applies to <em>that</em> view, not to any of its children. For example, if you have a <code>ViewGroup</code> with three buttons, setting the <code>InlineAction</code> style on the <code>ViewGroup</code> will not apply that style to the buttons. The values provided by the style are combined with those set directly in the layout (resolved using the <a target="_blank" rel="noopener" href="https://medium.com/androiddevelopers/whats-your-text-s-appearance-f3a1729192d">styling precedence order</a>).</p>
<h1 id="What’s-a-theme"><a href="#What’s-a-theme" class="headerlink" title="What’s a theme?"></a>What’s a theme?</h1><p>A theme is a collection of named resources which can be referenced later by styles, layouts etc. They provide semantic names to Android resources so you can refer to them later e.g. <code>colorPrimary</code> is a semantic name for a given color:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Copyright 2019 Google LLC.	</span></span><br><span class="line"><span class="comment">   SPDX-License-Identifier: Apache-2.0 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">&quot;Theme.Plaid&quot;</span> <span class="attr">parent</span>=<span class="string">&quot;…&quot;</span>&gt;</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">&quot;colorPrimary&quot;</span>&gt;</span>@color/teal_500<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">&quot;colorSecondary&quot;</span>&gt;</span>@color/pink_200<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">&quot;android:windowBackground&quot;</span>&gt;</span>@color/white<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://gist.github.com/nickbutcher/09471e60710519ad78b50df783601497#file-themes_vs_styles_theme-xml">themes_vs_styles_theme.xml</a> hosted with ❤ by <a target="_blank" rel="noopener" href="https://github.com/">GitHub</a></p>
<p>These named resources are known as theme attributes, so a theme is <code>Map&lt;**theme** attribute, resource&gt;</code>. Theme attributes are different from view attributes because they’re not properties specific to an individual view type but <em>semantically named</em> pointers to values which are applicable more broadly in an app. A theme provides concrete values for these named resources. In the example above the <code>colorPrimary</code> attribute specifies that the primary color for this theme is teal. By abstracting the resource with a theme, we can provide different concrete values (such as <code>colorPrimary</code>=orange) in different themes.</p>
<blockquote>
<p>Themes are a collection of named resources, useful broadly across an app</p>
</blockquote>
<p>A theme is similar to an interface. Programming to an interface allows you to decouple the public contract from the implementation allowing you to provide <em>different</em> implementations. Themes play a similar role; by writing our layouts and styles against theme attributes, we can use them under different themes, providing different concrete resources.</p>
<p>Roughly equivalent pseudo-code:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Copyright 2019 Google LLC.	</span></span><br><span class="line"><span class="comment">   SPDX-License-Identifier: Apache-2.0 */</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">ColorPalette</span> </span>&#123;</span><br><span class="line">  <span class="meta">@ColorInt</span> <span class="keyword">val</span> colorPrimary</span><br><span class="line">  <span class="meta">@ColorInt</span> <span class="keyword">val</span> colorSecondary</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyView</span></span>(colors: ColorPalette) &#123;</span><br><span class="line">  fab.backgroundTint = colors.colorPrimary</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://gist.github.com/nickbutcher/60b03553e278ed6f4c35d26cc2c59a39#file-themes_vs_styles_theme_psuedo_interface-kt">themes_vs_styles_theme_psuedo_interface.kt</a> hosted with ❤ by <a target="_blank" rel="noopener" href="https://github.com/">GitHub</a></p>
<p>Which allows you to vary the way that <code>MyView</code> is rendered, without having to create variants of it:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Copyright 2019 Google LLC.	</span></span><br><span class="line"><span class="comment">   SPDX-License-Identifier: Apache-2.0 */</span></span><br><span class="line"><span class="keyword">val</span> lightPalette = <span class="keyword">object</span> : ColorPalette &#123; … &#125;</span><br><span class="line"><span class="keyword">val</span> darkPalette = <span class="keyword">object</span> : ColorPalette &#123; … &#125;</span><br><span class="line"><span class="keyword">val</span> view = MyView(<span class="keyword">if</span> (isDarkTheme) darkPalette <span class="keyword">else</span> lightPalette)</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://gist.github.com/nickbutcher/e491315b05af92c8bb0816ae6848364e#file-themes_vs_styles_theme_psuedo_interface_usage-kt">themes_vs_styles_theme_psuedo_interface_usage.kt</a> hosted with ❤ by <a target="_blank" rel="noopener" href="https://github.com/">GitHub</a></p>
<h1 id="Usage-1"><a href="#Usage-1" class="headerlink" title="Usage"></a>Usage</h1><p>You can specify a theme on components which have (or are) a <code>Context</code> e.g. <code>Activity</code> or <code>Views</code>/<code>ViewGroup</code>s:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Copyright 2019 Google LLC.	</span></span><br><span class="line"><span class="comment">   SPDX-License-Identifier: Apache-2.0 --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- AndroidManifest.xml --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">application</span> …</span></span><br><span class="line"><span class="tag">  <span class="attr">android:theme</span>=<span class="string">&quot;@style/Theme.Plaid&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">activity</span> …</span></span><br><span class="line"><span class="tag">  <span class="attr">android:theme</span>=<span class="string">&quot;@style/Theme.Plaid.About&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- layout/foo.xml --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ConstraintLayout</span> …</span></span><br><span class="line"><span class="tag">  <span class="attr">android:theme</span>=<span class="string">&quot;@style/Theme.Plaid.Foo&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://gist.github.com/nickbutcher/d5db6c5329c390999739fa9c352cb4a0#file-themes_vs_styles_theme_usage-xml">themes_vs_styles_theme_usage.xml</a> hosted with ❤ by <a target="_blank" rel="noopener" href="https://github.com/">GitHub</a></p>
<p>You can also set a theme in code by wrapping an existing <code>Context</code> with a <code>ContextThemeWrapper</code> which you could then use to <a target="_blank" rel="noopener" href="https://developer.android.com/reference/android/view/LayoutInflater.html#from(android.content.Context)">inflate</a> a layout etc.</p>
<p>The power of themes really comes from how you use them; you can build more flexible widgets by referencing theme attributes. Different themes provide concrete values at a later time. For example, you might wish to set a background color on a section of your view hierarchy:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Copyright 2019 Google LLC.	</span></span><br><span class="line"><span class="comment">   SPDX-License-Identifier: Apache-2.0 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ViewGroup</span> …</span></span><br><span class="line"><span class="tag">  <span class="attr">android:background</span>=<span class="string">&quot;?attr/colorSurface&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://gist.github.com/nickbutcher/b5bc28be5c8cdd297b5ae59de1780fc5#file-themes_vs_styles_theme_attr_usage-xml">themes_vs_styles_theme_attr_usage.xml</a> hosted with ❤ by <a target="_blank" rel="noopener" href="https://github.com/">GitHub</a></p>
<p>Rather than setting a static color (<code>#ffffff</code> or a <code>@color</code> resource) we can delegate to the theme by using the <code>?attr/themeAttributeName</code> syntax. This syntax means: query the theme for the value of this semantic attribute. This level of indirection allows us to provide different behavior (e.g. providing a different background color in light and dark themes) without having to create multiple layouts or styles which are mostly identical but for a few color variations. It isolates the elements that are changing within the theme.</p>
<blockquote>
<p>Use the <code>?attr/themeAttributeName</code> syntax to query the theme for the value of this semantic attribute</p>
</blockquote>
<h1 id="Scope-1"><a href="#Scope-1" class="headerlink" title="Scope"></a>Scope</h1><p>A <code>Theme</code> is accessed as a property of a <code>Context</code> and can be obtained from any object which is or has a <code>Context</code> e.g. <code>Activity</code>, <code>View</code> or <code>ViewGroup</code>. These objects exist in a tree, where an <code>Activity</code> contains <code>ViewGroup</code>s which contain <code>View</code>s etc. Specifying a theme at any level of this tree cascades to descendent nodes e.g. setting a theme on a <code>ViewGroup</code> applies to all the <code>View</code>s within it (in contrast to styles which only apply to a single view).</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Copyright 2019 Google LLC.	</span></span><br><span class="line"><span class="comment">   SPDX-License-Identifier: Apache-2.0 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ViewGroup</span> …</span></span><br><span class="line"><span class="tag">  <span class="attr">android:theme</span>=<span class="string">&quot;@style/Theme.App.SomeTheme&quot;</span>&gt;</span></span><br><span class="line">  &lt;! - SomeTheme also applies to all child views. --&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">ViewGroup</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://gist.github.com/nickbutcher/20860aef17375f16a86ee0ac2ca5e729#file-themes_vs_styles_theme_cascade-xml">themes_vs_styles_theme_cascade.xml</a> hosted with ❤ by <a target="_blank" rel="noopener" href="https://github.com/">GitHub</a></p>
<p>This can be extremely useful, say if you want a dark themed section of an otherwise light screen. Read more about this behavior <a target="_blank" rel="noopener" href="https://medium.com/androiddevelopers/android-styling-themes-overlay-1ffd57745207">here</a>.</p>
<p>Note that this behavior only applies at layout inflation time. While <code>Context</code> offers a <code>setTheme</code> method, or <code>Theme</code> offers an <code>applyStyle</code> method, these need to be called <em>before</em> inflation. Setting a new theme or applying a style after inflation will not update existing views.</p>
<h1 id="Separate-Concerns"><a href="#Separate-Concerns" class="headerlink" title="Separate Concerns"></a>Separate Concerns</h1><p>Understanding the different responsibilities and the interaction of styles and themes, helps to keep your styling resources more manageable.</p>
<p>For example, say you have a blue theme for your app, but some Pro screens get a fancy purple look <strong>and</strong> you want to provide <a target="_blank" rel="noopener" href="https://developer.android.com/guide/topics/ui/look-and-feel/darktheme">dark themes</a> with tweaked colors. If you tried to achieve this using only styles, you would have to create 4 styles for the permutations of Pro/non-Pro and light/dark. As styles are specific to a type of view (<code>Button</code>, <code>Switch</code> etc) you’d need to create these permutations for each view type in your app.</p>
<img src="/helloworld/images/2020080201.png" class="" title="Exploding permutations of widgets&#x2F;styles without theming">

<p>Exploding permutations of widgets/styles without theming</p>
<p>If instead we use styles <strong>and</strong> themes we can isolate the parts which alter by theme as theme attributes so we only need to define a single style per view type. For the above example we might define 4 themes which each provide different values for the <code>colorPrimary</code> theme attribute, which these styles then refer to and automatically reflect the correct value from the theme.</p>
<p>This approach might seem more complicated as you need to consider the interaction of styles and themes, but it has the benefit of isolating the parts that change per theme. So if your app rebrands from blue to orange, you only need to change this in a single place, not scattered throughout your styling. It also helps fight a proliferation of styles. Ideally you only have a small number of styles per view type. If you don’t take advantage of theming, it’s easy for your <code>styles.xml</code> file to get out of hand and explode with different variations of similar styles, which becomes a maintenance headache.</p>
<p>Join us in the next article where we explore some common theme attributes and how to create your own:</p>
<p><a target="_blank" rel="noopener" href="https://medium.com/androiddevelopers/android-styling-common-theme-attributes-8f7c50c9eaba">Android Styling: Common Theme AttributesIn the previous article in this series on Android styling, we looked at the difference between themes and styles and…medium.com
  </a></p>
<p><a target="_blank" rel="noopener" href="https://medium.com/androiddevelopers/android-styling-themes-vs-styles-ebe05f917578">https://medium.com/androiddevelopers/android-styling-themes-vs-styles-ebe05f917578</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://hefengbao.github.io/helloworld/android-styling-themes-vs-styles.html" data-id="ckpqdomaa00ed1r8jhh6h69tv" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/helloworld/tags/android/" rel="tag">android</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Gradle" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/helloworld/gradle.html" class="article-date">
  <time datetime="2020-08-01T06:07:36.000Z" itemprop="datePublished">2020-08-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/helloworld/categories/Gradle/">Gradle</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/helloworld/gradle.html">Gradle</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>下载：</p>
<p><a target="_blank" rel="noopener" href="https://downloads.gradle-dn.com/distributions/gradle-5.6.4-all.zip">https://downloads.gradle-dn.com/distributions/gradle-5.6.4-all.zip</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://hefengbao.github.io/helloworld/gradle.html" data-id="ckpqdoma900e91r8j3ojkcdby" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/helloworld/tags/gradle/" rel="tag">gradle</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Laravel-学习资料" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/helloworld/laravel-resource.html" class="article-date">
  <time datetime="2020-06-09T11:19:46.000Z" itemprop="datePublished">2020-06-09</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/helloworld/categories/PHP/">PHP</a>►<a class="article-category-link" href="/helloworld/categories/PHP/Laravel/">Laravel</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/helloworld/laravel-resource.html">Laravel 学习资料</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="https://xueyuanjun.com/books/laravel-from-appreciate-to-artisan">Laravel 从学徒到工匠</a></p>
<p><a target="_blank" rel="noopener" href="https://learnku.com/laravel/t/45370">快速上手 Laravel 的 100 个小技巧</a></p>
<p><a target="_blank" rel="noopener" href="https://laraveldaily.com/8-tricks-with-laravel-timestamps/">https://laraveldaily.com/8-tricks-with-laravel-timestamps/</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://hefengbao.github.io/helloworld/laravel-resource.html" data-id="ckpqdoma800e61r8j1j21bacw" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/helloworld/tags/laravel/" rel="tag">laravel</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Android多国语言文件夹汇总" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/helloworld/android-multi-language.html" class="article-date">
  <time datetime="2020-06-01T03:21:53.000Z" itemprop="datePublished">2020-06-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/helloworld/categories/Android/">Android</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/helloworld/android-multi-language.html">Android多国语言文件夹汇总</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Arabic, Egypt (ar-rEG) —————————–阿拉伯语，埃及<br>Arabic, Israel (ar-rIL) ——————————-阿拉伯语，以色列<br>Bulgarian, Bulgaria (bg-rBG) ———————保加利亚语，保加利亚<br>Catalan, Spain (ca-rES) —————————加泰隆语，西班牙<br>Czech, Czech Republic (cs-rCZ) —————–捷克语，捷克共和国<br>Danish, Denmark(da-rDK) ————————丹麦语，丹麦<br>German, Austria (de-rAT) ————————-德语，奥地利<br>German, Switzerland (de-rCH) ——————-德语，瑞士<br>German, Germany (de-rDE) ———————-德语，德国<br>German, Liechtenstein (de-rLI) ——————德语，列支敦士登的<br>Greek, Greece (el-rGR) —————————-希腊语，希腊<br>English, Australia (en-rAU) ————————-英语，澳大利亚<br>English, Canada (en-rCA) ————————–英语，加拿大<br>English, Britain (en-rGB) —————————-英语，英国<br>English, Ireland (en-rIE) —————————–英语，爱尔兰<br>English, India (en-rIN) ——————————–英语，印度<br>English, New Zealand (en-rNZ) ———————英语，新西兰<br>English, Singapore(en-rSG) ————————–英语，新加坡<br>English, US (en-rUS) ———————————–英语，美国<br>English, Zimbabwe (en-rZA) ————————–英语，津巴布韦<br>Spanish (es-rES) —————————————-西班牙<br>Spanish, US (es-rUS) ———————————–西班牙语，美国<br>Finnish, Finland (fi-rFI) ———————————芬兰语，芬兰<br>French, Belgium (fr-rBE) ——————————-法语，比利时<br>French, Canada (fr-rCA) ——————————-法语，加拿大<br>French, Switzerland (fr-rCH) ————————–法语，瑞士<br>French, France (fr-rFR) ——————————–法语，法国<br>Hebrew, Israel (he-rIL) ———————————希伯来语，以色列<br>Hindi, India (hi-rIN) ————————————-印地语，印度<br>Croatian, Croatia (hr-rHR) —————————-克罗地亚语，克罗地亚<br>Hungarian, Hungary (hu-rHU) ————————匈牙利语，匈牙利<br>Indonesian, Indonesia (id-rID) ————————印尼语，印尼<br>Italian, Switzerland (it-rCH) —————————-意大利语，瑞士<br>Italian, Italy (it-rIT) —————————————意大利语，意大利<br>Japanese (ja-rJP) —————————————-日语<br>Korean (ko-rKR) ——————————————朝鲜语<br>Lithuanian, Lithuania (lt-rLT) ————————–立陶宛语，立陶宛<br>Latvian, Latvia (lv-rLV) ———————————拉托维亚语，拉托维亚<br>Norwegian-Bokmol, Norway(nb-rNO) —————挪威语，挪威<br>Dutch, Belgium (nl-rBE) ——————————–荷兰语，比利时<br>Dutch, Netherlands (nl-rNL) —————————荷兰语，荷兰<br>Polish (pl-rPL) ——————————————-波兰<br>Portuguese, Brazil (pt-rBR) —————————葡萄牙语，巴西<br>Portuguese, Portugal (pt-rPT) ————————葡萄牙语，葡萄牙<br>Romanian, Romania (ro-rRO) ————————罗马尼亚语，罗马尼亚<br>Russian (ru-rRU) —————————————-俄语<br>Slovak, Slovakia (sk-rSK) ——————————斯洛伐克语，斯洛伐克<br>Slovenian, Slovenia (sl-rSI) —————————-斯洛文尼亚语，斯洛文尼亚<br>Serbian (sr-rRS) —————————————-塞尔维亚语<br>Swedish, Sweden (sv-rSE) —————————-瑞典语，瑞典<br>Thai, Thailand (th-rTH) ——————————–泰语，泰国<br>Tagalog, Philippines (tl-rPH) ————————–菲律宾语，菲律宾<br>Turkish, Turkey (tr-rTR) ——————————-土耳其语，土耳其<br>Ukrainian, Ukraine (uk-rUA) ————————–联合王国<br>Vietnamese, Vietnam (vi-rVN) ———————–越南语，越南<br>Chinese, PRC (zh-rCN)——————————–中文，中国<br>Chinese, Taiwan (zh-rTW)—————————–中文，台湾</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://hefengbao.github.io/helloworld/android-multi-language.html" data-id="ckpqdoma800e31r8j5zf66clr" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/helloworld/tags/android/" rel="tag">android</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Laravel-Rate-Limiting-in-Production" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/helloworld/laravel-rate-limiting-in-production-926c4d581886.html" class="article-date">
  <time datetime="2020-05-22T12:17:26.000Z" itemprop="datePublished">2020-05-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/helloworld/categories/PHP/">PHP</a>►<a class="article-category-link" href="/helloworld/categories/PHP/Laravel/">Laravel</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/helloworld/laravel-rate-limiting-in-production-926c4d581886.html">Laravel Rate Limiting in Production</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Whenever you develop a Laravel-based application that makes it into production you’ll probably provide some kind of API. Either for internal usage or for the customer to consume. However you most likely want to install some kind of rate limiting mechanism to make sure nobody is overusing your API and thus risking to take down your hosting infrastructure.</p>
<p>A well-known mechanism to prevent APIs from being overloaded with requests (kind of DoS) is a rate limiting. You’ll define a maximum number of requests in a given amount of time and when a client hits that maximum your web server will answer with <em>HTTP 429 Too Many Requests</em>. This indicates the client that there is some kind of cooldown time it needs to wait until further requests will be processed.</p>
<h1 id="Rate-Limiting-Middleware"><a href="#Rate-Limiting-Middleware" class="headerlink" title="Rate Limiting Middleware"></a>Rate Limiting Middleware</h1><p>Laravel provides a convenient <em>throttle</em> middleware that provides that kind of rate limiting. It even supports different limits based upon a model so you can limit the amount of requests based upon a dynamic parameter.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Allow up to 60 requests in 1 minute for that route (= 1 req/s)</span></span><br><span class="line">Route::get(<span class="string">&#x27;api/v1/user&#x27;</span>, <span class="string">&#x27;Api\UserController@index&#x27;</span>)-&gt;middleware(<span class="string">&#x27;throttle:60,1&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Allow up to 60 requests in 60 minutes for that route (= 1 req/m)</span></span><br><span class="line">Route::post(<span class="string">&#x27;api/v1/user&#x27;</span>, <span class="string">&#x27;Api\UserController@store&#x27;</span>)-&gt;middleware(<span class="string">&#x27;throttle:60,60&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Rate Limiting for a whole group of routes</span></span><br><span class="line">Route::group([<span class="string">&#x27;middleware&#x27;</span> =&gt; <span class="string">&#x27;throttle:60,1&#x27;</span>], <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// [...]</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



<p>Figure 1 — Rate Limiting using Laravel’s “throttle” middleware</p>
<p>This is a pretty cool default functionality. However it comes with a downside you will experience in production: The request <strong>still</strong> <strong>hits</strong> your Laravel application before being denied due to an exceeded limit which means the request <strong>still generates load</strong> on your web-server.</p>
<p>Of course the impact isn’t as high as it normally would be but in fact the web-server needs to boot up the Laravel framework and the request will pass any middleware that is processed before the <em>throttle</em> middleware itself. This alone could cause some database queries to be executed before the check for the exceeded rate limit even happens.</p>
<p>Finally the request causes impact on your cache server (e.g. Redis). Laravel’s rate limiting middleware stores the client’s IP address alongside with the amount of requests in a given time period and performs a check on every request.</p>
<h1 id="Load-Balancer-Rate-Limiting"><a href="#Load-Balancer-Rate-Limiting" class="headerlink" title="Load Balancer Rate Limiting"></a>Load Balancer Rate Limiting</h1><p>A technique I often use when bringing Laravel-based applications into production is a combination of Laravel Middleware Rate Limiting alongside with another rate limiting at the load balancer.</p>
<p>A load balancer is a piece of software that usually sits in front of your web-server stack. The traffic goes from the left to the right until it hits your Laravel application.</p>
<img src="/helloworld/images/20200522/1_iRo2ersIlJiVfNJ0FOpXVw.png" class="">

<p>Figure 2 — Position of the Load Balancer in the Web-Server Stack</p>
<p>It should be desirable to kill unwanted requests as early as possible in that chain of processing to reduce load in the backend. One of the most used load balancers is <a target="_blank" rel="noopener" href="http://www.haproxy.org/">HAProxy</a>. Although the website looks like it’s software from the 90s, it’s battle-tested and under very active development. At the time of writing this article HAProxy has reached stable version 2.1 and is “cloud ready” for usage with modern technologies like Kubernetes.</p>
<p>HAProxy is mainly a Layer 7 HTTP Load Balancer (however it also supports some more protocols, which is pretty awesome). That means that it can handle SSL offloading, can look into the user’s request and decide a few key things upon the request details:</p>
<ul>
<li>First of all it can decide which backend to use for the incoming request which means you could split up your application into two different Laravel applications: One for the frontend and another one for the backend.</li>
<li>It can restrict some URIs to a given IP range or require basic authentication for it. That way I’m able to protect the Laravel Horizon Dashboard in production — it’s only accessible from a specific VPN IP range for additional security.</li>
<li>It can split your user’s request between several backend web-servers which means you are able to scale your deployment. You no longer need to get bigger and bigger machines, you can just add some. And you can remove them if no longer needed (e.g. after a huge sale event, when running a web shop).</li>
</ul>
<p>However this article will focus on the configuration of rate limiting within HAProxy for the sake of performance and stability of your web-server deployment.</p>
<h1 id="Configuration-of-HAProxy"><a href="#Configuration-of-HAProxy" class="headerlink" title="Configuration of HAProxy"></a>Configuration of HAProxy</h1><p>Before diving right into the configuration of the rate limiting itself it’s important to configure some basic limitations of HAProxy. You may want to configure a maximum amount of parallel connections that load balancer is allowed to handle at one time.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">backend laravel</span><br><span class="line">    timeout queue 10s</span><br><span class="line">    server app-1 10.10.100.101:8080 check maxconn 30</span><br><span class="line">    server app-2 10.10.100.102:8080 check maxconn 30</span><br><span class="line">    server app-3 10.10.100.103:8080 check maxconn 30</span><br></pre></td></tr></table></figure>



<p>Figure 3 — Max Connection Settings for HAProxy</p>
<p>When there are more than 90 (3 times 30 connections) concurrent connections HAProxy will put those requests in a queue and will forward them once the active connection count drops below 30 again. Usually this happens within milliseconds, so your users will barely notice under normal circumstances. The queue will be flushed after 10 seconds and the client receives an <em>HTTP 503 Service Unavailable</em> which means HAProxy couldn’t elect a backend server to serve the request to the user.</p>
<p>One would ask why you should limit those connections to the backend server. The idea behind this procedure is that it’s better to serve some HTTP errors to some clients than bury your web backend under such a heavy workload your application becomes inoperable. It’s a kind of a protection for your infrastructure.</p>
<h2 id="HAProxy-Rate-Limiting"><a href="#HAProxy-Rate-Limiting" class="headerlink" title="HAProxy Rate Limiting"></a>HAProxy Rate Limiting</h2><p>To integrate rate limiting functionalities into HAProxy you need to configure a so called <em>stick table</em> within your frontend configuration block. That table works kind of like the Laravel throttle middleware under the hood. It stores a definable value as dictionary key and some counters that belong to that key.</p>
<p>To recognize a user we will use its requesting IP address as dictionary key. And the value we are interested in is the amount of HTTP connection the client establishes.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">frontend app</span><br><span class="line">    bind :80</span><br><span class="line">    stick-table type ipv6 size 100k expire 30s store http_req_rate(10s)</span><br><span class="line">    http-request track-sc0 src</span><br><span class="line">    http-request deny deny_status 429 if &#123; sc_http_req_rate(0) gt 20 &#125;</span><br><span class="line">    default_backend laravel</span><br></pre></td></tr></table></figure>



<p>Figure 4 — Establish Rate Limiting within HAProxy</p>
<p>The first two lines of that configuration example are plain and basic frontend definitions in HAProxy. You create a new frontend (something that receives a user’s request) and bind it to port 80 which is the default HTTP port.</p>
<p>In Line 3 you create a <em>stick-table</em> that stores IP addresses as “dictionary key”, has a maximum size of 100k, thats values expire after 30 seconds and that stores the request rate of the latest 10 seconds for each client. The reason why we are using <em>ipv6</em> as table type is that the default <em>ip</em> type is not able to store IPv6 addresses due to a limitation of the key length. Although the type suggests that the table can only store IPv6 addresses this is not the case; it can easily store both, so don’t worry.</p>
<p>Afterwards we initialize a so called <em>sticky counter</em> (sc) to count the incoming HTTP requests of each user and <strong>deny</strong> the request with a <em>HTTP 429 Too Many Requests</em> if the HTTP request rate exceeds 20 requests for the given amount of time we defined in Line 3 (in our case this are seconds).</p>
<p>HAProxy will automatically take care of the table and purge old entries. So after some time the clients will be able to connect to the server again.</p>
<h2 id="Downsides"><a href="#Downsides" class="headerlink" title="Downsides"></a>Downsides</h2><p>However there are some downsides you should consider when performing rate limiting with HAProxy. The Laravel Throttle Middleware has some neat features for usability.</p>
<img src="/helloworld/images/20200522/1_f7n2ggc0-is5aThcEB6jTQ.png" class="">

<p>Figure 5 — X-RateLimit headers of the Laravel Throttle Middleware</p>
<p>As you can see Laravel will automatically add some additional headers to its response when a request got rate-limited. You can see the hard limit of requests (5 in the example) and the remaining amount of requests you can perform before getting a <em>HTTP 429</em> from the server. Furthermore it provides a counter and a unix timestamp that shows you when you are allowed to perform new requests after a rate limit hit.</p>
<p>You won’t get those headers with the provided HAProxy configuration above. Therefore I personally decided to use the load balancer rate limiting technique <strong>alongside</strong> with Laravel’s rate limiting middleware. You easily can configure much higher limits within your load balancer than at your Laravel application and you still get some kind of protection against flooding your application.</p>
<p>For example you could set up the Laravel throttle middleware to prevent more requests than 60 per minute so the user gets one request per second. Then you could configure HAProxy to limit the requests when there are more than 120 requests per minute. So if your user is using your API correctly and honors the rate limiting headers he won’t ever hit your load balancer rate limit. But if the user just ignores the headers and continues flooding your application with requests although they get denied by your Laravel middleware he’ll run into your load balancer rate limiting at some point.</p>
<p>By doing this you can efficiently prevent your infrastructure from being flooded with requests.</p>
<h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><ul>
<li>Laravel provides a convenient default middleware to throttle requests using the cache backend you set up for your application.</li>
<li>In production it may be a problem that your user’s requests still hit your web-server backend although the user is already rate-limited.</li>
<li>Rate limiting via Laravel Middleware costs more than rate limiting at the edge of your web stack (at the load balancer).</li>
<li>HAProxy provides a convenient way to achieve rate limiting using <em>stick-tables</em> and some easy deny rules at the frontend.</li>
<li>It’s better to show some users a HTTP error that burying your infrastructure under heavy load (no matters whether it’s a DoS-attack or just a high amount of legit traffic).</li>
</ul>
<p>In the future I’ll publish more articles about production-specific experiences with Laravel I made in the past. I hope you can get some takeaways for your own projects.</p>
<p>Hosting is fun and there are many ways to fine-tune your application very individually. One-Click-Hosting solutions may suite for many projects, but when it comes to performance and security you may prefer a tailored solution.</p>
<p>来源：</p>
<p><a target="_blank" rel="noopener" href="https://medium.com/swlh/laravel-rate-limiting-in-production-926c4d581886">https://medium.com/swlh/laravel-rate-limiting-in-production-926c4d581886</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://hefengbao.github.io/helloworld/laravel-rate-limiting-in-production-926c4d581886.html" data-id="ckpqdoma300dl1r8j3tdkhihg" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/helloworld/tags/laravel/" rel="tag">laravel</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/helloworld/tags/server/" rel="tag">server</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Working-with-JSON-in-MySQL" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/helloworld/working-with-json-in-mysql.html" class="article-date">
  <time datetime="2020-05-22T11:47:32.000Z" itemprop="datePublished">2020-05-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/helloworld/categories/Database/">Database</a>►<a class="article-category-link" href="/helloworld/categories/Database/MySQL/">MySQL</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/helloworld/working-with-json-in-mysql.html">Working with JSON in MySQL</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>SQL databases tend to be rigid.</p>
<p>If you have worked with them, you would agree that database design though it seems easier, is a lot trickier in practice. SQL databases believe in structure, that is why it’s called structured query language.</p>
<p>On the other side of the horizon, we have the NoSQL databases, also called schema-less databases that encourage flexibility. In schema-less databases, there is no imposed structural restriction, only data to be saved.</p>
<h3 id="Table-of-Contents"><a href="#Table-of-Contents" class="headerlink" title="Table of Contents"></a>Table of Contents</h3><ul>
<li><a target="_blank" rel="noopener" href="https://scotch.io/tutorials/working-with-json-in-mysql#toc-why-use-json">Why Use JSON</a></li>
<li><a target="_blank" rel="noopener" href="https://scotch.io/tutorials/working-with-json-in-mysql#toc-the-schema">The Schema</a></li>
<li><a target="_blank" rel="noopener" href="https://scotch.io/tutorials/working-with-json-in-mysql#toc-the-crud-operations">The CRUD Operations</a></li>
<li><a target="_blank" rel="noopener" href="https://scotch.io/tutorials/working-with-json-in-mysql#toc-a-primer-for-web-applications">A Primer for Web Applications</a></li>
<li><a target="_blank" rel="noopener" href="https://scotch.io/tutorials/working-with-json-in-mysql#toc-creating-the-migrations">Creating the Migrations</a></li>
<li><a target="_blank" rel="noopener" href="https://scotch.io/tutorials/working-with-json-in-mysql#toc-creating-the-models">Creating the Models</a></li>
<li><a target="_blank" rel="noopener" href="https://scotch.io/tutorials/working-with-json-in-mysql#toc-resource-operations">Resource Operations</a></li>
<li><a target="_blank" rel="noopener" href="https://scotch.io/tutorials/working-with-json-in-mysql#toc-curtains">Curtains</a></li>
</ul>
<p>Though every tool has it’s use case, sometimes things call for a hybrid approach.</p>
<p>What if you could structure some parts of your database and leave others to be flexible?</p>
<p><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/relnotes/mysql/5.7/en/news-5-7-8.html">MySQL version 5.7.8</a> introduces a JSON data type that allows you to accomplish that.</p>
<p>In this tutorial, you are going to learn.</p>
<ol>
<li>How to design your database tables using JSON fields.</li>
<li>The various JSON based functions available in MYSQL to create, read, update, and delete rows.</li>
<li>How to work with JSON fields using the Eloquent ORM in Laravel.</li>
</ol>
<h2 id="Why-Use-JSON"><a href="#Why-Use-JSON" class="headerlink" title="Why Use JSON"></a><a target="_blank" rel="noopener" href="https://scotch.io/tutorials/working-with-json-in-mysql#toc-why-use-json">Why Use JSON</a></h2><p>At this moment, you are probably asking yourself why would you want to use JSON when MySQL has been catering to a wide variety of database needs even before it introduced a JSON data type.</p>
<p>The answer lies in the use-cases where you would probably use a make-shift approach.</p>
<p>Let me explain with an example.</p>
<p>Suppose you are building a web application where you have to save a user’s configuration/preferences in the database.</p>
<p>Generally, you can create a separate database table with the <code>id</code>, <code>user_id</code>, <code>key</code>, and <code>value</code> fields or save it as a formatted string that you can parse at runtime.</p>
<p>However, this works well for a small number of users. If you have about a thousand users and five configuration keys, you are looking at a table with five thousand records that addresses a very small feature of your application.</p>
<p>Or if you are taking the formatted string route, extraneous code that only compounds your server load.</p>
<p>Using a JSON data type field to save a user’s configuration in such a scenario can spare you a database table’s space and bring down the number of records, which were being saved separately, to be the same as the number of users.</p>
<p>And you get the added benefit of not having to write any JSON parsing code, the ORM or the language runtime takes care of it.</p>
<h2 id="The-Schema"><a href="#The-Schema" class="headerlink" title="The Schema"></a><a target="_blank" rel="noopener" href="https://scotch.io/tutorials/working-with-json-in-mysql#toc-the-schema">The Schema</a></h2><p>Before we dive into using all the cool JSON stuff in MySQL, we are going to need a sample database to play with.</p>
<p>So, let’s get our database schema out of the way first.</p>
<p>We are going to consider the use case of an online store that houses multiple brands and a variety of electronics.</p>
<p>Since different electronics have different attributes(compare a Macbook with a Vacuumn Cleaner) that buyers are interested in, typically the <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Entity%E2%80%93attribute%E2%80%93value_model">Entity–attribute–value model (EAV)</a> pattern is used.</p>
<p>However, since we now have the option to use a JSON data type, we are going to drop EAV.</p>
<p>For a start, our database will be named <code>e_store</code> and has three tables only named, <code>brands</code>, <code>categories</code>, and <code>products</code> respectively.</p>
<p>Our <code>brands</code> and <code>categories</code> tables will be pretty similar, each having an <code>id</code> and a <code>name</code> field.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> `e_store`</span><br><span class="line"><span class="keyword">DEFAULT</span> <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8</span><br><span class="line"><span class="keyword">DEFAULT</span> <span class="keyword">COLLATE</span> utf8_general_ci;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> default_storage_engine <span class="operator">=</span> INNODB;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `e_store`.`brands`(</span><br><span class="line">    `id` <span class="type">INT</span> UNSIGNED <span class="keyword">NOT</span> <span class="keyword">NULL</span> auto_increment ,</span><br><span class="line">    `name` <span class="type">VARCHAR</span>(<span class="number">250</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> ,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY(`id`)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `e_store`.`categories`(</span><br><span class="line">    `id` <span class="type">INT</span> UNSIGNED <span class="keyword">NOT</span> <span class="keyword">NULL</span> auto_increment ,</span><br><span class="line">    `name` <span class="type">VARCHAR</span>(<span class="number">250</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> ,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY(`id`)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>The objective of these two tables will be to house the product categories and the brands that provide these products.</p>
<p>While we are at it, let us go ahead and seed some data into these tables to use later.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Brands */</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `e_store`.`brands`(`name`)</span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line">    (<span class="string">&#x27;Samsung&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `e_store`.`brands`(`name`)</span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line">    (<span class="string">&#x27;Nokia&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `e_store`.`brands`(`name`)</span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line">    (<span class="string">&#x27;Canon&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Types of electronic device */</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `e_store`.`categories`(`name`)</span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line">    (<span class="string">&#x27;Television&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `e_store`.`categories`(`name`)</span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line">    (<span class="string">&#x27;Mobilephone&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `e_store`.`categories`(`name`)</span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line">    (<span class="string">&#x27;Camera&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><img src="https://scotch-res.cloudinary.com/image/upload/dpr_1,w_800,q_auto:good,f_auto/media/228/uoYvos3JTPezCeWjoZSO_1.png" alt="The brands table"></p>
<p><img src="https://scotch-res.cloudinary.com/image/upload/dpr_1,w_800,q_auto:good,f_auto/media/228/A9dPz6CkS3W2Cjk5cOzR_2.png" alt="The categories table"></p>
<p>Next, is the business area of this tutorial.</p>
<p>We are going to create a <code>products</code> table with the <code>id</code>, <code>name</code>, <code>brand_id</code>, <code>category_id</code>, and <code>attributes</code> fields.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `e_store`.`products`(</span><br><span class="line">    `id` <span class="type">INT</span> UNSIGNED <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT ,</span><br><span class="line">    `name` <span class="type">VARCHAR</span>(<span class="number">250</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> ,</span><br><span class="line">    `brand_id` <span class="type">INT</span> UNSIGNED <span class="keyword">NOT</span> <span class="keyword">NULL</span> ,</span><br><span class="line">    `category_id` <span class="type">INT</span> UNSIGNED <span class="keyword">NOT</span> <span class="keyword">NULL</span> ,</span><br><span class="line">    `attributes` JSON <span class="keyword">NOT</span> <span class="keyword">NULL</span> ,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY(`id`) ,</span><br><span class="line">    INDEX `CATEGORY_ID`(`category_id` <span class="keyword">ASC</span>) ,</span><br><span class="line">    INDEX `BRAND_ID`(`brand_id` <span class="keyword">ASC</span>) ,</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> `brand_id` <span class="keyword">FOREIGN</span> KEY(`brand_id`) <span class="keyword">REFERENCES</span> `e_store`.`brands`(`id`) <span class="keyword">ON</span> <span class="keyword">DELETE</span> RESTRICT <span class="keyword">ON</span> UPDATE CASCADE ,</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> `category_id` <span class="keyword">FOREIGN</span> KEY(`category_id`) <span class="keyword">REFERENCES</span> `e_store`.`categories`(`id`) <span class="keyword">ON</span> <span class="keyword">DELETE</span> RESTRICT <span class="keyword">ON</span> UPDATE CASCADE</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>Our table definition specifies foreign key constraints for the <code>brand_id</code> and <code>category_id</code> fields, specifying that they reference the <code>brands</code> and <code>categories</code> table respectively. We have also specified that the referenced rows should not be allowed to delete and if updated, the changes should reflect in the references as well.</p>
<p>The <code>attributes</code> field’s column type has been declared to be JSON which is the native data type now available in MySQL. This allows us to use the various JSON related constructs in MySQL on our <code>attributes</code> field.</p>
<p>Here is an entity relationship diagram of our created database.</p>
<p><img src="https://scotch-res.cloudinary.com/image/upload/dpr_1,w_800,q_auto:good,f_auto/media/228/hmMGbU8bRfuh9cA9vJKA_3.png" alt="The e_store database"></p>
<blockquote>
<p>Our database design is not the best in terms of efficiency and accuracy. There is no price column in the <code>products</code> table and we could do with putting a product into multiple categories. However, the purpose of this tutorial is not to teach database design but rather how to model objects of different nature in a single table using MySQL’s JSON features.</p>
</blockquote>
<h2 id="The-CRUD-Operations"><a href="#The-CRUD-Operations" class="headerlink" title="The CRUD Operations"></a><a target="_blank" rel="noopener" href="https://scotch.io/tutorials/working-with-json-in-mysql#toc-the-crud-operations">The CRUD Operations</a></h2><p>Let us look at how to create, read, update, and delete data in a JSON field.</p>
<h3 id="Create"><a href="#Create" class="headerlink" title="Create"></a>Create</h3><p>Creating a record in the database with a JSON field is pretty simple.</p>
<p>All you need to do is add valid JSON as the field value in your insert statement.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Let&#x27;s sell some televisions */</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `e_store`.`products`(</span><br><span class="line">    `name` ,</span><br><span class="line">    `brand_id` ,</span><br><span class="line">    `category_id` ,</span><br><span class="line">    `attributes`</span><br><span class="line">)</span><br><span class="line"><span class="keyword">VALUES</span>(</span><br><span class="line">    <span class="string">&#x27;Prime&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;1&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;1&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;&#123;&quot;screen&quot;: &quot;50 inch&quot;, &quot;resolution&quot;: &quot;2048 x 1152 pixels&quot;, &quot;ports&quot;: &#123;&quot;hdmi&quot;: 1, &quot;usb&quot;: 3&#125;, &quot;speakers&quot;: &#123;&quot;left&quot;: &quot;10 watt&quot;, &quot;right&quot;: &quot;10 watt&quot;&#125;&#125;&#x27;</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `e_store`.`products`(</span><br><span class="line">    `name` ,</span><br><span class="line">    `brand_id` ,</span><br><span class="line">    `category_id` ,</span><br><span class="line">    `attributes`</span><br><span class="line">)</span><br><span class="line"><span class="keyword">VALUES</span>(</span><br><span class="line">    <span class="string">&#x27;Octoview&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;1&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;1&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;&#123;&quot;screen&quot;: &quot;40 inch&quot;, &quot;resolution&quot;: &quot;1920 x 1080 pixels&quot;, &quot;ports&quot;: &#123;&quot;hdmi&quot;: 1, &quot;usb&quot;: 2&#125;, &quot;speakers&quot;: &#123;&quot;left&quot;: &quot;10 watt&quot;, &quot;right&quot;: &quot;10 watt&quot;&#125;&#125;&#x27;</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `e_store`.`products`(</span><br><span class="line">    `name` ,</span><br><span class="line">    `brand_id` ,</span><br><span class="line">    `category_id` ,</span><br><span class="line">    `attributes`</span><br><span class="line">)</span><br><span class="line"><span class="keyword">VALUES</span>(</span><br><span class="line">    <span class="string">&#x27;Dreamer&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;1&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;1&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;&#123;&quot;screen&quot;: &quot;30 inch&quot;, &quot;resolution&quot;: &quot;1600 x 900 pixles&quot;, &quot;ports&quot;: &#123;&quot;hdmi&quot;: 1, &quot;usb&quot;: 1&#125;, &quot;speakers&quot;: &#123;&quot;left&quot;: &quot;10 watt&quot;, &quot;right&quot;: &quot;10 watt&quot;&#125;&#125;&#x27;</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `e_store`.`products`(</span><br><span class="line">    `name` ,</span><br><span class="line">    `brand_id` ,</span><br><span class="line">    `category_id` ,</span><br><span class="line">    `attributes`</span><br><span class="line">)</span><br><span class="line"><span class="keyword">VALUES</span>(</span><br><span class="line">    <span class="string">&#x27;Bravia&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;1&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;1&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;&#123;&quot;screen&quot;: &quot;25 inch&quot;, &quot;resolution&quot;: &quot;1366 x 768 pixels&quot;, &quot;ports&quot;: &#123;&quot;hdmi&quot;: 1, &quot;usb&quot;: 0&#125;, &quot;speakers&quot;: &#123;&quot;left&quot;: &quot;5 watt&quot;, &quot;right&quot;: &quot;5 watt&quot;&#125;&#125;&#x27;</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `e_store`.`products`(</span><br><span class="line">    `name` ,</span><br><span class="line">    `brand_id` ,</span><br><span class="line">    `category_id` ,</span><br><span class="line">    `attributes`</span><br><span class="line">)</span><br><span class="line"><span class="keyword">VALUES</span>(</span><br><span class="line">    <span class="string">&#x27;Proton&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;1&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;1&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;&#123;&quot;screen&quot;: &quot;20 inch&quot;, &quot;resolution&quot;: &quot;1280 x 720 pixels&quot;, &quot;ports&quot;: &#123;&quot;hdmi&quot;: 0, &quot;usb&quot;: 0&#125;, &quot;speakers&quot;: &#123;&quot;left&quot;: &quot;5 watt&quot;, &quot;right&quot;: &quot;5 watt&quot;&#125;&#125;&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><img src="https://scotch-res.cloudinary.com/image/upload/dpr_1,w_800,q_auto:good,f_auto/media/228/XR9EjnVLQfmK3itaeB1d_4.png" alt="The products table after adding televisions"></p>
<p>Instead of laying out the JSON object yourself, you can also use the built-in <code>JSON_OBJECT</code> function.</p>
<p>The <code>JSON_OBJECT</code> function accepts a list of key/value pairs in the form <code>JSON_OBJECT(key1, value1, key2, value2, ... key(n), value(n))</code> and returns a JSON object.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Let&#x27;s sell some mobilephones */</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `e_store`.`products`(</span><br><span class="line">    `name` ,</span><br><span class="line">    `brand_id` ,</span><br><span class="line">    `category_id` ,</span><br><span class="line">    `attributes`</span><br><span class="line">)</span><br><span class="line"><span class="keyword">VALUES</span>(</span><br><span class="line">    <span class="string">&#x27;Desire&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;2&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;2&#x27;</span> ,</span><br><span class="line">    <span class="built_in">JSON_OBJECT</span>(</span><br><span class="line">        &quot;network&quot; ,</span><br><span class="line">        <span class="built_in">JSON_ARRAY</span>(&quot;GSM&quot; , &quot;CDMA&quot; , &quot;HSPA&quot; , &quot;EVDO&quot;) ,</span><br><span class="line">        &quot;body&quot; ,</span><br><span class="line">        &quot;5.11 x 2.59 x 0.46 inches&quot; ,</span><br><span class="line">        &quot;weight&quot; ,</span><br><span class="line">        &quot;143 grams&quot; ,</span><br><span class="line">        &quot;sim&quot; ,</span><br><span class="line">        &quot;Micro-SIM&quot; ,</span><br><span class="line">        &quot;display&quot; ,</span><br><span class="line">        &quot;4.5 inches&quot; ,</span><br><span class="line">        &quot;resolution&quot; ,</span><br><span class="line">        &quot;720 x 1280 pixels&quot; ,</span><br><span class="line">        &quot;os&quot; ,</span><br><span class="line">        &quot;Android Jellybean v4.3&quot;</span><br><span class="line">    )</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `e_store`.`products`(</span><br><span class="line">    `name` ,</span><br><span class="line">    `brand_id` ,</span><br><span class="line">    `category_id` ,</span><br><span class="line">    `attributes`</span><br><span class="line">)</span><br><span class="line"><span class="keyword">VALUES</span>(</span><br><span class="line">    <span class="string">&#x27;Passion&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;2&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;2&#x27;</span> ,</span><br><span class="line">    <span class="built_in">JSON_OBJECT</span>(</span><br><span class="line">        &quot;network&quot; ,</span><br><span class="line">        <span class="built_in">JSON_ARRAY</span>(&quot;GSM&quot; , &quot;CDMA&quot; , &quot;HSPA&quot;) ,</span><br><span class="line">        &quot;body&quot; ,</span><br><span class="line">        &quot;6.11 x 3.59 x 0.46 inches&quot; ,</span><br><span class="line">        &quot;weight&quot; ,</span><br><span class="line">        &quot;145 grams&quot; ,</span><br><span class="line">        &quot;sim&quot; ,</span><br><span class="line">        &quot;Micro-SIM&quot; ,</span><br><span class="line">        &quot;display&quot; ,</span><br><span class="line">        &quot;4.5 inches&quot; ,</span><br><span class="line">        &quot;resolution&quot; ,</span><br><span class="line">        &quot;720 x 1280 pixels&quot; ,</span><br><span class="line">        &quot;os&quot; ,</span><br><span class="line">        &quot;Android Jellybean v4.3&quot;</span><br><span class="line">    )</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `e_store`.`products`(</span><br><span class="line">    `name` ,</span><br><span class="line">    `brand_id` ,</span><br><span class="line">    `category_id` ,</span><br><span class="line">    `attributes`</span><br><span class="line">)</span><br><span class="line"><span class="keyword">VALUES</span>(</span><br><span class="line">    <span class="string">&#x27;Emotion&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;2&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;2&#x27;</span> ,</span><br><span class="line">    <span class="built_in">JSON_OBJECT</span>(</span><br><span class="line">        &quot;network&quot; ,</span><br><span class="line">        <span class="built_in">JSON_ARRAY</span>(&quot;GSM&quot; , &quot;CDMA&quot; , &quot;EVDO&quot;) ,</span><br><span class="line">        &quot;body&quot; ,</span><br><span class="line">        &quot;5.50 x 2.50 x 0.50 inches&quot; ,</span><br><span class="line">        &quot;weight&quot; ,</span><br><span class="line">        &quot;125 grams&quot; ,</span><br><span class="line">        &quot;sim&quot; ,</span><br><span class="line">        &quot;Micro-SIM&quot; ,</span><br><span class="line">        &quot;display&quot; ,</span><br><span class="line">        &quot;5.00 inches&quot; ,</span><br><span class="line">        &quot;resolution&quot; ,</span><br><span class="line">        &quot;720 x 1280 pixels&quot; ,</span><br><span class="line">        &quot;os&quot; ,</span><br><span class="line">        &quot;Android KitKat v4.3&quot;</span><br><span class="line">    )</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `e_store`.`products`(</span><br><span class="line">    `name` ,</span><br><span class="line">    `brand_id` ,</span><br><span class="line">    `category_id` ,</span><br><span class="line">    `attributes`</span><br><span class="line">)</span><br><span class="line"><span class="keyword">VALUES</span>(</span><br><span class="line">    <span class="string">&#x27;Sensation&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;2&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;2&#x27;</span> ,</span><br><span class="line">    <span class="built_in">JSON_OBJECT</span>(</span><br><span class="line">        &quot;network&quot; ,</span><br><span class="line">        <span class="built_in">JSON_ARRAY</span>(&quot;GSM&quot; , &quot;HSPA&quot; , &quot;EVDO&quot;) ,</span><br><span class="line">        &quot;body&quot; ,</span><br><span class="line">        &quot;4.00 x 2.00 x 0.75 inches&quot; ,</span><br><span class="line">        &quot;weight&quot; ,</span><br><span class="line">        &quot;150 grams&quot; ,</span><br><span class="line">        &quot;sim&quot; ,</span><br><span class="line">        &quot;Micro-SIM&quot; ,</span><br><span class="line">        &quot;display&quot; ,</span><br><span class="line">        &quot;3.5 inches&quot; ,</span><br><span class="line">        &quot;resolution&quot; ,</span><br><span class="line">        &quot;720 x 1280 pixels&quot; ,</span><br><span class="line">        &quot;os&quot; ,</span><br><span class="line">        &quot;Android Lollypop v4.3&quot;</span><br><span class="line">    )</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `e_store`.`products`(</span><br><span class="line">    `name` ,</span><br><span class="line">    `brand_id` ,</span><br><span class="line">    `category_id` ,</span><br><span class="line">    `attributes`</span><br><span class="line">)</span><br><span class="line"><span class="keyword">VALUES</span>(</span><br><span class="line">    <span class="string">&#x27;Joy&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;2&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;2&#x27;</span> ,</span><br><span class="line">    <span class="built_in">JSON_OBJECT</span>(</span><br><span class="line">        &quot;network&quot; ,</span><br><span class="line">        <span class="built_in">JSON_ARRAY</span>(&quot;CDMA&quot; , &quot;HSPA&quot; , &quot;EVDO&quot;) ,</span><br><span class="line">        &quot;body&quot; ,</span><br><span class="line">        &quot;7.00 x 3.50 x 0.25 inches&quot; ,</span><br><span class="line">        &quot;weight&quot; ,</span><br><span class="line">        &quot;250 grams&quot; ,</span><br><span class="line">        &quot;sim&quot; ,</span><br><span class="line">        &quot;Micro-SIM&quot; ,</span><br><span class="line">        &quot;display&quot; ,</span><br><span class="line">        &quot;6.5 inches&quot; ,</span><br><span class="line">        &quot;resolution&quot; ,</span><br><span class="line">        &quot;1920 x 1080 pixels&quot; ,</span><br><span class="line">        &quot;os&quot; ,</span><br><span class="line">        &quot;Android Marshmallow v4.3&quot;</span><br><span class="line">    )</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><img src="https://scotch-res.cloudinary.com/image/upload/dpr_1,w_800,q_auto:good,f_auto/media/228/n5XZPZySJmmXjbPJjX5X_5.png" alt="The products table after adding mobilephones"></p>
<p>Notice the <code>JSON_ARRAY</code> function which returns a JSON array when passed a set of values.</p>
<p>If you specify a single key multiple times, only the first key/value pair will be retained. This is called normalizing the JSON in MySQL’s terms. Also, as part of normalization, the object keys are sorted and the extra white-space between key/value pairs is removed.</p>
<p>Another function that we can use to create JSON objects is the <code>JSON_MERGE</code> function.</p>
<p>The <code>JSON_MERGE</code> function takes multiple JSON objects and produces a single, aggregate object.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Let&#x27;s sell some cameras */</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `e_store`.`products`(</span><br><span class="line">    `name` ,</span><br><span class="line">    `brand_id` ,</span><br><span class="line">    `category_id` ,</span><br><span class="line">    `attributes`</span><br><span class="line">)</span><br><span class="line"><span class="keyword">VALUES</span>(</span><br><span class="line">    <span class="string">&#x27;Explorer&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;3&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;3&#x27;</span> ,</span><br><span class="line">    JSON_MERGE(</span><br><span class="line">        <span class="string">&#x27;&#123;&quot;sensor_type&quot;: &quot;CMOS&quot;&#125;&#x27;</span> ,</span><br><span class="line">        <span class="string">&#x27;&#123;&quot;processor&quot;: &quot;Digic DV III&quot;&#125;&#x27;</span> ,</span><br><span class="line">        <span class="string">&#x27;&#123;&quot;scanning_system&quot;: &quot;progressive&quot;&#125;&#x27;</span> ,</span><br><span class="line">        <span class="string">&#x27;&#123;&quot;mount_type&quot;: &quot;PL&quot;&#125;&#x27;</span> ,</span><br><span class="line">        <span class="string">&#x27;&#123;&quot;monitor_type&quot;: &quot;LCD&quot;&#125;&#x27;</span></span><br><span class="line">    )</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `e_store`.`products`(</span><br><span class="line">    `name` ,</span><br><span class="line">    `brand_id` ,</span><br><span class="line">    `category_id` ,</span><br><span class="line">    `attributes`</span><br><span class="line">)</span><br><span class="line"><span class="keyword">VALUES</span>(</span><br><span class="line">    <span class="string">&#x27;Runner&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;3&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;3&#x27;</span> ,</span><br><span class="line">    JSON_MERGE(</span><br><span class="line">        <span class="built_in">JSON_OBJECT</span>(&quot;sensor_type&quot; , &quot;CMOS&quot;) ,</span><br><span class="line">        <span class="built_in">JSON_OBJECT</span>(&quot;processor&quot; , &quot;Digic DV II&quot;) ,</span><br><span class="line">        <span class="built_in">JSON_OBJECT</span>(&quot;scanning_system&quot; , &quot;progressive&quot;) ,</span><br><span class="line">        <span class="built_in">JSON_OBJECT</span>(&quot;mount_type&quot; , &quot;PL&quot;) ,</span><br><span class="line">        <span class="built_in">JSON_OBJECT</span>(&quot;monitor_type&quot; , &quot;LED&quot;)</span><br><span class="line">    )</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `e_store`.`products`(</span><br><span class="line">    `name` ,</span><br><span class="line">    `brand_id` ,</span><br><span class="line">    `category_id` ,</span><br><span class="line">    `attributes`</span><br><span class="line">)</span><br><span class="line"><span class="keyword">VALUES</span>(</span><br><span class="line">    <span class="string">&#x27;Traveler&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;3&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;3&#x27;</span> ,</span><br><span class="line">    JSON_MERGE(</span><br><span class="line">        <span class="built_in">JSON_OBJECT</span>(&quot;sensor_type&quot; , &quot;CMOS&quot;) ,</span><br><span class="line">        <span class="string">&#x27;&#123;&quot;processor&quot;: &quot;Digic DV II&quot;&#125;&#x27;</span> ,</span><br><span class="line">        <span class="string">&#x27;&#123;&quot;scanning_system&quot;: &quot;progressive&quot;&#125;&#x27;</span> ,</span><br><span class="line">        <span class="string">&#x27;&#123;&quot;mount_type&quot;: &quot;PL&quot;&#125;&#x27;</span> ,</span><br><span class="line">        <span class="string">&#x27;&#123;&quot;monitor_type&quot;: &quot;LCD&quot;&#125;&#x27;</span></span><br><span class="line">    )</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `e_store`.`products`(</span><br><span class="line">    `name` ,</span><br><span class="line">    `brand_id` ,</span><br><span class="line">    `category_id` ,</span><br><span class="line">    `attributes`</span><br><span class="line">)</span><br><span class="line"><span class="keyword">VALUES</span>(</span><br><span class="line">    <span class="string">&#x27;Walker&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;3&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;3&#x27;</span> ,</span><br><span class="line">    JSON_MERGE(</span><br><span class="line">        <span class="string">&#x27;&#123;&quot;sensor_type&quot;: &quot;CMOS&quot;&#125;&#x27;</span> ,</span><br><span class="line">        <span class="string">&#x27;&#123;&quot;processor&quot;: &quot;Digic DV I&quot;&#125;&#x27;</span> ,</span><br><span class="line">        <span class="string">&#x27;&#123;&quot;scanning_system&quot;: &quot;progressive&quot;&#125;&#x27;</span> ,</span><br><span class="line">        <span class="string">&#x27;&#123;&quot;mount_type&quot;: &quot;PL&quot;&#125;&#x27;</span> ,</span><br><span class="line">        <span class="string">&#x27;&#123;&quot;monitor_type&quot;: &quot;LED&quot;&#125;&#x27;</span></span><br><span class="line">    )</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `e_store`.`products`(</span><br><span class="line">    `name` ,</span><br><span class="line">    `brand_id` ,</span><br><span class="line">    `category_id` ,</span><br><span class="line">    `attributes`</span><br><span class="line">)</span><br><span class="line"><span class="keyword">VALUES</span>(</span><br><span class="line">    <span class="string">&#x27;Jumper&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;3&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;3&#x27;</span> ,</span><br><span class="line">    JSON_MERGE(</span><br><span class="line">        <span class="string">&#x27;&#123;&quot;sensor_type&quot;: &quot;CMOS&quot;&#125;&#x27;</span> ,</span><br><span class="line">        <span class="string">&#x27;&#123;&quot;processor&quot;: &quot;Digic DV I&quot;&#125;&#x27;</span> ,</span><br><span class="line">        <span class="string">&#x27;&#123;&quot;scanning_system&quot;: &quot;progressive&quot;&#125;&#x27;</span> ,</span><br><span class="line">        <span class="string">&#x27;&#123;&quot;mount_type&quot;: &quot;PL&quot;&#125;&#x27;</span> ,</span><br><span class="line">        <span class="string">&#x27;&#123;&quot;monitor_type&quot;: &quot;LCD&quot;&#125;&#x27;</span></span><br><span class="line">    )</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><img src="https://scotch-res.cloudinary.com/image/upload/dpr_1,w_800,q_auto:good,f_auto/media/228/jL0CBs0RRW9SbeGrreSy_6.png" alt="The products table after adding cameras"></p>
<p>There is a lot happening in these insert statements and it can get a bit confusing. However, it is pretty simple.</p>
<p>We are only passing objects to the <code>JSON_MERGE</code> function. Some of them have been constructed using the <code>JSON_OBJECT</code> function we saw previously whereas others have been passed as valid JSON strings.</p>
<p>In case of the <code>JSON_MERGE</code> function, if a key is repeated multiple times, it’s value is retained as an array in the output.</p>
<p>A proof of concept is in order I suppose.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* output: &#123;&quot;network&quot;: [&quot;GSM&quot;, &quot;CDMA&quot;, &quot;HSPA&quot;, &quot;EVDO&quot;]&#125; */</span></span><br><span class="line"><span class="keyword">SELECT</span> JSON_MERGE(</span><br><span class="line">    <span class="string">&#x27;&#123;&quot;network&quot;: &quot;GSM&quot;&#125;&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;&#123;&quot;network&quot;: &quot;CDMA&quot;&#125;&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;&#123;&quot;network&quot;: &quot;HSPA&quot;&#125;&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;&#123;&quot;network&quot;: &quot;EVDO&quot;&#125;&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>We can confirm all our queries were run successfully using the <code>JSON_TYPE</code> function which gives us the field value type.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* output: OBJECT */</span></span><br><span class="line"><span class="keyword">SELECT</span> JSON_TYPE(attributes) <span class="keyword">FROM</span> `e_store`.`products`;</span><br></pre></td></tr></table></figure>

<p><img src="https://scotch-res.cloudinary.com/image/upload/dpr_1,w_800,q_auto:good,f_auto/media/228/yIlWoY0RTfOywMsT6sTy_7.png" alt="Add attributes are JSON objects"></p>
<h3 id="Read"><a href="#Read" class="headerlink" title="Read"></a>Read</h3><p>Right, we have a few products in our database to work with.</p>
<p>For typical MySQL values that are not of type JSON, a where clause is pretty straight-forward. Just specify the column, an operator, and the values you need to work with.</p>
<p>Heuristically, when working with JSON columns, this does not work.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* It&#x27;s not that simple */</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    `e_store`.`products`</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">    attributes <span class="operator">=</span> <span class="string">&#x27;&#123;&quot;ports&quot;: &#123;&quot;usb&quot;: 3, &quot;hdmi&quot;: 1&#125;, &quot;screen&quot;: &quot;50 inch&quot;, &quot;speakers&quot;: &#123;&quot;left&quot;: &quot;10 watt&quot;, &quot;right&quot;: &quot;10 watt&quot;&#125;, &quot;resolution&quot;: &quot;2048 x 1152 pixels&quot;&#125;&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>When you wish to narrow down rows using a JSON field, you should be familiar with the concept of a path expression.</p>
<p>The most simplest definition of a path expression(think JQuery selectors) is it’s used to specify which parts of the JSON document to work with.</p>
<p>The second piece of the puzzle is the <code>JSON_EXTRACT</code> function which accepts a path expression to navigate through JSON.</p>
<p>Let us say we are interested in the range of televisions that have atleast a single USB and HDMI port.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    `e_store`.`products`</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">    `category_id` <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">AND</span> JSON_EXTRACT(`attributes` , <span class="string">&#x27;$.ports.usb&#x27;</span>) <span class="operator">&gt;</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">AND</span> JSON_EXTRACT(`attributes` , <span class="string">&#x27;$.ports.hdmi&#x27;</span>) <span class="operator">&gt;</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://scotch-res.cloudinary.com/image/upload/dpr_1,w_800,q_auto:good,f_auto/media/228/53SG0bOMQCK0v8xcXdPw_8.png" alt="Selecting records by JSON attributes"></p>
<p>The first argument to the <code>JSON_EXTRACT</code> function is the JSON to apply the path expression to which is the <code>attributes</code> column. The <code>$</code> symbol tokenizes the object to work with. The <code>$.ports.usb</code> and <code>$.ports.hdmi</code> path expressions translate to “take the usb key under ports” and “take the hdmi key under ports” respectively.</p>
<p>Once we have extracted the keys we are interested in, it is pretty simple to use the MySQL operators such as <code>&gt;</code> on them.</p>
<p>Also, the <code>JSON_EXTRACT</code> function has the alias <code>-&gt;</code> that you can use to make your queries more readable.</p>
<p>Revising our previous query.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    `e_store`.`products`</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">    `category_id` <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">AND</span> `attributes` <span class="operator">-</span><span class="operator">&gt;</span> <span class="string">&#x27;$.ports.usb&#x27;</span> <span class="operator">&gt;</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">AND</span> `attributes` <span class="operator">-</span><span class="operator">&gt;</span> <span class="string">&#x27;$.ports.hdmi&#x27;</span> <span class="operator">&gt;</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Update"><a href="#Update" class="headerlink" title="Update"></a>Update</h3><p>In order to update JSON values, we are going to use the <code>JSON_INSERT</code>, <code>JSON_REPLACE</code>, and <code>JSON_SET</code> functions. These functions also require a path expression to specify which parts of the JSON object to modify.</p>
<p>The output of these functions is a valid JSON object with the changes applied.</p>
<p>Let us modify all mobilephones to have a chipset property as well.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">UPDATE `e_store`.`products`</span><br><span class="line"><span class="keyword">SET</span> `attributes` <span class="operator">=</span> JSON_INSERT(</span><br><span class="line">    `attributes` ,</span><br><span class="line">    <span class="string">&#x27;$.chipset&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;Qualcomm&#x27;</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">    `category_id` <span class="operator">=</span> <span class="number">2</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://scotch-res.cloudinary.com/image/upload/dpr_1,w_800,q_auto:good,f_auto/media/228/udLoFDtdTXiqegwblu1H_9.png" alt="Updated mobilephones"></p>
<p>The <code>$.chipset</code> path expression identifies the position of the <code>chipset</code> property to be at the root of the object.</p>
<p>Let us update the <code>chipset</code> property to be more descriptive using the <code>JSON_REPLACE</code> function.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">UPDATE `e_store`.`products`</span><br><span class="line"><span class="keyword">SET</span> `attributes` <span class="operator">=</span> JSON_REPLACE(</span><br><span class="line">    `attributes` ,</span><br><span class="line">    <span class="string">&#x27;$.chipset&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;Qualcomm Snapdragon&#x27;</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">    `category_id` <span class="operator">=</span> <span class="number">2</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://scotch-res.cloudinary.com/image/upload/dpr_1,w_800,q_auto:good,f_auto/media/228/g8NePfG3SIqfnZrFVxzZ_10.png" alt="Updated mobilephones"></p>
<p>Easy peasy!</p>
<p>Lastly, we have the <code>JSON_SET</code> function which we will use to specify our televisions are pretty colorful.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">UPDATE `e_store`.`products`</span><br><span class="line"><span class="keyword">SET</span> `attributes` <span class="operator">=</span> JSON_SET(</span><br><span class="line">    `attributes` ,</span><br><span class="line">    <span class="string">&#x27;$.body_color&#x27;</span> ,</span><br><span class="line">    <span class="string">&#x27;red&#x27;</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">    `category_id` <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://scotch-res.cloudinary.com/image/upload/dpr_1,w_800,q_auto:good,f_auto/media/228/8JdjWDSS3GmGadfmGUZQ_11.png" alt="Updated televisions"></p>
<p>All of these functions seem identical but there is a difference in the way they behave.</p>
<p>The <code>JSON_INSERT</code> function will only add the property to the object if it does not exists already.</p>
<p>The <code>JSON_REPLACE</code> function substitutes the property only if it is found.</p>
<p>The <code>JSON_SET</code> function will add the property if it is not found else replace it.</p>
<h3 id="Delete"><a href="#Delete" class="headerlink" title="Delete"></a>Delete</h3><p>There are two parts to deleting that we will look at.</p>
<p>The first is to delete a certain key/value from your JSON columns whereas the second is to delete rows using a JSON column.</p>
<p>Let us say we are no longer providing the <code>mount_type</code> information for cameras and wish to remove it for all cameras.</p>
<p>We will do it using the <code>JSON_REMOVE</code> function which returns the updated JSON after removing the specified key based on the path expression.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">UPDATE `e_store`.`products`</span><br><span class="line"><span class="keyword">SET</span> `attributes` <span class="operator">=</span> JSON_REMOVE(`attributes` , <span class="string">&#x27;$.mount_type&#x27;</span>)</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">    `category_id` <span class="operator">=</span> <span class="number">3</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://scotch-res.cloudinary.com/image/upload/dpr_1,w_800,q_auto:good,f_auto/media/228/b55yf1CuRVq8iU96aK75_12.png" alt="Cameras after removing mount_type property"></p>
<p>For the second case, we also do not provide mobilephones anymore that have the Jellybean version of the Android OS.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> `e_store`.`products`</span><br><span class="line"><span class="keyword">WHERE</span> `category_id` <span class="operator">=</span> <span class="number">2</span></span><br><span class="line"><span class="keyword">AND</span> JSON_EXTRACT(`attributes` , <span class="string">&#x27;$.os&#x27;</span>) <span class="keyword">LIKE</span> <span class="string">&#x27;%Jellybean%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://scotch-res.cloudinary.com/image/upload/dpr_1,w_800,q_auto:good,f_auto/media/228/RJvQcJMCT273y3oF2lBg_13.png" alt="We do not sell Jellybeans anymore!"></p>
<p>As stated previously, working with a specific attribute requires the use of the <code>JSON_EXTRACT</code> function so in order to apply the <code>LIKE</code> operator, we have first extracted the <code>os</code> property of mobilephones(with the help of <code>category_id</code>) and deleted all records that contain the string <code>Jellybean</code>.</p>
<h2 id="A-Primer-for-Web-Applications"><a href="#A-Primer-for-Web-Applications" class="headerlink" title="A Primer for Web Applications"></a><a target="_blank" rel="noopener" href="https://scotch.io/tutorials/working-with-json-in-mysql#toc-a-primer-for-web-applications">A Primer for Web Applications</a></h2><p>The old days of directly working with a database are way behind us.</p>
<p>These days, frameworks insulate developers from lower-level operations and it almost feels alien for a framework fanatic not to be able to translate his/her database knowledge into an object relational mapper.</p>
<p>For the purpose of not leaving such developers heartbroken and wondering about their existence and purpose in the universe, we are going to look at how to go about the business of JSON columns in the Laravel framework.</p>
<blockquote>
<p>We will only be focusing on the parts that overlap with our subject matter which deals with JSON columns. An in-depth tutorial on the Laravel framework is beyond the scope of this piece.</p>
</blockquote>
<h2 id="Creating-the-Migrations"><a href="#Creating-the-Migrations" class="headerlink" title="Creating the Migrations"></a><a target="_blank" rel="noopener" href="https://scotch.io/tutorials/working-with-json-in-mysql#toc-creating-the-migrations">Creating the Migrations</a></h2><p>Make sure to configure your Laravel application to use a MySQL database.</p>
<p>We are going to create three migrations for <code>brands</code>, <code>categories</code>, and <code>products</code> respectively.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ php artisan make:migration create_brands</span><br><span class="line">$ php artisan make:migration create_categories</span><br><span class="line">$ php artisan make:migration create_products</span><br></pre></td></tr></table></figure>

<p>The <code>create_brands</code> and <code>create_categories</code> migrations are pretty similar and and a regulation for Laravel developers.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* database/migrations/create_brands.php */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Support</span>\<span class="title">Facades</span>\<span class="title">Schema</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Database</span>\<span class="title">Schema</span>\<span class="title">Blueprint</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Database</span>\<span class="title">Migrations</span>\<span class="title">Migration</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CreateBrands</span> <span class="keyword">extends</span> <span class="title">Migration</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Run the migrations.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> void</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">up</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Schema::create(<span class="string">&#x27;brands&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">Blueprint <span class="variable">$table</span></span>)</span>&#123;</span><br><span class="line">            <span class="variable">$table</span>-&gt;engine = <span class="string">&#x27;InnoDB&#x27;</span>;</span><br><span class="line">            <span class="variable">$table</span>-&gt;increments(<span class="string">&#x27;id&#x27;</span>);</span><br><span class="line">            <span class="variable">$table</span>-&gt;string(<span class="string">&#x27;name&#x27;</span>);</span><br><span class="line">            <span class="variable">$table</span>-&gt;timestamps();</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Reverse the migrations.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> void</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">down</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Schema::drop(<span class="string">&#x27;brands&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* database/migrations/create_categories.php */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Support</span>\<span class="title">Facades</span>\<span class="title">Schema</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Database</span>\<span class="title">Schema</span>\<span class="title">Blueprint</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Database</span>\<span class="title">Migrations</span>\<span class="title">Migration</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CreateCategories</span> <span class="keyword">extends</span> <span class="title">Migration</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Run the migrations.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> void</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">up</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Schema::create(<span class="string">&#x27;categories&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">Blueprint <span class="variable">$table</span></span>)</span>&#123;</span><br><span class="line">            <span class="variable">$table</span>-&gt;engine = <span class="string">&#x27;InnoDB&#x27;</span>;</span><br><span class="line">            <span class="variable">$table</span>-&gt;increments(<span class="string">&#x27;id&#x27;</span>);</span><br><span class="line">            <span class="variable">$table</span>-&gt;string(<span class="string">&#x27;name&#x27;</span>);</span><br><span class="line">            <span class="variable">$table</span>-&gt;timestamps();</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Reverse the migrations.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> void</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">down</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Schema::drop(<span class="string">&#x27;categories&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The <code>create_products</code> migration will also have the directives for indexes and foreign keys.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* database/migrations/create_products */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Support</span>\<span class="title">Facades</span>\<span class="title">Schema</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Database</span>\<span class="title">Schema</span>\<span class="title">Blueprint</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Database</span>\<span class="title">Migrations</span>\<span class="title">Migration</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CreateProducts</span> <span class="keyword">extends</span> <span class="title">Migration</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Run the migrations.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> void</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">up</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Schema::create(<span class="string">&#x27;products&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">Blueprint <span class="variable">$table</span></span>)</span>&#123;</span><br><span class="line">            <span class="variable">$table</span>-&gt;engine = <span class="string">&#x27;InnoDB&#x27;</span>;</span><br><span class="line">            <span class="variable">$table</span>-&gt;increments(<span class="string">&#x27;id&#x27;</span>);</span><br><span class="line">            <span class="variable">$table</span>-&gt;string(<span class="string">&#x27;name&#x27;</span>);</span><br><span class="line">            <span class="variable">$table</span>-&gt;unsignedInteger(<span class="string">&#x27;brand_id&#x27;</span>);</span><br><span class="line">            <span class="variable">$table</span>-&gt;unsignedInteger(<span class="string">&#x27;category_id&#x27;</span>);</span><br><span class="line">            <span class="variable">$table</span>-&gt;json(<span class="string">&#x27;attributes&#x27;</span>);</span><br><span class="line">            <span class="variable">$table</span>-&gt;timestamps();</span><br><span class="line">            <span class="comment">// foreign key constraints</span></span><br><span class="line">            <span class="variable">$table</span>-&gt;foreign(<span class="string">&#x27;brand_id&#x27;</span>)-&gt;references(<span class="string">&#x27;id&#x27;</span>)-&gt;on(<span class="string">&#x27;brands&#x27;</span>)-&gt;onDelete(<span class="string">&#x27;restrict&#x27;</span>)-&gt;onUpdate(<span class="string">&#x27;cascade&#x27;</span>);</span><br><span class="line">            <span class="variable">$table</span>-&gt;foreign(<span class="string">&#x27;category_id&#x27;</span>)-&gt;references(<span class="string">&#x27;id&#x27;</span>)-&gt;on(<span class="string">&#x27;categories&#x27;</span>)-&gt;onDelete(<span class="string">&#x27;restrict&#x27;</span>)-&gt;onUpdate(<span class="string">&#x27;cascade&#x27;</span>);</span><br><span class="line">            <span class="comment">// indexes</span></span><br><span class="line">            <span class="variable">$table</span>-&gt;index(<span class="string">&#x27;brand_id&#x27;</span>);</span><br><span class="line">            <span class="variable">$table</span>-&gt;index(<span class="string">&#x27;category_id&#x27;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Reverse the migrations.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> void</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">down</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Schema::drop(<span class="string">&#x27;products&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Pay attention to the <code>$table-&gt;json(&#39;attributes&#39;);</code> statement in the migration.</p>
<p>Just like creating any other table field using the appropriate data type named method, we have created a JSON column using the <code>json</code> method with the name <code>attributes</code>.</p>
<p>Also, this only works for database engines that support the JSON data type.</p>
<p>Engines, such as older versions of MySQL will not be able to carry out these migrations.</p>
<h2 id="Creating-the-Models"><a href="#Creating-the-Models" class="headerlink" title="Creating the Models"></a><a target="_blank" rel="noopener" href="https://scotch.io/tutorials/working-with-json-in-mysql#toc-creating-the-models">Creating the Models</a></h2><p>Other than associations, there is not much needed to set up our models so let’s run through them quickly.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* app/Brand.php */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">App</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Database</span>\<span class="title">Eloquent</span>\<span class="title">Model</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Brand</span> <span class="keyword">extends</span> <span class="title">Model</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">// A brand has many products</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">products</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;hasMany(<span class="string">&#x27;Product&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* app/Category.php */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">App</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Database</span>\<span class="title">Eloquent</span>\<span class="title">Model</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Category</span> <span class="keyword">extends</span> <span class="title">Model</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">// A category has many products</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">products</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;hasMany(<span class="string">&#x27;Product&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* app/Product.php */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">App</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Database</span>\<span class="title">Eloquent</span>\<span class="title">Model</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Product</span> <span class="keyword">extends</span> <span class="title">Model</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">// Cast attributes JSON to array</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$casts</span> = [</span><br><span class="line">        <span class="string">&#x27;attributes&#x27;</span> =&gt; <span class="string">&#x27;array&#x27;</span></span><br><span class="line">    ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Each product has a brand</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">brand</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;belongsTo(<span class="string">&#x27;Brand&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Each product has a category</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">category</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;belongsTo(<span class="string">&#x27;Category&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Again, our <code>Product</code> model needs a special mention.</p>
<p>The <code>$casts</code> array which has the key <code>attributes</code> set to <code>array</code> makes sure whenever a product is fetched from the database, it’s <code>attributes</code> JSON is converted to an associated array.</p>
<p>We will see later in the tutorial how this facilitates us to update records from our controller actions.</p>
<h2 id="Resource-Operations"><a href="#Resource-Operations" class="headerlink" title="Resource Operations"></a><a target="_blank" rel="noopener" href="https://scotch.io/tutorials/working-with-json-in-mysql#toc-resource-operations">Resource Operations</a></h2><h3 id="Creating-a-Product"><a href="#Creating-a-Product" class="headerlink" title="Creating a Product"></a>Creating a Product</h3><p>Speaking of the admin panel, the parameters to create a product maybe coming in through different routes since we have a number of product categories. You may also have different views to create, edit, show, and delete a product.</p>
<p>For example, a form to add a camera requires different input fields than a form to add a mobilephone so they warrant separate views.</p>
<p>Moreover, once you have the user input data, you will most probabaly run it through a request validator, separate for the camera, and the mobilephone each.</p>
<p>The final step would be to create the product through Eloquent.</p>
<p>We will be focusing on the camera resource for the rest of this tutorial. Other products can be addressed using the code produced in a similar manner.</p>
<p>Assuming we are saving a camera and the form fields are named as the respective camera attributes, here is the controller action.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// creates product in database</span></span><br><span class="line"><span class="comment">// using form fields</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">store</span>(<span class="params">Request <span class="variable">$request</span></span>)</span>&#123;</span><br><span class="line">    <span class="comment">// create object and set properties</span></span><br><span class="line">    <span class="variable">$camera</span> = <span class="keyword">new</span> \App\Product();</span><br><span class="line">    <span class="variable">$camera</span>-&gt;name = <span class="variable">$request</span>-&gt;name;</span><br><span class="line">    <span class="variable">$camera</span>-&gt;brand_id = <span class="variable">$request</span>-&gt;brand_id;</span><br><span class="line">    <span class="variable">$camera</span>-&gt;category_id = <span class="variable">$request</span>-&gt;category_id;</span><br><span class="line">    <span class="variable">$camera</span>-&gt;attributes = json_encode([</span><br><span class="line">        <span class="string">&#x27;processor&#x27;</span> =&gt; <span class="variable">$request</span>-&gt;processor,</span><br><span class="line">        <span class="string">&#x27;sensor_type&#x27;</span> =&gt; <span class="variable">$request</span>-&gt;sensor_type,</span><br><span class="line">        <span class="string">&#x27;monitor_type&#x27;</span> =&gt; <span class="variable">$request</span>-&gt;monitor_type,</span><br><span class="line">        <span class="string">&#x27;scanning_system&#x27;</span> =&gt; <span class="variable">$request</span>-&gt;scanning_system,</span><br><span class="line">    ]);</span><br><span class="line">    <span class="comment">// save to database</span></span><br><span class="line">    <span class="variable">$camera</span>-&gt;save();</span><br><span class="line">    <span class="comment">// show the created camera</span></span><br><span class="line">    <span class="keyword">return</span> view(<span class="string">&#x27;product.camera.show&#x27;</span>, [<span class="string">&#x27;camera&#x27;</span> =&gt; <span class="variable">$camera</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Fetching-Products"><a href="#Fetching-Products" class="headerlink" title="Fetching Products"></a>Fetching Products</h3><p>Recall the <code>$casts</code> array we declared earlier in the <code>Product</code> model. It will help us read and edit a product by treating attributes as an associative array.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// fetches a single product</span></span><br><span class="line"><span class="comment">// from database</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"><span class="variable">$id</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$camera</span> = \App\Product::find(<span class="variable">$id</span>);</span><br><span class="line">    <span class="keyword">return</span> view(<span class="string">&#x27;product.camera.show&#x27;</span>, [<span class="string">&#x27;camera&#x27;</span> =&gt; <span class="variable">$camera</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Your view would use the <code>$camera</code> variable in the following manner.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>Name<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123; $camera-&gt;name &#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>Brand ID<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123; $camera-&gt;brand_id &#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>Category ID<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123; $camera-&gt;category_id &#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>Processor<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123; $camera-&gt;attributes[&#x27;processor&#x27;] &#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>Sensor Type<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123; $camera-&gt;attributes[&#x27;sensor_type&#x27;] &#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>Monitor Type<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123; $camera-&gt;attributes[&#x27;monitor_type&#x27;] &#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>Scanning System<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123; $camera-&gt;attributes[&#x27;scanning_system&#x27;] &#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="Editing-a-Product"><a href="#Editing-a-Product" class="headerlink" title="Editing a Product"></a>Editing a Product</h3><p>As shown in the previous section, you can easily fetch a product and pass it to the view, which in this case would be the edit view.</p>
<p>You can use the product variable to pre-populate form fields on the edit page.</p>
<p>Updating the product based on the user input will be pretty similar to the <code>store</code> action we saw earlier, only that instead of creating a new product, you will fetch it first from the database before updating it.</p>
<h3 id="Searching-Based-on-JSON-Attributes"><a href="#Searching-Based-on-JSON-Attributes" class="headerlink" title="Searching Based on JSON Attributes"></a>Searching Based on JSON Attributes</h3><p>The last piece of the puzzle that remains to discuss is querying JSON columns using the Eloquent ORM.</p>
<p>If you have a search page that allows cameras to be searched based on their specifications provided by the user, you can do so with the following code.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// searches cameras by user provided specifications</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">search</span>(<span class="params">Request <span class="variable">$request</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$cameras</span> = \App\Product::where([</span><br><span class="line">        [<span class="string">&#x27;attributes-&gt;processor&#x27;</span>, <span class="string">&#x27;like&#x27;</span>, <span class="variable">$request</span>-&gt;processor],</span><br><span class="line">        [<span class="string">&#x27;attributes-&gt;sensor_type&#x27;</span>, <span class="string">&#x27;like&#x27;</span>, <span class="variable">$request</span>-&gt;sensor_type],</span><br><span class="line">        [<span class="string">&#x27;attributes-&gt;monitor_type&#x27;</span>, <span class="string">&#x27;like&#x27;</span>, <span class="variable">$request</span>-&gt;monitor_type],</span><br><span class="line">        [<span class="string">&#x27;attributes-&gt;scanning_system&#x27;</span>, <span class="string">&#x27;like&#x27;</span>, <span class="variable">$request</span>-&gt;scanning_system]</span><br><span class="line">    ])-&gt;get();</span><br><span class="line">    <span class="keyword">return</span> view(<span class="string">&#x27;product.camera.search&#x27;</span>, [<span class="string">&#x27;cameras&#x27;</span> =&gt; <span class="variable">$cameras</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The retrived records will now be available to the <code>product.camera.search</code> view as a <code>$cameras</code> collection.</p>
<h3 id="Deleting-a-Product"><a href="#Deleting-a-Product" class="headerlink" title="Deleting a Product"></a>Deleting a Product</h3><p>Using a non-JSON column attribute, you can delete products by specifying a where clause and then calling the <code>delete</code> method.</p>
<p>For example, in case of an ID.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\App\Product::where(<span class="string">&#x27;id&#x27;</span>, <span class="variable">$id</span>)-&gt;delete();</span><br></pre></td></tr></table></figure>

<p>For JSON columns, specify a where clause using a single or multiple attributes and then call the <code>delete</code> method.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// deletes all cameras with the sensor_type attribute as CMOS</span></span><br><span class="line">\App\Product::where(<span class="string">&#x27;attributes-&gt;sensor_type&#x27;</span>, <span class="string">&#x27;CMOS&#x27;</span>)-&gt;delete();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Curtains"><a href="#Curtains" class="headerlink" title="Curtains"></a><a target="_blank" rel="noopener" href="https://scotch.io/tutorials/working-with-json-in-mysql#toc-curtains">Curtains</a></h2><p>We have barely scratched the surface when it comes to using JSON columns in MySQL.</p>
<p>Whenever you need to save data as key/value pairs in a separate table or work with flexible attributes for an entity, you should consider using a JSON data type field instead as it can heavily contribute to compressing your database design.</p>
<p>If you are interested in diving deeper, the <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/5.7/en/json.html">MySQL documentation</a> is a great resource to explore JSON concepts futher.</p>
<p>来源：</p>
<p><a target="_blank" rel="noopener" href="https://scotch.io/tutorials/working-with-json-in-mysql">https://scotch.io/tutorials/working-with-json-in-mysql</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://hefengbao.github.io/helloworld/working-with-json-in-mysql.html" data-id="ckpqdombc00iw1r8j2p68ae1c" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/helloworld/tags/json/" rel="tag">json</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/helloworld/tags/mysql/" rel="tag">mysql</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Laravel-数据填充" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/helloworld/laravel-seeder.html" class="article-date">
  <time datetime="2020-05-22T11:34:50.000Z" itemprop="datePublished">2020-05-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/helloworld/categories/PHP/">PHP</a>►<a class="article-category-link" href="/helloworld/categories/PHP/Laravel/">Laravel</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/helloworld/laravel-seeder.html">Laravel 数据填充</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="https://learnku.com/laravel/t/2066/the-correct-method-for-filling-large-quantity-of-false-data">https://learnku.com/laravel/t/2066/the-correct-method-for-filling-large-quantity-of-false-data</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://hefengbao.github.io/helloworld/laravel-seeder.html" data-id="ckpqdoma700dz1r8jcz1jefqj" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/helloworld/tags/php/" rel="tag">php</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Deployer-使用资料" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/helloworld/deployer-usage.html" class="article-date">
  <time datetime="2020-05-22T11:31:56.000Z" itemprop="datePublished">2020-05-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/helloworld/categories/PHP/">PHP</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/helloworld/deployer-usage.html">Deployer 使用资料</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Deployer"><a href="#Deployer" class="headerlink" title="Deployer"></a>Deployer</h1><p>A deployment tool for PHP</p>
<p><a target="_blank" rel="noopener" href="https://deployer.org/">https://deployer.org/</a></p>
<p><a target="_blank" rel="noopener" href="https://learnku.com/articles/10985/deployer-real-experience-sharing">https://learnku.com/articles/10985/deployer-real-experience-sharing</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://hefengbao.github.io/helloworld/deployer-usage.html" data-id="ckpqdoma100de1r8jh9m90yrd" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/helloworld/tags/%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2/" rel="tag">项目部署</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/helloworld/page/2/">&amp;laquo; Prev</a><a class="page-number" href="/helloworld/">1</a><a class="page-number" href="/helloworld/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/helloworld/page/4/">4</a><a class="page-number" href="/helloworld/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/helloworld/page/17/">17</a><a class="extend next" rel="next" href="/helloworld/page/4/">Next &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Android/">Android</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Database/">Database</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Database/MySQL/">MySQL</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Database/Oracle/">Oracle</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Gradle/">Gradle</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Hexo/">Hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Java/">Java</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/JavaScript/">JavaScript</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Kotlin/">Kotlin</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Linux/">Linux</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Linux/Ubuntu/">Ubuntu</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/PHP/">PHP</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/PHP/Laravel/">Laravel</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Server/">Server</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Server/LNMP/">LNMP</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Server/MinIO/">MinIO</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Server/Nginx/">Nginx</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Server/Redis/">Redis</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Server/Supervisor/">Supervisor</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Server/WAMP/">WAMP</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Vue/">Vue</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Web/">Web</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Web/HTML/">HTML</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/%E5%B7%A5%E5%85%B7/">工具</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/%E5%B7%A5%E5%85%B7/Composer/">Composer</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/%E5%B7%A5%E5%85%B7/PhpStorm/">PhpStorm</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/">版本控制</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/Git/">Git</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/Gitlab/">Gitlab</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/VisualSVN/">VisualSVN</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/%E8%B5%84%E6%96%99/">资料</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/JavaScript/" rel="tag">JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/LNMP/" rel="tag">LNMP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/Laravel/" rel="tag">Laravel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/MinIO/" rel="tag">MinIO</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/OAuth-2-0/" rel="tag">OAuth 2.0</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/VisualSVN/" rel="tag">VisualSVN</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/WAMP/" rel="tag">WAMP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/android/" rel="tag">android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/android-studio/" rel="tag">android-studio</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/composer/" rel="tag">composer</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/crontab/" rel="tag">crontab</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/database/" rel="tag">database</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/elasticsearch/" rel="tag">elasticsearch</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/ffmpeg/" rel="tag">ffmpeg</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/git/" rel="tag">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/gitlab/" rel="tag">gitlab</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/gradle/" rel="tag">gradle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/hexo/" rel="tag">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/homestead/" rel="tag">homestead</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/html/" rel="tag">html</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/http/" rel="tag">http</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/iptables/" rel="tag">iptables</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/java/" rel="tag">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/josn-ld/" rel="tag">josn-ld</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/json/" rel="tag">json</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/kotlin/" rel="tag">kotlin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/laravel/" rel="tag">laravel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/mysql/" rel="tag">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/nginx/" rel="tag">nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/okhttp/" rel="tag">okhttp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/oracle/" rel="tag">oracle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/pdo-oci/" rel="tag">pdo_oci</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/php/" rel="tag">php</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/phpmyadmin/" rel="tag">phpmyadmin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/phpstorm/" rel="tag">phpstorm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/plsql/" rel="tag">plsql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/proguard/" rel="tag">proguard</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/redis/" rel="tag">redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/room/" rel="tag">room</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/server/" rel="tag">server</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/snowflake/" rel="tag">snowflake</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/supervisor/" rel="tag">supervisor</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/ubuntu/" rel="tag">ubuntu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/vscode/" rel="tag">vscode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/vue/" rel="tag">vue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/vue-router/" rel="tag">vue-router</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/web/" rel="tag">web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/wsl/" rel="tag">wsl</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/zmq/" rel="tag">zmq</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/" rel="tag">微服务</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/%E6%95%B0%E6%8D%AE%E9%9B%86/" rel="tag">数据集</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/%E8%B5%84%E6%96%99/" rel="tag">资料</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2/" rel="tag">项目部署</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/helloworld/tags/JavaScript/" style="font-size: 10px;">JavaScript</a> <a href="/helloworld/tags/LNMP/" style="font-size: 10px;">LNMP</a> <a href="/helloworld/tags/Laravel/" style="font-size: 10px;">Laravel</a> <a href="/helloworld/tags/MinIO/" style="font-size: 10px;">MinIO</a> <a href="/helloworld/tags/OAuth-2-0/" style="font-size: 10px;">OAuth 2.0</a> <a href="/helloworld/tags/VisualSVN/" style="font-size: 10px;">VisualSVN</a> <a href="/helloworld/tags/WAMP/" style="font-size: 13.33px;">WAMP</a> <a href="/helloworld/tags/android/" style="font-size: 18.33px;">android</a> <a href="/helloworld/tags/android-studio/" style="font-size: 10px;">android-studio</a> <a href="/helloworld/tags/composer/" style="font-size: 13.33px;">composer</a> <a href="/helloworld/tags/crontab/" style="font-size: 10px;">crontab</a> <a href="/helloworld/tags/database/" style="font-size: 10px;">database</a> <a href="/helloworld/tags/elasticsearch/" style="font-size: 10px;">elasticsearch</a> <a href="/helloworld/tags/ffmpeg/" style="font-size: 10px;">ffmpeg</a> <a href="/helloworld/tags/git/" style="font-size: 11.67px;">git</a> <a href="/helloworld/tags/gitlab/" style="font-size: 11.67px;">gitlab</a> <a href="/helloworld/tags/gradle/" style="font-size: 10px;">gradle</a> <a href="/helloworld/tags/hexo/" style="font-size: 11.67px;">hexo</a> <a href="/helloworld/tags/homestead/" style="font-size: 11.67px;">homestead</a> <a href="/helloworld/tags/html/" style="font-size: 10px;">html</a> <a href="/helloworld/tags/http/" style="font-size: 10px;">http</a> <a href="/helloworld/tags/iptables/" style="font-size: 10px;">iptables</a> <a href="/helloworld/tags/java/" style="font-size: 10px;">java</a> <a href="/helloworld/tags/josn-ld/" style="font-size: 10px;">josn-ld</a> <a href="/helloworld/tags/json/" style="font-size: 10px;">json</a> <a href="/helloworld/tags/kotlin/" style="font-size: 20px;">kotlin</a> <a href="/helloworld/tags/laravel/" style="font-size: 16.67px;">laravel</a> <a href="/helloworld/tags/linux/" style="font-size: 15px;">linux</a> <a href="/helloworld/tags/mysql/" style="font-size: 13.33px;">mysql</a> <a href="/helloworld/tags/nginx/" style="font-size: 11.67px;">nginx</a> <a href="/helloworld/tags/okhttp/" style="font-size: 11.67px;">okhttp</a> <a href="/helloworld/tags/oracle/" style="font-size: 13.33px;">oracle</a> <a href="/helloworld/tags/pdo-oci/" style="font-size: 10px;">pdo_oci</a> <a href="/helloworld/tags/php/" style="font-size: 13.33px;">php</a> <a href="/helloworld/tags/phpmyadmin/" style="font-size: 10px;">phpmyadmin</a> <a href="/helloworld/tags/phpstorm/" style="font-size: 10px;">phpstorm</a> <a href="/helloworld/tags/plsql/" style="font-size: 10px;">plsql</a> <a href="/helloworld/tags/proguard/" style="font-size: 10px;">proguard</a> <a href="/helloworld/tags/redis/" style="font-size: 11.67px;">redis</a> <a href="/helloworld/tags/room/" style="font-size: 10px;">room</a> <a href="/helloworld/tags/server/" style="font-size: 10px;">server</a> <a href="/helloworld/tags/snowflake/" style="font-size: 10px;">snowflake</a> <a href="/helloworld/tags/supervisor/" style="font-size: 10px;">supervisor</a> <a href="/helloworld/tags/ubuntu/" style="font-size: 13.33px;">ubuntu</a> <a href="/helloworld/tags/vscode/" style="font-size: 10px;">vscode</a> <a href="/helloworld/tags/vue/" style="font-size: 11.67px;">vue</a> <a href="/helloworld/tags/vue-router/" style="font-size: 10px;">vue-router</a> <a href="/helloworld/tags/web/" style="font-size: 10px;">web</a> <a href="/helloworld/tags/wsl/" style="font-size: 10px;">wsl</a> <a href="/helloworld/tags/zmq/" style="font-size: 10px;">zmq</a> <a href="/helloworld/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/" style="font-size: 10px;">微服务</a> <a href="/helloworld/tags/%E6%95%B0%E6%8D%AE%E9%9B%86/" style="font-size: 10px;">数据集</a> <a href="/helloworld/tags/%E8%B5%84%E6%96%99/" style="font-size: 13.33px;">资料</a> <a href="/helloworld/tags/%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2/" style="font-size: 10px;">项目部署</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2021/03/">三月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2021/02/">二月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2020/12/">十二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2020/11/">十一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2020/08/">八月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2020/06/">六月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2020/05/">五月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2020/04/">四月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2020/02/">二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2020/01/">一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2019/12/">十二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2019/11/">十一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2019/10/">十月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2019/08/">八月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2019/07/">七月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2019/06/">六月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2019/05/">五月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2019/04/">四月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2019/03/">三月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2019/02/">二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2019/01/">一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2018/12/">十二月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2018/11/">十一月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2018/09/">九月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2018/08/">八月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2018/07/">七月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2018/06/">六月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2018/05/">五月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2018/04/">四月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2018/03/">三月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2017/11/">十一月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2017/10/">十月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2017/08/">八月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2017/07/">七月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2017/06/">六月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2017/05/">五月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2017/04/">四月 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/helloworld/android-webview.html">Android Webview</a>
          </li>
        
          <li>
            <a href="/helloworld/android-constraintlayout.html">Android ConstraintLayout</a>
          </li>
        
          <li>
            <a href="/helloworld/android-media.html">Android Media</a>
          </li>
        
          <li>
            <a href="/helloworld/android-fragment.html">Android Fragment</a>
          </li>
        
          <li>
            <a href="/helloworld/android-brodcastreceiver.html">Android BrodcastReceiver</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 He Fengbao<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/helloworld/" class="mobile-nav-link">Home</a>
  
    <a href="/helloworld/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/helloworld/about" class="mobile-nav-link">About</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/helloworld/fancybox/jquery.fancybox.css">

  
<script src="/helloworld/fancybox/jquery.fancybox.pack.js"></script>




<script src="/helloworld/js/script.js"></script>




  </div>
</body>
</html>