<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>HelloWorld</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="好记性不如烂笔头，保存在收藏夹里的链接，过段时间后就可能打不开了，摘录是不错的保存方式。">
<meta property="og:type" content="website">
<meta property="og:title" content="HelloWorld">
<meta property="og:url" content="https://hefengbao.github.io/helloworld/page/7/index.html">
<meta property="og:site_name" content="HelloWorld">
<meta property="og:description" content="好记性不如烂笔头，保存在收藏夹里的链接，过段时间后就可能打不开了，摘录是不错的保存方式。">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="He Fengbao">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/helloworld/atom.xml" title="HelloWorld" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/helloworld/css/style.css">

<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/helloworld/" id="logo">HelloWorld</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/helloworld/">Home</a>
        
          <a class="main-nav-link" href="/helloworld/archives">Archives</a>
        
          <a class="main-nav-link" href="/helloworld/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/helloworld/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://hefengbao.github.io/helloworld"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-使用Supervisor管理进程" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/helloworld/supervisor.html" class="article-date">
  <time datetime="2019-12-03T09:17:14.000Z" itemprop="datePublished">2019-12-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/helloworld/categories/Server/">Server</a>►<a class="article-category-link" href="/helloworld/categories/Server/Supervisor/">Supervisor</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/helloworld/supervisor.html">使用Supervisor管理进程</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="http://supervisord.org/">Supervisor</a> 是一款使用 Python 开发的非常优秀的进程管理工具。它可以在类 UNIX 系统上让用户精确地监视与控制多组指定数量的服务进程。当监控的服务进程意外退出时，会尝试自动重启这些服务，以保持服务可用状态。</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>Supervisor <a target="_blank" rel="noopener" href="http://www.supervisord.org/installing.html">官方</a> 提供的安装方式较多，这里采用 pip 方式安装。</p>
<h3 id="安装pip"><a href="#安装pip" class="headerlink" title="安装pip"></a>安装pip</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ yum install python-pip# 升级pip$ pip install --upgrade pip$ pip -Vpip 9.0.1</span><br></pre></td></tr></table></figure>

<h3 id="安装Supervisor"><a href="#安装Supervisor" class="headerlink" title="安装Supervisor"></a>安装Supervisor</h3><p>通过 pip 安装 Supervisor：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pip install supervisorSuccessfully installed supervisor-3.3.3</span><br></pre></td></tr></table></figure>

<p>安装 Supervisor 后，会出现 supervisorctl 和 supervisord 两个程序，其中 supervisorctl 为服务监控终端，而 supervisord 才是所有监控服务的大脑。查看 supervisord 是否安装成功：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ supervisord -v3.3.3</span><br></pre></td></tr></table></figure>

<h3 id="开机启动"><a href="#开机启动" class="headerlink" title="开机启动"></a>开机启动</h3><p>将 supervisord 配置成开机启动服务，下载官方 <a target="_blank" rel="noopener" href="https://github.com/Supervisor/initscripts/blob/master/redhat-init-mingalevme">init 脚本</a>。</p>
<p>修改关键路径配置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PIDFILE&#x3D;&#x2F;var&#x2F;run&#x2F;supervisord.pid</span><br><span class="line">LOCKFILE&#x3D;&#x2F;var&#x2F;lock&#x2F;subsys&#x2F;supervisord</span><br><span class="line">OPTIONS&#x3D;&quot;-c &#x2F;etc&#x2F;supervisord.conf&quot;</span><br></pre></td></tr></table></figure>

<p>移到该文件到<code>/etc/init.d</code>目录下，并重命名为 supervisor，添加可执行权限：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ chmod 777 &#x2F;etc&#x2F;init.d&#x2F;supervisor</span><br></pre></td></tr></table></figure>

<p>配置成开机启动服务：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ chkconfig --add supervisor</span><br><span class="line">$ chkconfig supervisor on</span><br><span class="line">$ chkconfig --list | grep &quot;supervisor&quot;</span><br><span class="line">supervisor  0:off 1:off 2:on 3:on 4:on 5:on 6:off</span><br></pre></td></tr></table></figure>

<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><h3 id="生成配置文件"><a href="#生成配置文件" class="headerlink" title="生成配置文件"></a>生成配置文件</h3><p>Supervisord 安装后，需要使用如下命令生成配置文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir &#x2F;etc&#x2F;supervisor</span><br><span class="line">$ echo_supervisord_conf &gt; &#x2F;etc&#x2F;supervisor&#x2F;supervisord.conf</span><br></pre></td></tr></table></figure>

<h3 id="主配置部分"><a href="#主配置部分" class="headerlink" title="主配置部分"></a>主配置部分</h3><p><code>supervisord.conf</code>的主配置部分说明：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">[unix_http_server]</span><br><span class="line">file&#x3D;&#x2F;tmp&#x2F;supervisor.sock   ; socket文件的路径</span><br><span class="line">;chmod&#x3D;0700                 ; socket文件权限</span><br><span class="line">;chown&#x3D;nobody:nogroup       ; socket文件用户和用户组</span><br><span class="line">;username&#x3D;user              ; 连接时认证的用户名</span><br><span class="line">;password&#x3D;123               ; 连接时认证的密码</span><br><span class="line"></span><br><span class="line">[inet_http_server]          ; 监听TCP</span><br><span class="line">port&#x3D;127.0.0.1:9001         ; 监听ip和端口</span><br><span class="line">username&#x3D;user               ; 连接时认证的用户名</span><br><span class="line">password&#x3D;123                ; 连接时认证的密码</span><br><span class="line"></span><br><span class="line">[supervisord]</span><br><span class="line">logfile&#x3D;&#x2F;var&#x2F;log&#x2F;supervisord.log ; log目录</span><br><span class="line">logfile_maxbytes&#x3D;50MB        ; log文件最大空间</span><br><span class="line">logfile_backups&#x3D;10           ; log文件保持的数量</span><br><span class="line">loglevel&#x3D;info                ; log级别</span><br><span class="line">pidfile&#x3D;&#x2F;var&#x2F;run&#x2F;supervisord.pid</span><br><span class="line">nodaemon&#x3D;false               ; 是否非守护进程态运行</span><br><span class="line">minfds&#x3D;1024                  ; 系统空闲的最少文件描述符</span><br><span class="line">minprocs&#x3D;200                 ; 可用的最小进程描述符</span><br><span class="line">;umask&#x3D;022                   ; 进程创建文件的掩码</span><br><span class="line">;identifier&#x3D;supervisor       ; supervisord标识符</span><br><span class="line">;directory&#x3D;&#x2F;tmp              ; 启动前切换到的目录</span><br><span class="line">;nocleanup&#x3D;true              ; 启动前是否清除子进程的日志文件</span><br><span class="line">;childlogdir&#x3D;&#x2F;tmp            ; AUTO模式，子进程日志路径</span><br><span class="line">;environment&#x3D;KEY&#x3D;&quot;value&quot;     ; 设置环境变量</span><br><span class="line"></span><br><span class="line">[rpcinterface:supervisor]    ; XML_RPC配置</span><br><span class="line">supervisor.rpcinterface_factory &#x3D; supervisor.rpcinterface:make_main_rpcinterface</span><br><span class="line"></span><br><span class="line">[supervisorctl]</span><br><span class="line">serverurl&#x3D;unix:&#x2F;&#x2F;&#x2F;tmp&#x2F;supervisor.sock ; 连接的socket路径</span><br><span class="line">;username&#x3D;chris               ; 用户名</span><br><span class="line">;password&#x3D;123                 ; 密码</span><br><span class="line">prompt&#x3D;mysupervisor           ; 输入用户名和密码时的提示符</span><br><span class="line">;history_file&#x3D;~&#x2F;.sc_history   ; 历史操作记录存储路径</span><br><span class="line"></span><br><span class="line">[include]                     ; 包含文件，将每个进程配置为一个文件并包含</span><br><span class="line">files &#x3D; &#x2F;etc&#x2F;supervisor&#x2F;*.ini ; 多个进程的配置文件</span><br></pre></td></tr></table></figure>

<p>这部分我们不需要做太多的配置修改，如果需要开启 WEB 终端监控，则需要配置并开启 inet_http_server 项。</p>
<h3 id="进程配置部分"><a href="#进程配置部分" class="headerlink" title="进程配置部分"></a>进程配置部分</h3><p>Supervisor 需管理的进程服务配置，示例如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[program:work]                      ; 服务名，例如work</span><br><span class="line">command&#x3D;php -r &quot;sleep(10);exit(1);&quot; ; 带有参数的可执行命令</span><br><span class="line">process_name&#x3D;%(process_num)s        ; 进程名，当numprocs&gt;1时，需包含%(process_num)s</span><br><span class="line">numprocs&#x3D;2                          ; 启动进程的数目数</span><br><span class="line">;directory&#x3D;&#x2F;tmp                     ; 运行前切换到该目录</span><br><span class="line">;umask&#x3D;022                          ; 进程掩码</span><br><span class="line">;priority&#x3D;999                       ; 子进程启动关闭优先级</span><br><span class="line">autostart&#x3D;true                      ; 子进程是否被自动启动</span><br><span class="line">startsecs&#x3D;1                         ; 成功启动几秒后则认为成功启动</span><br><span class="line">;startretries&#x3D;3                     ; 子进程启动失败后，最大尝试启动的次数</span><br><span class="line">autorestart&#x3D;unexpected            ; 子进程意外退出后自动重启的选项，false, unexpected, true。unexpected表示不在exitcodes列表时重启</span><br><span class="line">exitcodes&#x3D;0,2                     ; 期待的子程序退出码</span><br><span class="line">;stopsignal&#x3D;QUIT                  ; 进程停止信号，可以为TERM,HUP,INT,QUIT,KILL,USR1,or USR2等信号，默认为TERM</span><br><span class="line">;stopwaitsecs&#x3D;10                  ; 发送停止信号后等待的最大时间</span><br><span class="line">;stopasgroup&#x3D;false                ; 是否向子进程组发送停止信号</span><br><span class="line">;killasgroup&#x3D;false                ; 是否向子进程组发送kill信号</span><br><span class="line">;redirect_stderr&#x3D;true             ; 是否重定向日志到标准输出</span><br><span class="line">stdout_logfile&#x3D;&#x2F;data&#x2F;logs&#x2F;work.log ; 进程的stdout的日志路径</span><br><span class="line">;stdout_logfile_maxbytes&#x3D;1MB      ; 日志文件最大大小</span><br><span class="line">;stdout_logfile_backups&#x3D;10</span><br><span class="line">;stdout_capture_maxbytes&#x3D;1MB</span><br><span class="line">;stderr_logfile&#x3D;&#x2F;a&#x2F;path           ; stderr的日志路径</span><br><span class="line">;stderr_logfile_maxbytes&#x3D;1MB</span><br><span class="line">;stderr_logfile_backups&#x3D;10</span><br><span class="line">;stderr_capture_maxbytes&#x3D;1MB</span><br><span class="line">;environment&#x3D;A&#x3D;&quot;1&quot;,B&#x3D;&quot;2&quot;          ; 子进程的环境变量</span><br><span class="line">;serverurl&#x3D;AUTO                   ; 子进程的环境变量SUPERVISOR_SERVER_URL</span><br></pre></td></tr></table></figure>

<blockquote>
<p>通常将每个进程的配置信息配置成独立文件，并通过 include 模块包含，这样方便修改和管理配置文件。</p>
</blockquote>
<h2 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h2><p>配置完成后，启动 supervisord 守护服务：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ supervisord -c &#x2F;etc&#x2F;supervisor&#x2F;supervisord.conf</span><br></pre></td></tr></table></figure>

<p>常用的命令参数说明：</p>
<ul>
<li>-c：指定配置文件路径</li>
<li>-n：是否非守护态运行</li>
<li>-l：日志文件目录</li>
<li>-i：唯一标识</li>
</ul>
<p>查看 supervisord 启动情况：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ ps -ef | grep &quot;supervisor&quot;</span><br><span class="line">root  24901  1  0 Sep23 ? 00:00:30 &#x2F;usr&#x2F;bin&#x2F;python &#x2F;usr&#x2F;bin&#x2F;supervisord -c &#x2F;etc&#x2F;supervisor&#x2F;supervisord.conf</span><br><span class="line">$ netstat -tunpl</span><br><span class="line">tcp 0 0 127.0.0.1:9001  0.0.0.0:*  LISTEN  24901&#x2F;python</span><br></pre></td></tr></table></figure>

<h2 id="监控进程"><a href="#监控进程" class="headerlink" title="监控进程"></a>监控进程</h2><p>Supervisor 提供了多种监控服务的方式，包括 supervisorctl 命令行终端、Web 端、XML_RPC 接口多种方式。</p>
<h3 id="命令终端"><a href="#命令终端" class="headerlink" title="命令终端"></a>命令终端</h3><p>直接使用 supervisorctl 即可在命令行终端查看所有服务的情况，如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ supervisorctl </span><br><span class="line">work:0      RUNNING   pid 31313, uptime 0:00:07</span><br><span class="line">work:1      RUNNING   pid 31318, uptime 0:00:06</span><br><span class="line"># -u 用户名 -p 密码</span><br></pre></td></tr></table></figure>

<p>supervisorctl 常用命令列表如下；</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.fanhaobai.com/2017/09/supervisor.html#">status</a>：查看服务状态</li>
<li><a target="_blank" rel="noopener" href="https://www.fanhaobai.com/2017/09/supervisor.html#">update</a>：重新加载配置文件</li>
<li><a target="_blank" rel="noopener" href="https://www.fanhaobai.com/2017/09/supervisor.html#">restart</a>：重新启动服务</li>
<li><a target="_blank" rel="noopener" href="https://www.fanhaobai.com/2017/09/supervisor.html#">stop</a>：停止服务</li>
<li><a target="_blank" rel="noopener" href="https://www.fanhaobai.com/2017/09/supervisor.html#">pid</a>：查看某服务的 pid</li>
<li><a target="_blank" rel="noopener" href="https://www.fanhaobai.com/2017/09/supervisor.html#">tail</a>：输出最新的 log 信息</li>
<li><a target="_blank" rel="noopener" href="https://www.fanhaobai.com/2017/09/supervisor.html#">shutdown</a>：关闭 supervisord 服务</li>
</ul>
<h3 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h3><p>在配置中开启 inet_http_server 后，即可通过 Web 界面便捷地监控进程服务了。</p>
<p>来源：</p>
<p><a target="_blank" rel="noopener" href="https://www.fanhaobai.com/2017/09/supervisor.html">https://www.fanhaobai.com/2017/09/supervisor.html</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://hefengbao.github.io/helloworld/supervisor.html" data-id="ckpqdom9e00b01r8j0s9oa66y" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/helloworld/tags/supervisor/" rel="tag">supervisor</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-16-Magic-Methods-That-PHP-Developers-Must-Know" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/helloworld/16-php-magic-methods.html" class="article-date">
  <time datetime="2019-11-29T09:03:30.000Z" itemprop="datePublished">2019-11-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/helloworld/categories/PHP/">PHP</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/helloworld/16-php-magic-methods.html">16 Magic Methods That PHP Developers Must Know</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>The methods which begin with two underscores (__) are called Magic Methods in PHP, and they play an important role. Magic methods include:</p>
<table>
<thead>
<tr>
<th align="left">Method Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody><tr>
<td align="left">__construct()</td>
<td align="left">the constructor of a class</td>
</tr>
<tr>
<td align="left">__destruct()</td>
<td align="left">the destructor of a class</td>
</tr>
<tr>
<td align="left">__call($funName, $arguments)</td>
<td align="left">The __call() method will be called when an undefined or inaccessible method is called.</td>
</tr>
<tr>
<td align="left">__callStatic($funName, $arguments)</td>
<td align="left">The __callStatic() method will be called when an undefined or inaccessible static method is called.</td>
</tr>
<tr>
<td align="left">__get($propertyName)</td>
<td align="left">The __get() method will be called when getting a member variable of a class.</td>
</tr>
<tr>
<td align="left">__set($property, $value)</td>
<td align="left">The __set() method will be called when setting a member variable of a class.</td>
</tr>
<tr>
<td align="left">__isset($content)</td>
<td align="left">The __isset() method will be called when calling isset() or empty() for an undefined or inaccessible member.</td>
</tr>
<tr>
<td align="left">__unset($content)</td>
<td align="left">The __unset() method will be called when calling reset() for an undefined or inaccessible member.</td>
</tr>
<tr>
<td align="left">__sleep()</td>
<td align="left">The __sleep() method will be called first when executing serialize().</td>
</tr>
<tr>
<td align="left">__wakeup()</td>
<td align="left">The __wakeup() method will be called first when deserialization() is executed.</td>
</tr>
<tr>
<td align="left">__toString()</td>
<td align="left">The __toString() method will be called when using echo method to print an object directly.</td>
</tr>
<tr>
<td align="left">__invoke()</td>
<td align="left">The __invoke() method will be called when trying to call an object in a way of calling function.</td>
</tr>
<tr>
<td align="left">__set_state($an_array)</td>
<td align="left">The __set_state() method will be called when calling var_export().</td>
</tr>
<tr>
<td align="left">__clone()</td>
<td align="left">The __clone() method will be called when the object is copied.</td>
</tr>
<tr>
<td align="left">__autoload($className)</td>
<td align="left">Try to load an undefined class.</td>
</tr>
<tr>
<td align="left">__debugInfo()</td>
<td align="left">Print debug information.</td>
</tr>
</tbody></table>
<p>In this article, we will show you how to use these PHP magic methods with some examples.</p>
<h2 id="1-construct"><a href="#1-construct" class="headerlink" title="1.__construct()"></a>1.__construct()</h2><p>The PHP constructor is the first method that is automatically called after the object is created. Each class has a constructor. If you do not explicitly declare it, then there will be a default constructor with no parameters and empty content in the class.</p>
<ol>
<li>the use of the method</li>
</ol>
<p>Constructors are usually used to perform some initialization tasks, such as setting initial values for member variables when creating objects.</p>
<ol start="2">
<li>the declaration format of the constructor in a class</li>
</ol>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__constrct</span>(<span class="params">[parameter <span class="keyword">list</span>]</span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">    Method body <span class="comment">//It&#x27;s usually used to set initial values for member variables</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Note: Only one constructor can be declared in the same class, because PHP does not support constructor overloading.</p>
</blockquote>
<p>Here is a complete example:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class">    </span>&#123;                                                                     </span><br><span class="line">            <span class="keyword">public</span> <span class="variable">$name</span>;       </span><br><span class="line">            <span class="keyword">public</span> <span class="variable">$age</span>;       </span><br><span class="line">            <span class="keyword">public</span> <span class="variable">$sex</span>;       </span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * explicitly declare a constructor with parameters</span></span><br><span class="line"><span class="comment">         */</span>                                                                                       </span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>=<span class="string">&quot;&quot;</span>, <span class="variable">$sex</span>=<span class="string">&quot;Male&quot;</span>, <span class="variable">$age</span>=<span class="number">22</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;     </span><br><span class="line">            <span class="keyword">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;sex = <span class="variable">$sex</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;age = <span class="variable">$age</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * say method</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">say</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Name：&quot;</span> . <span class="keyword">$this</span>-&gt;name . <span class="string">&quot;,Sex：&quot;</span> . <span class="keyword">$this</span>-&gt;sex . <span class="string">&quot;,Age：&quot;</span> . <span class="keyword">$this</span>-&gt;age;</span><br><span class="line">        &#125;   </span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>Create object $Person1 without any parameters.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$Person1</span> = <span class="keyword">new</span> Person();</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$Person1</span>-&gt;say(); <span class="comment">//print:Name：,Sex：Male,Age：22</span></span><br></pre></td></tr></table></figure>

<p>Create object $Person2 with parameter “Jams”.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$Person2</span> = <span class="keyword">new</span> Person(<span class="string">&quot;Jams&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$Person2</span>-&gt;say(); <span class="comment">// print: Name: Jams, Sex: Male, Age: 22</span></span><br></pre></td></tr></table></figure>

<p>Create object $Person3 with three parameters.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$Person3</span> = <span class="keyword">new</span> Person (<span class="string">&quot;Jack&quot;</span>, <span class="string">&quot;Male&quot;</span>, <span class="number">25</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$Person3</span>-&gt;say(); <span class="comment">// print: Name: Jack, Sex: Male, Age: 25</span></span><br></pre></td></tr></table></figure>

<h2 id="2-destruct"><a href="#2-destruct" class="headerlink" title="2. __destruct()"></a>2. __destruct()</h2><p>Now that we have already known what the constructor is, the destructor is the opposite.</p>
<p>Destructor allows you to perform some operations before destroying an object, such as closing a file, emptying a result set, and so on.</p>
<p>Destructor is a new feature introduced by PHP5.</p>
<p>The declaration format of the destructor is similar to that of the constructor __construct(), which means that __destruct() is also started with two underscores, and the name of the destructor is also fixed.</p>
<ol>
<li>the declaration format of destructor</li>
</ol>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//method body</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Note: Destructor cannot have any parameters.</p>
</blockquote>
<ol start="2">
<li>the use of the destructor</li>
</ol>
<p>In general, the destructor is not very common in PHP. It’s an optional part of a class, usually used to complete some cleanup tasks before the object is destroyed.</p>
<p>Here is an example of using the destructor:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>&#123;     </span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;         </span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$age</span>;         </span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$sex</span>;         </span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>=<span class="string">&quot;&quot;</span>, <span class="variable">$sex</span>=<span class="string">&quot;Male&quot;</span>, <span class="variable">$age</span>=<span class="number">22</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;   </span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;sex  = <span class="variable">$sex</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;age  = <span class="variable">$age</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * say method</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">say</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Name：&quot;</span>.<span class="keyword">$this</span>-&gt;name.<span class="string">&quot;,Sex：&quot;</span>.<span class="keyword">$this</span>-&gt;sex.<span class="string">&quot;,Age：&quot;</span>.<span class="keyword">$this</span>-&gt;age;</span><br><span class="line">    &#125;   </span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * declare a destructor method</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Well, my name is &quot;</span>.<span class="keyword">$this</span>-&gt;name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$Person</span> = <span class="keyword">new</span> Person(<span class="string">&quot;John&quot;</span>);</span><br><span class="line"><span class="keyword">unset</span>(<span class="variable">$Person</span>); <span class="comment">//destroy the object of $Person created above</span></span><br></pre></td></tr></table></figure>

<p>The output of the program above is:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Well, my name is John</span><br></pre></td></tr></table></figure>

<h2 id="3-call"><a href="#3-call" class="headerlink" title="3. __call()"></a>3. __call()</h2><p>This method takes two parameters. The first parameter $function_name will automatically receive the undefined method name, while the second $arguments will receive multiple arguments of the method as an array.</p>
<p>1)The use of __call() method</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$function_name</span>, <span class="keyword">array</span> <span class="variable">$arguments</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// method body</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>When an undefined method is called in a program, the __call() method will be called automatically.</p>
<p>Here is an example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class Person</span><br><span class="line">&#123;                             </span><br><span class="line">    function say()</span><br><span class="line">    &#123;</span><br><span class="line">           echo &quot;Hello, world!&lt;br&gt;&quot;;</span><br><span class="line">    &#125;     </span><br><span class="line"></span><br><span class="line">    function __call($funName, $arguments)</span><br><span class="line">    &#123;</span><br><span class="line">          echo &quot;The function you called：&quot; . $funName . &quot;(parameter：&quot; ;  &#x2F;&#x2F; Print the method&#39;s name that is not existed.</span><br><span class="line">          print_r($arguments); &#x2F;&#x2F; Print the parameter list of the method that is not existed.</span><br><span class="line">          echo &quot;)does not exist!！&lt;br&gt;\n&quot;;                   </span><br><span class="line">    &#125;                                         </span><br><span class="line">&#125;</span><br><span class="line">$Person &#x3D; new Person();           </span><br><span class="line">$Person-&gt;run(&quot;teacher&quot;); &#x2F;&#x2F; If the method which is not existed is called within the object, then the __call() method will be called automatically.</span><br><span class="line">$Person-&gt;eat(&quot;John&quot;, &quot;apple&quot;);             </span><br><span class="line">$Person-&gt;say();</span><br></pre></td></tr></table></figure>

<p>The results are as follows:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">The function you called: run (parameter: Array([0] &#x3D;&gt; teacher)) does not exist!</span><br><span class="line">The function you called: eat (parameter: Array([0] &#x3D;&gt; John[1] &#x3D;&gt; apple)) does not exist!</span><br><span class="line">Hello world!</span><br></pre></td></tr></table></figure>

<h2 id="4-callStatic"><a href="#4-callStatic" class="headerlink" title="4. __callStatic()"></a>4. __callStatic()</h2><p>When an undefined static method is called in a program, the __callStatic() method will be called automatically.</p>
<p>The use of __callStatic() is similar to the __call(). Here is an example:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">say</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Hello, world!&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">__callStatic</span>(<span class="params"><span class="variable">$funName</span>, <span class="variable">$arguments</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;The static method you called：&quot;</span> . <span class="variable">$funName</span> . <span class="string">&quot;(parameter：&quot;</span> ;  <span class="comment">// Print the method&#x27;s name that is not existed.</span></span><br><span class="line">        print_r(<span class="variable">$arguments</span>); <span class="comment">// Print the parameter list of the method that is not existed.</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;)does not exist！&lt;br&gt;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$Person</span> = <span class="keyword">new</span> Person();</span><br><span class="line"><span class="variable">$Person</span>::run(<span class="string">&quot;teacher&quot;</span>); <span class="comment">// If the method which is not existed is called within the object, then the __callStatic() method will be called automatically.</span></span><br><span class="line"><span class="variable">$Person</span>::eat(<span class="string">&quot;John&quot;</span>, <span class="string">&quot;apple&quot;</span>);</span><br><span class="line"><span class="variable">$Person</span>-&gt;say();</span><br></pre></td></tr></table></figure>

<p>The results are as follows:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">The static method you called: run (parameter: Array([0] &#x3D;&gt; teacher)) does not exist!</span><br><span class="line">The static method you called: eat (parameter: Array([0] &#x3D;&gt; John[1] &#x3D;&gt; apple)) does not exist!</span><br><span class="line">Hello world!</span><br></pre></td></tr></table></figure>

<h2 id="5-get"><a href="#5-get" class="headerlink" title="5. __get()"></a>5. __get()</h2><p>When you try to access a private property of an external object in a program, the program will throw an exception and end execution. We can use the magic method __get() to solve this problem. It can get the value of the private property of the object outside the object. Here is an example:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$age</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>=<span class="string">&quot;&quot;</span>, <span class="variable">$age</span>=<span class="number">1</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;age = <span class="variable">$age</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$propertyName</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;   </span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$propertyName</span> == <span class="string">&quot;age&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;age &gt; <span class="number">30</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;age - <span class="number">10</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;<span class="variable">$propertyName</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;<span class="variable">$propertyName</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$Person</span> = <span class="keyword">new</span> Person(<span class="string">&quot;John&quot;</span>, <span class="number">60</span>);   <span class="comment">// Instantiate the object with the Person class and assign initial values to the properties with the constructor.</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Name：&quot;</span> . <span class="variable">$Person</span>-&gt;name . <span class="string">&quot;&lt;br&gt;&quot;</span>;   <span class="comment">// When the private property is accessed, the __get() method will be called automatically,so we can get the property value indirectly.</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Age：&quot;</span> . <span class="variable">$Person</span>-&gt;age . <span class="string">&quot;&lt;br&gt;&quot;</span>;    <span class="comment">// The __get() method is called automatically，and it returns different values according to the object itself.</span></span><br></pre></td></tr></table></figure>

<p>The results are as follows:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Name: John</span><br><span class="line">Age: 50</span><br></pre></td></tr></table></figure>

<h2 id="6-set"><a href="#6-set" class="headerlink" title="6. __set()"></a>6. __set()</h2><p>The __set( $property, $value) method is used to set the private property of the object. When an undefined property is assigned, the __set() method will be triggered and the passed parameters are the property name and value that are set.</p>
<p>Here is the demo code:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$age</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>=<span class="string">&quot;&quot;</span>,  <span class="variable">$age</span>=<span class="number">25</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;age  = <span class="variable">$age</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$property</span>, <span class="variable">$value</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$property</span>==<span class="string">&quot;age&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$value</span> &gt; <span class="number">150</span> || <span class="variable">$value</span> &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;<span class="variable">$property</span> = <span class="variable">$value</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">say</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;My name is &quot;</span>.<span class="keyword">$this</span>-&gt;name.<span class="string">&quot;,I&#x27;m &quot;</span>.<span class="keyword">$this</span>-&gt;age.<span class="string">&quot; years old&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$Person</span>=<span class="keyword">new</span> Person(<span class="string">&quot;John&quot;</span>, <span class="number">25</span>); <span class="comment">//Note that the initial value will be changed by the code below.</span></span><br><span class="line"><span class="variable">$Person</span>-&gt;name = <span class="string">&quot;Lili&quot;</span>;     <span class="comment">//The &quot;name&quot; property is assigned successfully. If there is no __set() method, then the program will throw an exception.</span></span><br><span class="line"><span class="variable">$Person</span>-&gt;age = <span class="number">16</span>; <span class="comment">//The &quot;age&quot; property is assigned successfully.</span></span><br><span class="line"><span class="variable">$Person</span>-&gt;age = <span class="number">160</span>; <span class="comment">//160 is an invalid value, so it fails to be assigned.</span></span><br><span class="line"><span class="variable">$Person</span>-&gt;say();  <span class="comment">//print：My name is Lili, I&#x27;m 16 years old.</span></span><br></pre></td></tr></table></figure>

<p>Here is the result:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">My name is Lili, I&#39;m 16 years old</span><br></pre></td></tr></table></figure>

<h2 id="7-isset"><a href="#7-isset" class="headerlink" title="7. __isset()"></a>7. __isset()</h2><p>Before using the __isset () method, let me explain the use of the isset () method first. The isset () method is mainly used to determine whether the variable is set.</p>
<p>If you use the isset() method outside the object, there are two cases:</p>
<ol>
<li>If the parameter is a public property, you can use the isset() method to determine whether the property is set or not.</li>
<li>If the parameter is a private property , the isset() method will not work.</li>
</ol>
<p>So for the private property, is there any way to know if it is set? Of course, as long as we define a __isset() method in a class, we can use the isset() method outside the class to determine whether the private property is set or not.</p>
<p>When the isset() or empty() is called on an undefined or inaccessible property, the __isset() method will be called. Here is an example:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$sex</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$age</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>=<span class="string">&quot;&quot;</span>,  <span class="variable">$age</span>=<span class="number">25</span>, <span class="variable">$sex</span>=<span class="string">&#x27;Male&#x27;</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;age  = <span class="variable">$age</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;sex  = <span class="variable">$sex</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $content</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> bool</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__isset</span>(<span class="params"><span class="variable">$content</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;The <span class="subst">&#123;$content&#125;</span> property is private，the __isset() method is called automatically.&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span>  <span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;<span class="variable">$content</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$person</span> = <span class="keyword">new</span> Person(<span class="string">&quot;John&quot;</span>, <span class="number">25</span>); <span class="comment">// Initially assigned.</span></span><br><span class="line"><span class="keyword">echo</span> <span class="keyword">isset</span>(<span class="variable">$person</span>-&gt;sex),<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="keyword">isset</span>(<span class="variable">$person</span>-&gt;name),<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="keyword">isset</span>(<span class="variable">$person</span>-&gt;age),<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>The results are as follows:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">The name property is private，the __isset() method is called automatically.</span><br><span class="line">1</span><br><span class="line">The age property is private，the __isset() method is called automatically.</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<h2 id="8-unset"><a href="#8-unset" class="headerlink" title="8. __unset()"></a>8. __unset()</h2><p>Similar to the __isset() method, the __unset() method is called when the unset() method is called on an undefined or inaccessible property. Here is an example:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$sex</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$age</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>=<span class="string">&quot;&quot;</span>,  <span class="variable">$age</span>=<span class="number">25</span>, <span class="variable">$sex</span>=<span class="string">&#x27;Male&#x27;</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;age  = <span class="variable">$age</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;sex  = <span class="variable">$sex</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $content</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> bool</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__unset</span>(<span class="params"><span class="variable">$content</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;It is called automatically when we use the unset() method outside the class.&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span>  <span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;<span class="variable">$content</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$person</span> = <span class="keyword">new</span> Person(<span class="string">&quot;John&quot;</span>, <span class="number">25</span>); <span class="comment">// Initially assigned.</span></span><br><span class="line"><span class="keyword">unset</span>(<span class="variable">$person</span>-&gt;sex),<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">unset</span>(<span class="variable">$person</span>-&gt;name),<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">unset</span>(<span class="variable">$person</span>-&gt;age),<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>The results are as follows:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">It is called automatically when we use the unset() method outside the class.</span><br><span class="line">1</span><br><span class="line">It is called automatically when we use the unset() method outside the class.</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<h2 id="9-sleep"><a href="#9-sleep" class="headerlink" title="9. __sleep()"></a>9. __sleep()</h2><p>The serialize() method will check if there is a magic method __sleep() in the class. If it exists, the method will be called first and then perform the serialize operation.</p>
<p>The __sleep() method is often used to specify the properties that need to be serialized before saving data. If there are some very large objects that don’t need to be saved all, then you will find this feature is very useful.</p>
<p>For details, please refer to the following code:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$sex</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$age</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>=<span class="string">&quot;&quot;</span>,  <span class="variable">$age</span>=<span class="number">25</span>, <span class="variable">$sex</span>=<span class="string">&#x27;Male&#x27;</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;age  = <span class="variable">$age</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;sex  = <span class="variable">$sex</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> array</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;It is called when the serialize() method is called outside the class.&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = base64_encode(<span class="keyword">$this</span>-&gt;name);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">array</span>(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;age&#x27;</span>); <span class="comment">// It must return a value of which the elements are the name of the properties returned.</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$person</span> = <span class="keyword">new</span> Person(<span class="string">&#x27;John&#x27;</span>); <span class="comment">// Initially assigned.</span></span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="variable">$person</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;br/&gt;&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>The results are as follows：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">It is called when the serialize() method is called outside the class.</span><br><span class="line">O:6:&quot;Person&quot;:2:&#123;s:4:&quot;name&quot;;s:8:&quot;5bCP5piO&quot;;s:3:&quot;age&quot;;i:25;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="10-wakeup"><a href="#10-wakeup" class="headerlink" title="10. __wakeup()"></a>10. __wakeup()</h2><p>In contrast to the __sleep() method, the __wakeup() method is often used in deserialize operations, such as re-building a database connection, or performing other initialization operations.</p>
<p>Here is an example:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$sex</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$age</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>=<span class="string">&quot;&quot;</span>,  <span class="variable">$age</span>=<span class="number">25</span>, <span class="variable">$sex</span>=<span class="string">&#x27;Male&#x27;</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;age  = <span class="variable">$age</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;sex  = <span class="variable">$sex</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> array</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;It is called when the serialize() method is called outside the class.&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = base64_encode(<span class="keyword">$this</span>-&gt;name);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">array</span>(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;age&#x27;</span>); <span class="comment">// It must return a value of which the elements are the name of the properties returned.</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * __wakeup</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;It is called when the unserialize() method is called outside the class.&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;sex = <span class="string">&#x27;Male&#x27;</span>;</span><br><span class="line">        <span class="comment">// There is no need to return an array here.</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$person</span> = <span class="keyword">new</span> Person(<span class="string">&#x27;John&#x27;</span>); <span class="comment">// Initially assigned.</span></span><br><span class="line">var_dump(serialize(<span class="variable">$person</span>));</span><br><span class="line">var_dump(unserialize(serialize(<span class="variable">$person</span>)));</span><br></pre></td></tr></table></figure>

<p>The results are as follows：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">It is called when the serialize() method is called outside the class.</span><br><span class="line">string(58) &quot;O:6:&quot;Person&quot;:2:&#123;s:4:&quot;name&quot;;s:8:&quot;5bCP5piO&quot;;s:3:&quot;age&quot;;i:25;&#125;&quot;</span><br><span class="line">It is called when the unserialize() method is called outside the class.</span><br><span class="line">object(Person)#2 (3) &#123; [&quot;sex&quot;]&#x3D;&gt; string(3) &quot;Male&quot; [&quot;name&quot;]&#x3D;&gt; int(2) [&quot;age&quot;]&#x3D;&gt; int(25) &#125;</span><br></pre></td></tr></table></figure>

<h2 id="11-toString"><a href="#11-toString" class="headerlink" title="11. __toString()"></a>11. __toString()</h2><p>The __toString() method will be called when using echo method to print an object directly.</p>
<p>Note: This method must return a string, otherwise it will throw a fatal error at <code>E_RECOVERABLE_ERROR</code> level. And you also can’t throw an exception in the __toString() method.</p>
<p>Here is an example:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$sex</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$age</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>=<span class="string">&quot;&quot;</span>,  <span class="variable">$age</span>=<span class="number">25</span>, <span class="variable">$sex</span>=<span class="string">&#x27;Male&#x27;</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;age  = <span class="variable">$age</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;sex  = <span class="variable">$sex</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span>  <span class="string">&#x27;go go go&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$person</span> = <span class="keyword">new</span> Person(<span class="string">&#x27;John&#x27;</span>); <span class="comment">// Initially assigned.</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$person</span>;</span><br></pre></td></tr></table></figure>

<p>The results are as follows:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go go go</span><br></pre></td></tr></table></figure>

<p>So what if the __toString() method is not defined in the class? Let’s have a try.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$sex</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$age</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>=<span class="string">&quot;&quot;</span>,  <span class="variable">$age</span>=<span class="number">25</span>, <span class="variable">$sex</span>=<span class="string">&#x27;Male&#x27;</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;age  = <span class="variable">$age</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;sex  = <span class="variable">$sex</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$person</span> = <span class="keyword">new</span> Person(<span class="string">&#x27;John&#x27;</span>); <span class="comment">// Initially assigned.</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$person</span>;</span><br></pre></td></tr></table></figure>

<p>The results are as follows:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Catchable fatal error: Object of class Person could not be converted to string in D:\phpStudy\WWW\test\index.php on line 18</span><br></pre></td></tr></table></figure>

<p>Obviously, It reports a fatal error on the page, which is not allowed by PHP syntax.</p>
<h2 id="12-invoke"><a href="#12-invoke" class="headerlink" title="12. __invoke()"></a>12. __invoke()</h2><p>When you try to call an object in the way of calling a function, the __ invoke() method will be called automatically.</p>
<blockquote>
<p>Note: This feature is only valid in PHP 5.3.0 and above.</p>
</blockquote>
<p>Here is an example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class Person</span><br><span class="line">&#123;</span><br><span class="line">    public $sex;</span><br><span class="line">    public $name;</span><br><span class="line">    public $age;</span><br><span class="line"></span><br><span class="line">    public function __construct($name&#x3D;&quot;&quot;,  $age&#x3D;25, $sex&#x3D;&#39;Male&#39;)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;name &#x3D; $name;</span><br><span class="line">        $this-&gt;age  &#x3D; $age;</span><br><span class="line">        $this-&gt;sex  &#x3D; $sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __invoke() &#123;</span><br><span class="line">        echo &#39;This is an object&#39;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$person &#x3D; new Person(&#39;John&#39;); &#x2F;&#x2F; Initially assigned.</span><br><span class="line">$person();</span><br></pre></td></tr></table></figure>

<p>Here is the result:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">This is an object</span><br></pre></td></tr></table></figure>

<p>If you insist on using objects as methods（but not defining the __invoke() method），then you will get the following result：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Fatal error: Function name must be a string in D:\phpStudy\WWW\test\index.php on line 18</span><br></pre></td></tr></table></figure>

<h2 id="13-set-state"><a href="#13-set-state" class="headerlink" title="13.__set_state()"></a>13.__set_state()</h2><p>Starting from PHP 5.1.0, the __set_state() method is called automatically when calling var_export() to export the class code.</p>
<p>The parameters of the __set_state() method is an array containing the values of all the properties, with the format of array(‘property’ =&gt; value,…)</p>
<p>We don’t define __set_state() method in the following example:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$sex</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$age</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>=<span class="string">&quot;&quot;</span>,  <span class="variable">$age</span>=<span class="number">25</span>, <span class="variable">$sex</span>=<span class="string">&#x27;Male&#x27;</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;age  = <span class="variable">$age</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;sex  = <span class="variable">$sex</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$person</span> = <span class="keyword">new</span> Person(<span class="string">&#x27;John&#x27;</span>); <span class="comment">// Initially assigned.</span></span><br><span class="line">var_export(<span class="variable">$person</span>);</span><br></pre></td></tr></table></figure>

<p>Here is the result:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Person::__set_state(array( &#39;sex&#39; &#x3D;&gt; &#39;Male&#39;, &#39;name&#39; &#x3D;&gt; &#39;John&#39;, &#39;age&#39; &#x3D;&gt; 25, ))</span><br></pre></td></tr></table></figure>

<p>Obviously, the properties of the object are printed.</p>
<p>Now let’s have a look at the other case of being defined the __set_state() method:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$sex</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$age</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>=<span class="string">&quot;&quot;</span>,  <span class="variable">$age</span>=<span class="number">25</span>, <span class="variable">$sex</span>=<span class="string">&#x27;Male&#x27;</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;age  = <span class="variable">$age</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;sex  = <span class="variable">$sex</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">__set_state</span>(<span class="params"><span class="variable">$an_array</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$a</span> = <span class="keyword">new</span> Person();</span><br><span class="line">        <span class="variable">$a</span>-&gt;name = <span class="variable">$an_array</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$a</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$person</span> = <span class="keyword">new</span> Person(<span class="string">&#x27;John&#x27;</span>); <span class="comment">// Initially assigned.</span></span><br><span class="line"><span class="variable">$person</span>-&gt;name = <span class="string">&#x27;Jams&#x27;</span>;</span><br><span class="line">var_export(<span class="variable">$person</span>);</span><br></pre></td></tr></table></figure>

<p>Here is the result:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Person::__set_state(array( &#39;sex&#39; &#x3D;&gt; &#39;Male&#39;, &#39;name&#39; &#x3D;&gt; &#39;Jams&#39;, &#39;age&#39; &#x3D;&gt; 25, ))</span><br></pre></td></tr></table></figure>

<h2 id="14-clone"><a href="#14-clone" class="headerlink" title="14. __clone()"></a>14. __clone()</h2><p>In PHP we can use the clone keyword to copy objects with the following syntax:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$copy_of_object</span> = <span class="keyword">clone</span> <span class="variable">$object</span>;</span><br></pre></td></tr></table></figure>

<p>However, using clone keyword is just a shallow copy, because all referenced properties will still point to the original variable.</p>
<p>If a __clone() method is defined in a object, then the __clone() method will be called in the copy-generated object and can be used to modify the value of the property (if necessary).</p>
<p>Here is an example:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$sex</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$age</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>=<span class="string">&quot;&quot;</span>,  <span class="variable">$age</span>=<span class="number">25</span>, <span class="variable">$sex</span>=<span class="string">&#x27;Male&#x27;</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;age  = <span class="variable">$age</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;sex  = <span class="variable">$sex</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__clone</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">__METHOD__</span>.<span class="string">&quot;your are cloning the object.&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$person</span> = <span class="keyword">new</span> Person(<span class="string">&#x27;John&#x27;</span>); <span class="comment">// Initially assigned.</span></span><br><span class="line"><span class="variable">$person2</span> = <span class="keyword">clone</span> <span class="variable">$person</span>;</span><br><span class="line"></span><br><span class="line">var_dump(<span class="string">&#x27;persion1:&#x27;</span>);</span><br><span class="line">var_dump(<span class="variable">$person</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">var_dump(<span class="string">&#x27;persion2:&#x27;</span>);</span><br><span class="line">var_dump(<span class="variable">$person2</span>);</span><br></pre></td></tr></table></figure>

<p>The results are as follows:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Person::__clone your are cloning the object.</span><br><span class="line">string(9) &quot;persion1:&quot; object(Person)#1 (3) &#123; [&quot;sex&quot;]&#x3D;&gt; string(3) &quot;Male&quot; [&quot;name&quot;]&#x3D;&gt; string(6) &quot;John&quot; [&quot;age&quot;]&#x3D;&gt; int(25) &#125;</span><br><span class="line">string(9) &quot;persion2:&quot; object(Person)#2 (3) &#123; [&quot;sex&quot;]&#x3D;&gt; string(3) &quot;Male&quot; [&quot;name&quot;]&#x3D;&gt; string(6) &quot;John&quot; [&quot;age&quot;]&#x3D;&gt; int(25) &#125;</span><br></pre></td></tr></table></figure>

<h2 id="15-autoload"><a href="#15-autoload" class="headerlink" title="15.__autoload()"></a>15.__autoload()</h2><p>The __autoload() method can try to load an undefined class.</p>
<p>In the past, if you were to create 100 objects in a program file, then you had to use include() or require() to contain 100 class files, or you had to define the 100 classes in the same class file, for example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * file non_autoload.php</span><br><span class="line"> *&#x2F;</span><br><span class="line"></span><br><span class="line">require_once(&#39;project&#x2F;class&#x2F;A.php&#39;);</span><br><span class="line">require_once(&#39;project&#x2F;class&#x2F;B.php&#39;);</span><br><span class="line">require_once(&#39;project&#x2F;class&#x2F;C.php&#39;);</span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line"></span><br><span class="line">if (ConditionA) &#123;</span><br><span class="line">    $a &#x3D; new A();</span><br><span class="line">    $b &#x3D; new B();</span><br><span class="line">    $c &#x3D; new C();</span><br><span class="line">    &#x2F;&#x2F; …</span><br><span class="line">&#125; else if (ConditionB) &#123;</span><br><span class="line">    $a &#x3D; newA();</span><br><span class="line">    $b &#x3D; new B();</span><br><span class="line">    &#x2F;&#x2F; …</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>So what if we use the __autoload() method?</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * file autoload_demo.php</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span>  <span class="title">__autoload</span>(<span class="params"><span class="variable">$className</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$filePath</span> = “project/<span class="class"><span class="keyword">class</span>/</span>&#123;<span class="variable">$className</span>&#125;.php”;</span><br><span class="line">    <span class="keyword">if</span> (is_readable(<span class="variable">$filePath</span>)) &#123;</span><br><span class="line">        <span class="keyword">require</span>(<span class="variable">$filePath</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (ConditionA) &#123;</span><br><span class="line">    <span class="variable">$a</span> = <span class="keyword">new</span> A();</span><br><span class="line">    <span class="variable">$b</span> = <span class="keyword">new</span> B();</span><br><span class="line">    <span class="variable">$c</span> = <span class="keyword">new</span> C();</span><br><span class="line">    <span class="comment">// …</span></span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (ConditionB) &#123;</span><br><span class="line">    <span class="variable">$a</span> = newA();</span><br><span class="line">    <span class="variable">$b</span> = <span class="keyword">new</span> B();</span><br><span class="line">    <span class="comment">// …</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>When the PHP engine uses class A at the first time, if class A is not found, then the __autoload method will be called automatically and the class name “A” will be passed as a parameter. So what we need to do in the __autoload() method is to find the corresponding class file based on the class name and then include the file. If the file is not found, then the php engine will throw an exception.</p>
<h2 id="16-debugInfo"><a href="#16-debugInfo" class="headerlink" title="16. __debugInfo()"></a>16. __debugInfo()</h2><p>The __debugInfo() method will be called when the var_dump() method is executed. If the __debugInfo() method is not defined, then the var_dump() method will print out all the properties in the object.</p>
<p>Here is an example:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$prop</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$val</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;prop = <span class="variable">$val</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> array</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__debugInfo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> [</span><br><span class="line">            <span class="string">&#x27;propSquared&#x27;</span> =&gt; <span class="keyword">$this</span>-&gt;prop ** <span class="number">2</span>,</span><br><span class="line">        ];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var_dump(<span class="keyword">new</span> C(<span class="number">42</span>));</span><br></pre></td></tr></table></figure>

<p>Here is the result：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">object(C)#1 (1) &#123; [&quot;propSquared&quot;]&#x3D;&gt; int(1764) &#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Note: The __debugInfo() method should be applied to the PHP 5.6.0 and above.</p>
</blockquote>
<h2 id="Summarize"><a href="#Summarize" class="headerlink" title="Summarize"></a>Summarize</h2><p>The above are the PHP magic methods that I understand, of which commonly used include __set(), __get() and __autoload(). If you still have any questions, you can get more help from the official PHP website.</p>
<p>来源：</p>
<p> <a target="_blank" rel="noopener" href="https://www.tutorialdocs.com/article/16-php-magic-methods.html">https://www.tutorialdocs.com/article/16-php-magic-methods.html</a> </p>
<p> <a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/9Gj5sXumLuWZh5Ua3xzmqg">https://mp.weixin.qq.com/s/9Gj5sXumLuWZh5Ua3xzmqg</a> </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://hefengbao.github.io/helloworld/16-php-magic-methods.html" data-id="ckpqdomba00ik1r8j41d6cb51" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/helloworld/tags/php/" rel="tag">php</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Practical-ProGuard-rules-examples" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/helloworld/practical-proguard-rules-examples.html" class="article-date">
  <time datetime="2019-11-29T08:55:33.000Z" itemprop="datePublished">2019-11-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/helloworld/categories/Android/">Android</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/helloworld/practical-proguard-rules-examples.html">Practical ProGuard rules examples</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>In my previous article I explained <a target="_blank" rel="noopener" href="https://medium.com/google-developers/troubleshooting-proguard-issues-on-android-bce9de4f8a74">why everyone should use ProGuard for their Android apps</a>, how to enable it and what kind of errors you might encounter when doing so. There was a lot of theory involved, as I think it’s important to understand the underlying principles in order to be prepared to deal with any potential problems.</p>
<p>I also talked in a separate article about the very specific problem of <a target="_blank" rel="noopener" href="https://medium.com/google-developers/enabling-proguard-in-an-android-instant-app-fbd4fc014518">configuring ProGuard for an Instant App </a>build.</p>
<p>In this part, I’d like to talk about the practical examples of ProGuard rules on a medium sized sample app: <a target="_blank" rel="noopener" href="https://github.com/nickbutcher/plaid">Plaid</a> by <a target="_blank" rel="noopener" href="https://medium.com/u/22c02a30ae04?source=post_page-----5640a3907dc9----------------------">Nick Butcher</a>.</p>
<h1 id="Lessons-learned-from-Plaid"><a href="#Lessons-learned-from-Plaid" class="headerlink" title="Lessons learned from Plaid"></a>Lessons learned from Plaid</h1><p>Plaid actually turned out to be a great subject for researching ProGuard problems, as it contains a mix of 3rd party libraries that use things like annotation processing and code generation, reflection, java resource loading and native code (JNI). I extracted and jotted down some practical advice that should apply to other apps in general:</p>
<h1 id="Data-classes"><a href="#Data-classes" class="headerlink" title="Data classes"></a>Data classes</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">  String name;</span><br><span class="line">  <span class="keyword">int</span> age;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Probably every app has some kind of data class (also known as DMOs, models, etc. depending on context and where they sit in your app’s architecture). The thing about data objects is that usually at some point they will be loaded or saved (serialized) into some other medium, such as network (an HTTP request), a database (through an ORM), a JSON file on disk or in a Firebase data store.</p>
<p>Many of the tools that simplify serializing and deserializing these fields rely on reflection. GSON, Retrofit, Firebase — they all inspect field names in data classes and turn them into another representation (for example: <code>&#123;“name”: “Sue”, “age”: 28&#125;</code>), either for transport or storage. The same thing happens when they read data into a Java object — they see a key-value pair <code>“name”:”John”</code> and try to apply it to a Java object by looking up a <code>String name </code>field.</p>
<p><strong>Conclusion</strong>: We cannot let ProGuard rename or remove any fields on these data classes, as they have to match the serialized format. It’s a safe bet to add a <code>@Keep</code> annotation on the whole class or a wildcard rule on all your models:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-keep class io.plaidapp.data.api.dribbble.model.** &#123; *; &#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong><em>Warning*</em></strong>: It’s possible to make a mistake when testing if your app is susceptible to this issue. For example, if you serialize an object to JSON and save it to disk in version N of your app without the proper keep rules, the saved data might look like this:* <code>*&#123;“a”: “Sue”, “b”: 28&#125;*</code><em>. Because ProGuard renamed your fields to</em> <code>*a*</code> <em>and</em> <code>*b*</code><em>, everything will seem to work, data will be saved and loaded correctly.</em></p>
<p><em>However, when you build your app again and release version</em> N+1 <em>of your app, ProGuard might decide to rename your fields to something different, such as</em> <code>*c*</code> <em>and</em> <code>*d*</code><em>. As a result, data saved previously will fail to load.</em></p>
<p><em>You</em> <strong><em>must\</em></strong> <em>ensure you have the proper keep rules in the first place.</em></p>
</blockquote>
<h1 id="Java-code-called-from-native-side-JNI"><a href="#Java-code-called-from-native-side-JNI" class="headerlink" title="Java code called from native side (JNI)"></a>Java code called from native side (JNI)</h1><p>Android’s <a target="_blank" rel="noopener" href="https://developer.android.com/studio/build/shrink-code.html#shrink-code">default ProGuard files</a> (you should always include them, they have some really useful rules) already contain a rule for methods that are <em>implemented</em> on the native side (<code>-keepclasseswithmembernames class * &#123; native ; &#125;</code>). Unfortunately there is no catch-all way to keep code invoked in the opposite direction: from JNI into Java.</p>
<p>With JNI it’s entirely possible to construct a JVM object or find and call a method on a JVM handle from C/C++ code and in fact, <a target="_blank" rel="noopener" href="https://github.com/Uncodin/bypass/blob/master/platform/android/library/jni/bypass.cpp#L61">one of the libraries used in Plaid does that</a>.</p>
<p><strong>Conclusion</strong>: Because ProGuard can only inspect Java classes, it will not know about any usages that happen in native code. We must explicitly retain such usages of classes and members via a <code>@Keep</code> annotation or <code>-keep</code> rule.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-keep, includedescriptorclasses </span><br><span class="line">            class in.uncod.android.bypass.Document &#123; *; &#125;</span><br><span class="line">-keep, includedescriptorclasses </span><br><span class="line">            class in.uncod.android.bypass.Element &#123; *; &#125;</span><br></pre></td></tr></table></figure>

<h1 id="Opening-resources-from-JAR-APK"><a href="#Opening-resources-from-JAR-APK" class="headerlink" title="Opening resources from JAR/APK"></a>Opening resources from JAR/APK</h1><p>Android has its own resources and assets system that normally shouldn’t be a problem for ProGuard. However, in plain Java there is another <a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/8/docs/technotes/guides/lang/resources.html">mechanism for loading resources straight from a JAR file</a> and some third-party libraries might be using it even when compiled in Android apps (in that case they will try to load from the APK).</p>
<p>The problem is that usually these classes will look for resources under their own package name (which translates to a file path in the JAR or APK). ProGuard can rename package names when obfuscating, so after compilation it might happen that the class and its resource file are no longer in the same package in the final APK.</p>
<p>To identify loading resources in this way, you can look for calls to <code>Class.getResourceAsStream / getResource</code> and <code>ClassLoader.getResourceAsStream / getResource</code> in your code and in any third party libraries you depend on.</p>
<p><strong>Conclusion</strong>: We should keep the name of any class that loads resources from the APK using this mechanism.</p>
<p>In Plaid, there are actually two — one in the <em>OkHttp</em> library and one in <em>Jsoup</em>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-keepnames class okhttp3.internal.publicsuffix.PublicSuffixDatabase</span><br><span class="line">-keepnames class org.jsoup.nodes.Entities</span><br></pre></td></tr></table></figure>

<h1 id="How-to-come-up-with-rules-for-third-party-libraries"><a href="#How-to-come-up-with-rules-for-third-party-libraries" class="headerlink" title="How to come up with rules for third party libraries"></a>How to come up with rules for third party libraries</h1><p>In an ideal world, every dependency you use would supply their required ProGuard rules in the AAR. Sometimes they forget to do this or only publish JARs, which don’t have a standardized way to supply ProGuard rules.</p>
<p>In that case, before you start debugging your app and coming up with rules, remember to check the documentation. Some library authors supply recommended ProGuard rules (such as Retrofit used in Plaid) which can save you a lot of time and frustration. Unfortunately, many libraries don’t (such as is the case with Jsoup and Bypass mentioned in this article). Also be aware that in some cases the config supplied with the library will only work with optimizations disabled, so if you are turning them on you might be in uncharted territory.</p>
<p>So how to come up with rules when the library doesn’t supply them?<br>I can only give you some pointers:</p>
<ol>
<li>Read the build output and logcat!</li>
<li>Build warnings will tell you which <code>-dontwarn</code> rules to add</li>
<li><code>ClassNotFoundException</code>, <code>MethodNotFoundException</code> and <code>FieldNotFoundException</code> will tell you which <code>-keep</code> rules to add</li>
</ol>
<blockquote>
<p>You should be glad when your app crashes with ProGuard enabled — you’ll have somewhere to start your investigation :)</p>
<p>The worst class of problems to debug are when you app works, but for example doesn’t show a screen or doesn’t load data from the network.</p>
<p>That’s where you need to consider some of the scenarios I described in this article and get your hands dirty, even diving into the third party code and understanding why it might fail, such as when it uses reflection, introspection or JNI.</p>
</blockquote>
<h1 id="Debugging-and-stack-traces"><a href="#Debugging-and-stack-traces" class="headerlink" title="Debugging and stack traces"></a>Debugging and stack traces</h1><p>ProGuard will by default remove many code attributes and hidden metadata that are not required for program execution . Some of those are actually useful to the developer — for example, you might want to retain source file names and line numbers for stack traces to make debugging easier:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-keepattributes SourceFile, LineNumberTable</span><br></pre></td></tr></table></figure>

<blockquote>
<p>You should also remember to <a target="_blank" rel="noopener" href="https://developer.android.com/studio/build/shrink-code.html#decode-stack-trace">save the ProGuard mappings files produced when you build a release version and upload them to Play</a> to get de-obfuscated stack traces from any crashes experienced by your users.</p>
</blockquote>
<p>If you are going to attach a debugger to step through method code in a ProGuarded build of your app, you should also keep the following attributes to retain some debug information about local variables (you only need this line in your <code>debug</code> build type):</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-keepattributes LocalVariableTable, LocalVariableTypeTable</span><br></pre></td></tr></table></figure>

<h1 id="Minified-debug-build-type"><a href="#Minified-debug-build-type" class="headerlink" title="Minified debug build type"></a>Minified debug build type</h1><p>The default build types are configured such that <em>debug</em> doesn’t run ProGuard. That makes sense, because we want to iterate and compile fast when developing, but still want the release build to use ProGuard to be as small and optimized as possible.</p>
<p>But in order to fully test and debug any ProGuard problems, it’s good to set up a separate, minified debug build like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">buildTypes &#123;</span><br><span class="line">  debugMini &#123;</span><br><span class="line">    initWith debug</span><br><span class="line">    minifyEnabled true</span><br><span class="line">    shrinkResources true</span><br><span class="line">    proguardFiles getDefaultProguardFile(&#39;proguard-android.txt&#39;), </span><br><span class="line">                  &#39;proguard-rules.pro&#39;</span><br><span class="line">    matchingFallbacks &#x3D; [&#39;debug&#39;]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>With this build type, you’ll be able to <a target="_blank" rel="noopener" href="https://developer.android.com/studio/debug/index.html">connect the debugger</a>, <a target="_blank" rel="noopener" href="https://developer.android.com/training/testing/ui-testing/espresso-testing.html">run UI tests</a> (also on a CI server) or <a target="_blank" rel="noopener" href="https://developer.android.com/studio/test/monkey.html">monkey test</a> your app for possible problems on a build that’s as close to your release build as possible.</p>
<p><strong>Conclusion</strong>: When you use ProGuard you should always QA your release builds thoroughly, either by having end-to-end tests or manually going through all screens in your app to see if anything is missing or crashing.</p>
<h1 id="Runtime-annotations-type-introspection"><a href="#Runtime-annotations-type-introspection" class="headerlink" title="Runtime annotations, type introspection"></a>Runtime annotations, type introspection</h1><p>ProGuard will by default remove all annotations and even some surplus type information from your code. For some libraries that’s not a problem — those that process annotations and generate code at compile time (such as <em>Dagger 2</em> or <em>Glide</em> and many more) might not need these annotations later on when the program runs.</p>
<p>There is another class of tools that actually inspect annotations or look at type information of parameters and exceptions at runtime. Retrofit for example does this by intercepting your method calls by using a <code>Proxy</code> object, then looking at annotations and type information to decide what to put or read from the HTTP request.</p>
<p><strong>Conclusion</strong>: Sometimes it’s required to retain type information and annotations that are read at runtime, as opposed to compile time. You can check out the <a target="_blank" rel="noopener" href="https://www.guardsquare.com/en/proguard/manual/attributes">attributes list in the ProGuard manual</a>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-keepattributes *Annotation*, Signature, Exception</span><br></pre></td></tr></table></figure>

<blockquote>
<p>If you’re using the default Android ProGuard configuration file (<code>*getDefaultProguardFile(&#39;proguard-android.txt&#39;)*</code>), the first two options — Annotations and Signature — are specified for you. If you’re not using the default you have to make sure to add them yourself (it also doesn’t hurt to just duplicate them if you know they’re a requirement for your app).</p>
</blockquote>
<h1 id="Moving-everything-to-the-default-package"><a href="#Moving-everything-to-the-default-package" class="headerlink" title="Moving everything to the default package"></a>Moving everything to the default package</h1><p>The <code>-repackageclasses</code> option is not added by default in the ProGuard config. If you are already obfuscating your code and have fixed any problems with proper keep rules, you can add this option to further reduce DEX size. It works by moving all classes to the default (root) package, essentially freeing up the space taken up by strings like “<em>com.example.myapp.somepackage</em>”.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-repackageclasses</span><br></pre></td></tr></table></figure>

<h1 id="ProGuard-optimizations"><a href="#ProGuard-optimizations" class="headerlink" title="ProGuard optimizations"></a>ProGuard optimizations</h1><p>As I mentioned before, ProGuard can do 3 things for you:</p>
<ol>
<li>it gets rid of unused code,</li>
<li>renames identifiers to make the code smaller,</li>
<li>performs whole program optimizations.</li>
</ol>
<p>The way I see it, everyone should try and configure their build to get 1. and 2. working.</p>
<p>To unlock 3. (additional optimizations), you have to use a different default ProGuard configuration file. Change the <code>proguard-android.txt</code> parameter to <code>proguard-android-optimize.txt</code> in your <code>build.gradle</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">release &#123;</span><br><span class="line">  minifyEnabled true</span><br><span class="line">  proguardFiles </span><br><span class="line">      getDefaultProguardFile(&#39;proguard-android-optimize.txt&#39;),</span><br><span class="line">      &#39;proguard-rules.pro&#39;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>This will make your release build slower, but will potentially make your app run faster and reduce code size even further, thanks to optimizations such as method inlining, class merging and more aggressive code removal. Be prepared however, that it might introduce new and difficult to diagnose bugs, so use it with caution and if anything isn’t working, be sure to disable certain optimizations or disable the use of the optimizing config altogether.</p>
<p>In the case of Plaid, ProGuard optimizations interfered with how Retrofit uses Proxy objects without concrete implementations, and stripped away some method parameters that were actually required. I had to add this line to my config:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-optimizations !method&#x2F;removal&#x2F;parameter</span><br></pre></td></tr></table></figure>

<p>You can find a <a target="_blank" rel="noopener" href="https://www.guardsquare.com/en/proguard/manual/optimizations">list of possible optimizations and how to disable them in the ProGuard manual</a>.</p>
<h1 id="When-to-use-Keep-and-keep"><a href="#When-to-use-Keep-and-keep" class="headerlink" title="When to use @Keep and -keep"></a>When to use <code>@Keep</code> and <code>-keep</code></h1><p><code>@Keep</code> support is actually implemented as a bunch of <code>-keep</code> rules in the default Android ProGuard rules file, so they’re essentially equivalent. Specifying <code>-keep</code> rules is more flexible as it offers wildcards, you can also use different variants which do slightly different things (<code>-keepnames</code>, <code>-keepclasseswithmembers</code> <a target="_blank" rel="noopener" href="https://www.guardsquare.com/en/proguard/manual/usage#keepoverview">and more</a>).</p>
<p>Whenever a simple “keep this class” or “keep this method” rule is needed though, I actually prefer the simplicity of adding a<code>@Keep</code> annotation on the class or member, as it stays close to the code, almost like documentation.</p>
<p>If some other developer coming after me wants to refactor the code, they will know immediately that a class/member marked with <code>@Keep</code> requires special handling, without having to remember to consult the ProGuard configuration and risking breaking something. Also most code refactorings in the IDE should retain the <code>@Keep</code> annotation with the class automatically.</p>
<p>来源：</p>
<p><a target="_blank" rel="noopener" href="https://medium.com/androiddevelopers/practical-proguard-rules-examples-5640a3907dc9">https://medium.com/androiddevelopers/practical-proguard-rules-examples-5640a3907dc9</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://hefengbao.github.io/helloworld/practical-proguard-rules-examples.html" data-id="ckpqdom9b00am1r8jas49c2ak" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/helloworld/tags/proguard/" rel="tag">proguard</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-7-Pro-tips-for-Room" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/helloworld/7-pro-tips-for-room.html" class="article-date">
  <time datetime="2019-11-29T07:21:58.000Z" itemprop="datePublished">2019-11-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/helloworld/categories/Android/">Android</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/helloworld/7-pro-tips-for-room.html">7 Pro-tips for Room</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="1-Pre-populate-the-database"><a href="#1-Pre-populate-the-database" class="headerlink" title="1. Pre-populate the database"></a>1. Pre-populate the database</h1><p>Do you need to add default data to your database, right after it was created or when the database is opened? Use <code>RoomDatabase#Callback</code>! Call the <code>addCallback</code> method when building your RoomDatabase and override either <code>onCreate</code> or <code>onOpen</code>.</p>
<p><code>onCreate</code> will be called when the database is created for the first time, after the tables have been created. <code>onOpen</code> is called when the database was opened. Since the DAOs can only be accessed once these methods return, we‘re creating a new thread where we’re getting a reference to the database, get the DAO, and then insert the data.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Room.databaseBuilder(context.applicationContext,</span><br><span class="line">        DataDatabase::<span class="keyword">class</span>.java, <span class="string">&quot;Sample.db&quot;</span>)</span><br><span class="line">        <span class="comment">// prepopulate the database after onCreate was called</span></span><br><span class="line">        .addCallback(<span class="keyword">object</span> : Callback() &#123;</span><br><span class="line">            <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(db: <span class="type">SupportSQLiteDatabase</span>)</span></span> &#123;</span><br><span class="line">                <span class="keyword">super</span>.onCreate(db)</span><br><span class="line">                <span class="comment">// moving to a new thread</span></span><br><span class="line">                ioThread &#123;</span><br><span class="line">                    getInstance(context).dataDao()</span><br><span class="line">                                        .insert(PREPOPULATE_DATA)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        .build()</span><br></pre></td></tr></table></figure>

<p>See a full example <a target="_blank" rel="noopener" href="https://gist.github.com/florina-muntenescu/697e543652b03d3d2a06703f5d6b44b5">here</a>.</p>
<p><strong>Note</strong>: When using the <code>ioThread</code> approach, if your app crashes at the first launch, in between database creation and insert, the data will never be inserted.</p>
<h1 id="2-Use-DAO’s-inheritance-capability"><a href="#2-Use-DAO’s-inheritance-capability" class="headerlink" title="2. Use DAO’s inheritance capability"></a>2. Use DAO’s inheritance capability</h1><p>Do you have multiple tables in your database and find yourself copying the same <code>Insert</code>, <code>Update</code> and <code>Delete</code> methods? DAOs support inheritance, so create a<code>BaseDao</code>class, and define your generic <code>@Insert</code>, <code>@Update</code> and <code>@Delete</code> methods there. Have each DAO extend the <code>BaseDao</code> and add methods specific to each of them.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">BaseDao</span>&lt;<span class="type">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="meta">@Insert</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">insert</span><span class="params">(<span class="keyword">vararg</span> obj: <span class="type">T</span>)</span></span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Dao</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">DataDao</span> : <span class="type">BaseDao</span>&lt;<span class="type">Data</span>&gt;</span>() &#123;</span><br><span class="line">    <span class="meta">@Query(<span class="meta-string">&quot;SELECT * FROM Data&quot;</span>)</span></span><br><span class="line">    <span class="keyword">abstract</span> <span class="function"><span class="keyword">fun</span> <span class="title">getData</span><span class="params">()</span></span>: List&lt;Data&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>See more details <a target="_blank" rel="noopener" href="https://gist.github.com/florina-muntenescu/1c78858f286d196d545c038a71a3e864">here</a>.</p>
<p>The DAOs have to be interfaces or abstract classes because Room generates their implementation at compile time, including the methods from <code>BaseDao</code>.</p>
<h1 id="3-Execute-queries-in-transactions-with-minimal-boilerplate-code"><a href="#3-Execute-queries-in-transactions-with-minimal-boilerplate-code" class="headerlink" title="3. Execute queries in transactions with minimal boilerplate code"></a>3. Execute queries in transactions with minimal boilerplate code</h1><p>Annotating a method with <code>@Transaction</code> makes sure that all database operations you’re executing in that method will be run inside one transaction. The transaction will fail when an exception is thrown in the method body.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Dao</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Transaction</span></span><br><span class="line">    <span class="keyword">open</span> <span class="function"><span class="keyword">fun</span> <span class="title">updateData</span><span class="params">(users: <span class="type">List</span>&lt;<span class="type">User</span>&gt;)</span></span> &#123;</span><br><span class="line">        deleteAllUsers()</span><br><span class="line">        insertAll(users)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Insert</span></span><br><span class="line">    <span class="keyword">abstract</span> <span class="function"><span class="keyword">fun</span> <span class="title">insertAll</span><span class="params">(users: <span class="type">List</span>&lt;<span class="type">User</span>&gt;)</span></span></span><br><span class="line">    <span class="meta">@Query(<span class="meta-string">&quot;DELETE FROM Users&quot;</span>)</span></span><br><span class="line">    <span class="keyword">abstract</span> <span class="function"><span class="keyword">fun</span> <span class="title">deleteAllUsers</span><span class="params">()</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>You might want to use the <code>@Transaction</code> annotation for <code>@Query</code> methods that have a select statement, in the following cases:</p>
<ul>
<li>When the result of the query is fairly big. By querying the database in one transaction, you ensure that if the query result doesn’t fit in a single cursor window, it doesn’t get corrupted due to changes in the database between <a target="_blank" rel="noopener" href="https://medium.com/google-developers/large-database-queries-on-android-cb043ae626e8">cursor window swaps</a>.</li>
<li>When the result of the query is a POJO with <code>@Relation</code> fields. The fields are queries separately so running them in a single transaction will guarantee consistent results between queries.</li>
</ul>
<p><code>@Delete</code>, <code>@Update</code> and <code>@Insert</code> methods that have multiple parameters are automatically run inside a transaction.</p>
<h1 id="4-Read-only-what-you-need"><a href="#4-Read-only-what-you-need" class="headerlink" title="4. Read only what you need"></a>4. Read only what you need</h1><p>When you’re querying the database, do you use all the fields you return in your query? Take care of the amount of <strong>memory</strong> used by your app and load only the subset of fields you will end up using. This will also improve the <strong>speed of your queries</strong> by reducing the IO cost. Room will do the mapping between the columns and the object for you.</p>
<p>Consider this complex <code>User</code> object:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity(tableName = <span class="meta-string">&quot;users&quot;</span>)</span></span><br><span class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span></span>(<span class="meta">@PrimaryKey</span></span><br><span class="line">                <span class="keyword">val</span> id: String,</span><br><span class="line">                <span class="keyword">val</span> userName: String,</span><br><span class="line">                <span class="keyword">val</span> firstName: String, </span><br><span class="line">                <span class="keyword">val</span> lastName: String,</span><br><span class="line">                <span class="keyword">val</span> email: String,</span><br><span class="line">                <span class="keyword">val</span> dateOfBirth: Date, </span><br><span class="line">                <span class="keyword">val</span> registrationDate: Date)</span><br></pre></td></tr></table></figure>

<p>On some screens we don’t need to display all of this information. So instead, we can create a <code>UserMinimal</code> object that holds only the data needed.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">UserMinimal</span></span>(<span class="keyword">val</span> userId: String,</span><br><span class="line">                       <span class="keyword">val</span> firstName: String, </span><br><span class="line">                       <span class="keyword">val</span> lastName: String)</span><br></pre></td></tr></table></figure>

<p>In the DAO class, we define the query and select the right columns from the users table.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Dao</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Query(“SELECT userId, firstName, lastName FROM Users)</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">getUsersMinimal</span><span class="params">()</span></span>: List&lt;UserMinimal&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="5-Enforce-constraints-between-entities-with-foreign-keys"><a href="#5-Enforce-constraints-between-entities-with-foreign-keys" class="headerlink" title="5. Enforce constraints between entities with foreign keys"></a>5. Enforce constraints between entities with foreign keys</h1><p>Even though Room doesn’t <a target="_blank" rel="noopener" href="https://developer.android.com/topic/libraries/architecture/room.html#no-object-references">directly support relations</a>, it allows you to define Foreign Key constraints between entities.</p>
<p>Room has the <code>@ForeignKey</code> annotation, part of the <code>@Entity</code> annotation, to allow using the <a target="_blank" rel="noopener" href="https://sqlite.org/foreignkeys.html">SQLite foreign key</a> features. It enforces constraints across tables that ensure the relationship is valid when you modify the database. On an entity, define the parent entity to reference, the columns in it and the columns in the current entity.</p>
<p>Consider a <code>User</code> and a <code>Pet</code> class. The <code>Pet</code> has an owner, which is a user id referenced as foreign key.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity(tableName = <span class="meta-string">&quot;pets&quot;</span>,</span></span><br><span class="line"><span class="meta">        foreignKeys = arrayOf(</span></span><br><span class="line"><span class="meta">            ForeignKey(entity = User::class,</span></span><br><span class="line"><span class="meta">                       parentColumns = arrayOf(<span class="meta-string">&quot;userId&quot;</span>)</span>,</span><br><span class="line">                       childColumns = arrayOf(<span class="string">&quot;owner&quot;</span>))))</span><br><span class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">Pet</span></span>(<span class="meta">@PrimaryKey</span> <span class="keyword">val</span> petId: String,</span><br><span class="line">              <span class="keyword">val</span> name: String,</span><br><span class="line">              <span class="keyword">val</span> owner: String)</span><br></pre></td></tr></table></figure>

<p>Optionally, you can define what action to be taken when the parent entity is deleted or updated in the database. You can choose one of the following: <code>NO_ACTION</code>, <code>RESTRICT</code>, <code>SET_NULL</code>, <code>SET_DEFAULT</code> or <code>CASCADE</code>, that have same behaviors as in <a target="_blank" rel="noopener" href="https://sqlite.org/foreignkeys.html#fk_actions">SQLite</a>.</p>
<p><strong>Note</strong>: In Room, <code>SET_DEFAULT</code> works as <code>SET_NULL</code>, as Room does not yet allow setting default values for columns.</p>
<h1 id="6-Simplify-one-to-many-queries-via-Relation"><a href="#6-Simplify-one-to-many-queries-via-Relation" class="headerlink" title="6. Simplify one-to-many queries via @Relation"></a>6. Simplify one-to-many queries via <code>@Relation</code></h1><p>In the previous<code>User</code>-<code>Pet</code> example, we can say that we have a <strong>one-to-many relation</strong>: a user can have multiple pets. Let’s say that we want to get a list of users with their pets: <code>List</code>.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">UserAndAllPets</span> </span>(<span class="keyword">val</span> user: User,</span><br><span class="line">                           <span class="keyword">val</span> pets: List&lt;Pet&gt; = ArrayList())</span><br></pre></td></tr></table></figure>

<p>To do this manually, we would need to implement 2 queries: one to get the list of all users and another one to get the list of pets based on a user id.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Query(“SELECT * FROM Users”)</span></span><br><span class="line"><span class="keyword">public</span> List&lt;User&gt; getUsers();</span><br><span class="line"><span class="meta">@Query(“SELECT * FROM Pets where owner = :userId”)</span></span><br><span class="line"><span class="keyword">public</span> List&lt;Pet&gt; getPetsForUser(String userId);</span><br></pre></td></tr></table></figure>

<p>We would then iterate through the list of users and query the Pets table.</p>
<p>To make this simpler, Room’s <code>@Relation</code> annotation automatically fetches related entities. <code>@Relation</code> can only be applied to a <code>List</code> or <code>Set</code> of objects. The <code>UserAndAllPets</code> class has to be updated:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserAndAllPets</span> </span>&#123;</span><br><span class="line">   <span class="meta">@Embedded</span></span><br><span class="line">   <span class="keyword">var</span> user: User? = <span class="literal">null</span></span><br><span class="line">   <span class="meta">@Relation(parentColumn = “userId”,</span></span><br><span class="line"><span class="meta">             entityColumn = “owner”)</span></span><br><span class="line">   <span class="keyword">var</span> pets: List&lt;Pet&gt; = ArrayList()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>In the DAO, we define a single query and Room will query both the <code>Users</code> and the <code>Pets</code> tables and handle the object mapping.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transaction</span></span><br><span class="line"><span class="meta">@Query(“SELECT * FROM Users”)</span></span><br><span class="line">List&lt;UserAndAllPets&gt; getUsers();</span><br></pre></td></tr></table></figure>

<h1 id="7-Avoid-false-positive-notifications-for-observable-queries"><a href="#7-Avoid-false-positive-notifications-for-observable-queries" class="headerlink" title="7. Avoid false positive notifications for observable queries"></a>7. Avoid false positive notifications for observable queries</h1><p>Let’s say that you want to get a user based on the user id in an observable query:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Query(“SELECT * FROM Users WHERE userId = :id)</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">getUserById</span><span class="params">(id: <span class="type">String</span>)</span></span>: LiveData&lt;User&gt;</span><br><span class="line"><span class="comment">// or</span></span><br><span class="line"><span class="meta">@Query(“SELECT * FROM Users WHERE userId = :id)</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">getUserById</span><span class="params">(id: <span class="type">String</span>)</span></span>: Flowable&lt;User&gt;</span><br></pre></td></tr></table></figure>

<p>You’ll get a new emission of the <code>User</code> object whenever that user updates. But you will also get the same object when other changes (deletes, updates or inserts) occur on the <code>Users</code> table that have nothing to do with the <code>User</code> you’re interested in, resulting in false positive notifications. Even more, if your query involves multiple tables, you’ll get a new emission whenever something changed in any of them.</p>
<p>Here’s what’s going on behind the scenes:</p>
<ol>
<li>SQLite supports <a target="_blank" rel="noopener" href="https://sqlite.org/lang_createtrigger.html">triggers</a> that fire whenever a <code>DELETE</code>, <code>UPDATE</code> or <code>INSERT</code> happens in a table.</li>
<li>Room creates an <code>InvalidationTracker</code> that uses <code>Observers</code> that track whenever something has changed in the observed tables.</li>
<li>Both <code>LiveData</code> and <code>Flowable</code> queries rely on the <code>InvalidationTracker.Observer#onInvalidated</code> notification. When this is received, it triggers a re-query.</li>
</ol>
<p>Room only knows that the table has been modified but <strong>doesn’t know why</strong> and <strong>what</strong> has changed. Therefore, after the re-query, the result of the query is emitted by the <code>LiveData</code> or <code>Flowable</code>. Since Room doesn’t hold any data in memory and can’t assume that objects have <code>equals()</code>, it can’t tell whether this is the same data or not.</p>
<p>You need to make sure that your DAO <strong>filters emissions</strong> and only reacts to distinct objects.</p>
<p>If the observable query is implemented using <code>Flowables</code>, use <code>Flowable#distinctUntilChanged</code>.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Dao</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDao</span> : <span class="type">BaseDao</span>&lt;<span class="type">User</span>&gt;</span>() &#123;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Get a user by id.</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return</span> the user from the table with a specific id.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Query(“SELECT * FROM Users WHERE userid = :id”)</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="function"><span class="keyword">fun</span> <span class="title">getUserById</span><span class="params">(id: <span class="type">String</span>)</span></span>: Flowable&lt;User&gt;</span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">getDistinctUserById</span><span class="params">(id: <span class="type">String</span>)</span></span>: </span><br><span class="line">   Flowable&lt;User&gt; = getUserById(id)</span><br><span class="line">                          .distinctUntilChanged()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>If your query returns a <code>LiveData</code>, you can use a <code>MediatorLiveData</code> that only allows distinct object emissions from a source.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> LiveData<span class="type">&lt;T&gt;</span>.<span class="title">getDistinct</span><span class="params">()</span></span>: LiveData&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">val</span> distinctLiveData = MediatorLiveData&lt;T&gt;()</span><br><span class="line">    distinctLiveData.addSource(<span class="keyword">this</span>, <span class="keyword">object</span> : Observer&lt;T&gt; &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">var</span> initialized = <span class="literal">false</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">var</span> lastObj: T? = <span class="literal">null</span></span><br><span class="line">        <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onChanged</span><span class="params">(obj: <span class="type">T</span>?)</span></span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (!initialized) &#123;</span><br><span class="line">                initialized = <span class="literal">true</span></span><br><span class="line">                lastObj = obj</span><br><span class="line">                distinctLiveData.postValue(lastObj)</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> ((obj == <span class="literal">null</span> &amp;&amp; lastObj != <span class="literal">null</span>) </span><br><span class="line">                       || obj != lastObj) &#123;</span><br><span class="line">                lastObj = obj</span><br><span class="line">                distinctLiveData.postValue(lastObj)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> distinctLiveData</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>In your DAOs, make method that returns the distinct <code>LiveData</code> <code>public</code> and the method that queries the database <code>protected</code>.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Dao</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDao</span> : <span class="type">BaseDao</span>&lt;<span class="type">User</span>&gt;</span>() &#123;</span><br><span class="line"><span class="meta">@Query(“SELECT * FROM Users WHERE userid = :id”)</span></span><br><span class="line">   <span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="function"><span class="keyword">fun</span> <span class="title">getUserById</span><span class="params">(id: <span class="type">String</span>)</span></span>: LiveData&lt;User&gt;</span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">getDistinctUserById</span><span class="params">(id: <span class="type">String</span>)</span></span>: </span><br><span class="line">         LiveData&lt;User&gt; = getUserById(id).getDistinct()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>See more of the code <a target="_blank" rel="noopener" href="https://gist.github.com/florina-muntenescu/fea9431d0151ce0afd2f5a0b8834a6c7">here</a>.</p>
<p><strong>Note</strong>: if you’re returning a list to be displayed, consider using the <a target="_blank" rel="noopener" href="https://developer.android.com/topic/libraries/architecture/paging.html">Paging Library</a> and returning a <a target="_blank" rel="noopener" href="https://developer.android.com/reference/android/arch/paging/LivePagedListProvider.html">LivePagedListBuilder</a> since the library will help with automatically computing the diff between list items and updating your UI.</p>
<p>来源：</p>
<p> <a target="_blank" rel="noopener" href="https://medium.com/androiddevelopers/7-pro-tips-for-room-fbadea4bfbd1">https://medium.com/androiddevelopers/7-pro-tips-for-room-fbadea4bfbd1</a> </p>
<p>翻译：</p>
<p> <a target="_blank" rel="noopener" href="https://baijiahao.baidu.com/s?id=1626702427361302777&amp;wfr=spider&amp;for=pc">https://baijiahao.baidu.com/s?id=1626702427361302777&amp;wfr=spider&amp;for=pc</a> </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://hefengbao.github.io/helloworld/7-pro-tips-for-room.html" data-id="ckpqdom9b00aq1r8j6e7e1m0s" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/helloworld/tags/room/" rel="tag">room</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-LiveData-的-map-与-switchMap-操作" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/helloworld/livedata-map-switchmap.html" class="article-date">
  <time datetime="2019-10-15T02:08:12.000Z" itemprop="datePublished">2019-10-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/helloworld/categories/Android/">Android</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/helloworld/livedata-map-switchmap.html">LiveData 的 map 与 switchMap 操作</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>LiveData可以通过Transformations的map和switchMap操作，将一个LiveData转成另一种类型的LiveData，效果与RxJava的map/switchMap操作符类似。 </p>
<p>可以看看两个函数的声明</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> static &lt;X, Y&gt; LiveData&lt;Y&gt; map(</span><br><span class="line">            <span class="meta">@NonNull</span> LiveData&lt;X&gt; source,</span><br><span class="line">            <span class="meta">@NonNull</span> <span class="keyword">final</span> Function&lt;X, Y&gt; mapFunction)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> static &lt;X, Y&gt; LiveData&lt;Y&gt; switchMap(</span><br><span class="line">            <span class="meta">@NonNull</span> LiveData&lt;X&gt; source,</span><br><span class="line">            <span class="meta">@NonNull</span> <span class="keyword">final</span> Function&lt;X, LiveData&lt;Y&gt;&gt; switchMapFunction)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>根据以上代码，我们可以知道，对应的变换函数返回的类型是不一样的：map是基于泛型类型的变换，而switchMap则返回一个新的LiveData。</p>
<p>来源：</p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/qzyfKv6iOHlVobVYi-Q4Mw">https://mp.weixin.qq.com/s/qzyfKv6iOHlVobVYi-Q4Mw</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://hefengbao.github.io/helloworld/livedata-map-switchmap.html" data-id="ckpqdom9a00ai1r8jdjuqc4qc" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/helloworld/tags/android/" rel="tag">android</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-android-透明色" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/helloworld/android-color-alpha.html" class="article-date">
  <time datetime="2019-10-14T07:09:36.000Z" itemprop="datePublished">2019-10-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/helloworld/categories/Android/">Android</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/helloworld/android-color-alpha.html">android 透明色</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>设置alpha有一种局限性，会使得内容也变得透明，但是使用透明色只会使背景透明，内容不透明</p>
<p>不透明        </p>
<p>100%FF</p>
<p> 95%F2</p>
<p> 90%E6</p>
<p> 85%D9</p>
<p> 80%CC</p>
<p> 75%BF</p>
<p> 70%B3</p>
<p> 65%A6</p>
<p> 60%99</p>
<p> 55%8C</p>
<p>半透明50%80</p>
<p> 45%73</p>
<p> 40%66</p>
<p> 35%59</p>
<p> 30%4D</p>
<p> 25%40</p>
<p> 20%33</p>
<p> 15%26</p>
<p> 10%1A</p>
<p> 5%0D</p>
<p>全透明</p>
<p>0%00</p>
<p>举例：</p>
<p>全透明：#00000000</p>
<p>半透明：#80000000</p>
<p>不透明：#FF000000</p>
<p>白色半透明：#80FFFFFF</p>
<p>红色30%透明：#4Dca0d0d</p>
<p>来源：</p>
<p> <a target="_blank" rel="noopener" href="https://www.jianshu.com/p/abc95c2a0fa9">https://www.jianshu.com/p/abc95c2a0fa9</a> </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://hefengbao.github.io/helloworld/android-color-alpha.html" data-id="ckpqdom9700a61r8j9uj73ezq" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/helloworld/tags/android/" rel="tag">android</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-HTML-文档之-Head-最佳实践" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/helloworld/html-head-best-practices.html" class="article-date">
  <time datetime="2019-10-09T11:13:28.000Z" itemprop="datePublished">2019-10-09</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/helloworld/categories/Web/">Web</a>►<a class="article-category-link" href="/helloworld/categories/Web/HTML/">HTML</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/helloworld/html-head-best-practices.html">【转】HTML 文档之 Head 最佳实践</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>每一个标准的 HTML 文档都包含一个 <code>&lt;head&gt;</code> 头部分，除了声明文档类型，编码方式和文档标题，引入外部资源这些基本功能外，<head> 头还能做很多非常有用的事情，这篇文章整理了作者认可的一些最佳实践，写在这里与各位分享。</p>
        
          <p class="article-more-link">
            <a href="/helloworld/html-head-best-practices.html#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="https://hefengbao.github.io/helloworld/html-head-best-practices.html" data-id="ckpqdom9900ae1r8j1tuw8meb" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/helloworld/tags/html/" rel="tag">html</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Bottom-Navigation" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/helloworld/bottom-navigation.html" class="article-date">
  <time datetime="2019-08-23T01:54:08.000Z" itemprop="datePublished">2019-08-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/helloworld/categories/Android/">Android</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/helloworld/bottom-navigation.html">Bottom Navigation</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="Disable-Transitions-Ways"><a href="#Disable-Transitions-Ways" class="headerlink" title="Disable Transitions Ways:"></a>Disable Transitions Ways:</h3><img src="/helloworld/images/2019082301.gif" class="">

<p>The above transition we can remove by adding this</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.google.android.material.bottomnavigation.BottomNavigationView</span><br><span class="line">    ...</span><br><span class="line">    app:itemHorizontalTranslationEnabled=&quot;false&quot;/&gt;</span><br></pre></td></tr></table></figure>



<img src="/helloworld/images/2019082302.gif" class="">

<p>Now, we can also show label and remove the translation together without <code>app:itemHorizontalTranslationEnabled=&quot;false&quot;</code> this way</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.google.android.material.bottomnavigation.BottomNavigationView</span><br><span class="line">    ...</span><br><span class="line">    app:labelVisibilityMode=&quot;labeled&quot;/&gt;</span><br></pre></td></tr></table></figure>

<img src="/helloworld/images/2019082303.gif" class="">

<p>If we want the same size of bottom navigation text then we can use the value of <code>dimen.xml</code> just add this line.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resources</span> <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dimen</span> <span class="attr">name</span>=<span class="string">&quot;design_bottom_navigation_active_text_size&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">tools:override</span>=<span class="string">&quot;true&quot;</span>&gt;</span>12sp<span class="tag">&lt;/<span class="name">dimen</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br></pre></td></tr></table></figure>

<img src="/helloworld/images/2019082304.gif" class="">

<h3 id="Problem"><a href="#Problem" class="headerlink" title="Problem:"></a>Problem:</h3><p>The one problem is still here, What if the menu text is a long text? What if it was made of 2 words?</p>
<p>you will see the long text trimmed when the menu is selected. (Please look at the third menu)</p>
<img src="/helloworld/images/2019082305.gif" class="">

<h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution:"></a>Solution:</h3><p>You just need to hide the long text and show the small text by doing like this below snippet of code.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TextView largeTextView &#x3D; bottomNavigationView.findViewById(itemID)            .findViewById(com.google.android.material.R.id.largeLabel);    TextView smallTextView &#x3D; bottomNavigationView.findViewById(itemID)            .findViewById(com.google.android.material.R.id.smallLabel);    smallTextView.setVisibility(View.VISIBLE);    largeTextView.setVisibility(View.GONE);</span><br></pre></td></tr></table></figure>



<img src="/helloworld/images/2019082306.gif" class="">
      
    </div>
    <footer class="article-footer">
      <a data-url="https://hefengbao.github.io/helloworld/bottom-navigation.html" data-id="ckpqdom9800aa1r8j0ikda95v" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/helloworld/tags/android/" rel="tag">android</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-浅析-Laravel-文档推荐的-Nginx-配置" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/helloworld/laravel-recommended-nginx-conf-analysis.html" class="article-date">
  <time datetime="2019-08-21T09:19:49.000Z" itemprop="datePublished">2019-08-21</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/helloworld/categories/Server/">Server</a>►<a class="article-category-link" href="/helloworld/categories/Server/Nginx/">Nginx</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/helloworld/laravel-recommended-nginx-conf-analysis.html">浅析 Laravel 文档推荐的 Nginx 配置</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    # 监听 HTTP 协议默认的 [80] 端口。</span><br><span class="line">    listen 80;</span><br><span class="line">    # 绑定主机名 [example.com]。</span><br><span class="line">    server_name example.com;</span><br><span class="line">    # 服务器站点根目录 [&#x2F;example.com&#x2F;public]。</span><br><span class="line">    root &#x2F;example.com&#x2F;public;</span><br><span class="line"></span><br><span class="line">    # 添加几条有关安全的响应头；与 Google+ 的配置类似，详情参见文末。</span><br><span class="line">    add_header X-Frame-Options &quot;SAMEORIGIN&quot;;</span><br><span class="line">    add_header X-XSS-Protection &quot;1; mode&#x3D;block&quot;;</span><br><span class="line">    add_header X-Content-Type-Options &quot;nosniff&quot;;</span><br><span class="line"></span><br><span class="line">    # 站点默认页面；可指定多个，将顺序查找。</span><br><span class="line">    # 例如，访问 http:&#x2F;&#x2F;example.com&#x2F; Nginx 将首先尝试「站点根目录&#x2F;index.html」是否存在，不存在则继续尝试「站点根目录&#x2F;index.htm」，以此类推...</span><br><span class="line">    index index.html index.htm index.php;</span><br><span class="line"></span><br><span class="line">    # 指定字符集为 UTF-8</span><br><span class="line">    charset utf-8;</span><br><span class="line"></span><br><span class="line">    # Laravel 默认重写规则；删除将导致 Laravel 路由失效且 Nginx 响应 404。</span><br><span class="line">    location &#x2F; &#123;</span><br><span class="line">        try_files $uri $uri&#x2F; &#x2F;index.php?$query_string;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    # 关闭 [&#x2F;favicon.ico] 和 [&#x2F;robots.txt] 的访问日志。</span><br><span class="line">    # 并且即使它们不存在，也不写入错误日志。</span><br><span class="line">    location &#x3D; &#x2F;favicon.ico &#123; access_log off; log_not_found off; &#125;</span><br><span class="line">    location &#x3D; &#x2F;robots.txt  &#123; access_log off; log_not_found off; &#125;</span><br><span class="line"></span><br><span class="line">    # 将 [404] 错误交给 [&#x2F;index.php] 处理，表示由 Laravel 渲染美观的错误页面。</span><br><span class="line">    error_page 404 &#x2F;index.php;</span><br><span class="line"></span><br><span class="line">    # URI 符合正则表达式 [\.php$] 的请求将进入此段配置</span><br><span class="line">    location ~ \.php$ &#123;</span><br><span class="line">        # 配置 FastCGI 服务地址，可以为 IP:端口，也可以为 Unix socket。</span><br><span class="line">        fastcgi_pass unix:&#x2F;var&#x2F;run&#x2F;php&#x2F;php7.2-fpm.sock;</span><br><span class="line">        # 配置 FastCGI 的主页为 index.php。</span><br><span class="line">        fastcgi_index index.php;</span><br><span class="line">        # 配置 FastCGI 参数 SCRIPT_FILENAME 为 $realpath_root$fastcgi_script_name。</span><br><span class="line">        fastcgi_param SCRIPT_FILENAME $realpath_root$fastcgi_script_name;</span><br><span class="line">        # 引用更多默认的 FastCGI 参数。</span><br><span class="line">        include fastcgi_params;</span><br><span class="line">    &#125;</span><br><span class="line">    # 通俗地说，以上配置将所有 URI 以 .php 结尾的请求，全部交给 PHP-FPM 处理。</span><br><span class="line"></span><br><span class="line">    # 除符合正则表达式 [&#x2F;\.(?!well-known).*] 之外的 URI，全部拒绝访问</span><br><span class="line">    # 也就是说，拒绝公开以 [.] 开头的目录，[.well-known] 除外</span><br><span class="line">    location ~ &#x2F;\.(?!well-known).* &#123;</span><br><span class="line">        deny all;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>关于 X-Frame-Options、X-XSS-Protection 和 X-Content-Type-Options 可参考 <a target="_blank" rel="noopener" href="https://imququ.com/post/web-security-and-response-header.html">https://imququ.com/post/web-security-and-response-header.html</a></p>
<p>关于 .well-known 目录的详细解释，可参考 <a target="_blank" rel="noopener" href="https://serverfault.com/questions/795467/for-what-is-the-well-known-folder">https://serverfault.com/questions/795467/for-what-is-the-well-known-folder</a></p>
<p>来源：<a target="_blank" rel="noopener" href="https://wi1dcard.dev/posts/laravel-recommended-nginx-conf-analysis/">https://wi1dcard.dev/posts/laravel-recommended-nginx-conf-analysis/</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://hefengbao.github.io/helloworld/laravel-recommended-nginx-conf-analysis.html" data-id="ckpqdom95009y1r8jco1l62eu" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/helloworld/tags/nginx/" rel="tag">nginx</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Vue-Router" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/helloworld/vue-router.html" class="article-date">
  <time datetime="2019-07-28T08:18:55.000Z" itemprop="datePublished">2019-07-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/helloworld/categories/Vue/">Vue</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/helloworld/vue-router.html">Vue Router</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Query-parameters"><a href="#Query-parameters" class="headerlink" title="Query parameters"></a>Query parameters</h2><p><code>https://something.com/user/456?locale=en</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;router-link </span><br><span class="line">	:to&#x3D;&quot;&#123; name: &#39;pathName&#39;, </span><br><span class="line">    	   params: &#123; id: $route.params.id &#125;, </span><br><span class="line">           query: &#123; locale: &#39;en&#39; &#125; &#125;&quot;&gt;</span><br><span class="line">&lt;&#x2F;router-link&gt;</span><br></pre></td></tr></table></figure>

<h2 id="Adding-hash-fragment"><a href="#Adding-hash-fragment" class="headerlink" title="Adding hash fragment"></a>Adding hash fragment</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;router-link :to&#x3D;&quot;&#123; name: pathName, hash: &#39;#text&#39; &#125;&quot;&gt;</span><br><span class="line">	Jump to content</span><br><span class="line">&lt;&#x2F;router-link&gt;</span><br></pre></td></tr></table></figure>

<h2 id="Scroll-behavior"><a href="#Scroll-behavior" class="headerlink" title="Scroll behavior"></a>Scroll behavior</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; routes &#125; <span class="keyword">from</span> <span class="string">&#x27;./routes.js&#x27;</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter(&#123;</span><br><span class="line">	routes,</span><br><span class="line">    <span class="function"><span class="title">scrollBehavior</span>(<span class="params">to, <span class="keyword">from</span>, savedPosition</span>)</span> &#123;</span><br><span class="line">    	<span class="keyword">if</span> (savedPosition) &#123;</span><br><span class="line">        	<span class="keyword">return</span> savedPosition;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (to.hash) &#123;</span><br><span class="line">        	<span class="keyword">return</span> &#123; <span class="attr">selector</span>: to.hash &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> &#123; <span class="attr">x</span>: <span class="number">0</span>, <span class="attr">y</span>: <span class="number">0</span> &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>Here, <strong>routes</strong> are all our routes kept in a separate file. The <code>scrollBehavior()</code>function is what manages the scrolling of our routes. It has 3 parameters:</p>
<ol>
<li><em>to</em> — This represents the new route we will be visiting</li>
<li><em>from</em> — This is the previous route we came from. So if we click on a <code>&lt;router-link&gt;</code> on Home page to visit the About page, then <em>to</em> would be our About page and <em>from</em> is the Home page.</li>
<li><em>savedPosition</em> — This is the important parameter. It represents the previous position before scrolling. It will become clear after I explain what the above function does.</li>
</ol>
<h2 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h2><p><a target="_blank" rel="noopener" href="https://medium.com/@NAPOLEON039/the-lesser-known-amazing-things-vuerouter-can-do-3fbb2c191c00">https://medium.com/@NAPOLEON039/the-lesser-known-amazing-things-vuerouter-can-do-3fbb2c191c00</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://hefengbao.github.io/helloworld/vue-router.html" data-id="ckpqdom9600a21r8jckz5bgni" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/helloworld/tags/vue-router/" rel="tag">vue-router</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/helloworld/page/6/">&amp;laquo; Prev</a><a class="page-number" href="/helloworld/">1</a><span class="space">&hellip;</span><a class="page-number" href="/helloworld/page/5/">5</a><a class="page-number" href="/helloworld/page/6/">6</a><span class="page-number current">7</span><a class="page-number" href="/helloworld/page/8/">8</a><a class="page-number" href="/helloworld/page/9/">9</a><span class="space">&hellip;</span><a class="page-number" href="/helloworld/page/17/">17</a><a class="extend next" rel="next" href="/helloworld/page/8/">Next &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Android/">Android</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Database/">Database</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Database/MySQL/">MySQL</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Database/Oracle/">Oracle</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Gradle/">Gradle</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Hexo/">Hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Java/">Java</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/JavaScript/">JavaScript</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Kotlin/">Kotlin</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Linux/">Linux</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Linux/Ubuntu/">Ubuntu</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/PHP/">PHP</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/PHP/Laravel/">Laravel</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Server/">Server</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Server/LNMP/">LNMP</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Server/MinIO/">MinIO</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Server/Nginx/">Nginx</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Server/Redis/">Redis</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Server/Supervisor/">Supervisor</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Server/WAMP/">WAMP</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Vue/">Vue</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Web/">Web</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Web/HTML/">HTML</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/Windows/">Windows</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/%E5%B7%A5%E5%85%B7/">工具</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/%E5%B7%A5%E5%85%B7/Composer/">Composer</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/%E5%B7%A5%E5%85%B7/PhpStorm/">PhpStorm</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/">版本控制</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/Git/">Git</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/Gitlab/">Gitlab</a></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/VisualSVN/">VisualSVN</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/helloworld/categories/%E8%B5%84%E6%96%99/">资料</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/JavaScript/" rel="tag">JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/LNMP/" rel="tag">LNMP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/Laravel/" rel="tag">Laravel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/MinIO/" rel="tag">MinIO</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/OAuth-2-0/" rel="tag">OAuth 2.0</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/VisualSVN/" rel="tag">VisualSVN</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/WAMP/" rel="tag">WAMP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/android/" rel="tag">android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/android-studio/" rel="tag">android-studio</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/composer/" rel="tag">composer</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/crontab/" rel="tag">crontab</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/database/" rel="tag">database</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/elasticsearch/" rel="tag">elasticsearch</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/ffmpeg/" rel="tag">ffmpeg</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/git/" rel="tag">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/gitlab/" rel="tag">gitlab</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/gradle/" rel="tag">gradle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/hexo/" rel="tag">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/homestead/" rel="tag">homestead</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/html/" rel="tag">html</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/http/" rel="tag">http</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/iptables/" rel="tag">iptables</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/java/" rel="tag">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/josn-ld/" rel="tag">josn-ld</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/json/" rel="tag">json</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/kotlin/" rel="tag">kotlin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/laravel/" rel="tag">laravel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/mysql/" rel="tag">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/nginx/" rel="tag">nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/okhttp/" rel="tag">okhttp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/oracle/" rel="tag">oracle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/pdo-oci/" rel="tag">pdo_oci</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/php/" rel="tag">php</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/phpmyadmin/" rel="tag">phpmyadmin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/phpstorm/" rel="tag">phpstorm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/plsql/" rel="tag">plsql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/proguard/" rel="tag">proguard</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/redis/" rel="tag">redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/room/" rel="tag">room</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/server/" rel="tag">server</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/snowflake/" rel="tag">snowflake</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/supervisor/" rel="tag">supervisor</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/ubuntu/" rel="tag">ubuntu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/vscode/" rel="tag">vscode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/vue/" rel="tag">vue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/vue-router/" rel="tag">vue-router</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/web/" rel="tag">web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/wsl/" rel="tag">wsl</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/zmq/" rel="tag">zmq</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/" rel="tag">微服务</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/%E6%95%B0%E6%8D%AE%E9%9B%86/" rel="tag">数据集</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/%E8%B5%84%E6%96%99/" rel="tag">资料</a></li><li class="tag-list-item"><a class="tag-list-link" href="/helloworld/tags/%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2/" rel="tag">项目部署</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/helloworld/tags/JavaScript/" style="font-size: 10px;">JavaScript</a> <a href="/helloworld/tags/LNMP/" style="font-size: 10px;">LNMP</a> <a href="/helloworld/tags/Laravel/" style="font-size: 10px;">Laravel</a> <a href="/helloworld/tags/MinIO/" style="font-size: 10px;">MinIO</a> <a href="/helloworld/tags/OAuth-2-0/" style="font-size: 10px;">OAuth 2.0</a> <a href="/helloworld/tags/VisualSVN/" style="font-size: 10px;">VisualSVN</a> <a href="/helloworld/tags/WAMP/" style="font-size: 13.33px;">WAMP</a> <a href="/helloworld/tags/android/" style="font-size: 18.33px;">android</a> <a href="/helloworld/tags/android-studio/" style="font-size: 10px;">android-studio</a> <a href="/helloworld/tags/composer/" style="font-size: 13.33px;">composer</a> <a href="/helloworld/tags/crontab/" style="font-size: 10px;">crontab</a> <a href="/helloworld/tags/database/" style="font-size: 10px;">database</a> <a href="/helloworld/tags/elasticsearch/" style="font-size: 10px;">elasticsearch</a> <a href="/helloworld/tags/ffmpeg/" style="font-size: 10px;">ffmpeg</a> <a href="/helloworld/tags/git/" style="font-size: 11.67px;">git</a> <a href="/helloworld/tags/gitlab/" style="font-size: 11.67px;">gitlab</a> <a href="/helloworld/tags/gradle/" style="font-size: 10px;">gradle</a> <a href="/helloworld/tags/hexo/" style="font-size: 11.67px;">hexo</a> <a href="/helloworld/tags/homestead/" style="font-size: 11.67px;">homestead</a> <a href="/helloworld/tags/html/" style="font-size: 10px;">html</a> <a href="/helloworld/tags/http/" style="font-size: 10px;">http</a> <a href="/helloworld/tags/iptables/" style="font-size: 10px;">iptables</a> <a href="/helloworld/tags/java/" style="font-size: 10px;">java</a> <a href="/helloworld/tags/josn-ld/" style="font-size: 10px;">josn-ld</a> <a href="/helloworld/tags/json/" style="font-size: 10px;">json</a> <a href="/helloworld/tags/kotlin/" style="font-size: 20px;">kotlin</a> <a href="/helloworld/tags/laravel/" style="font-size: 16.67px;">laravel</a> <a href="/helloworld/tags/linux/" style="font-size: 15px;">linux</a> <a href="/helloworld/tags/mysql/" style="font-size: 13.33px;">mysql</a> <a href="/helloworld/tags/nginx/" style="font-size: 11.67px;">nginx</a> <a href="/helloworld/tags/okhttp/" style="font-size: 11.67px;">okhttp</a> <a href="/helloworld/tags/oracle/" style="font-size: 13.33px;">oracle</a> <a href="/helloworld/tags/pdo-oci/" style="font-size: 10px;">pdo_oci</a> <a href="/helloworld/tags/php/" style="font-size: 13.33px;">php</a> <a href="/helloworld/tags/phpmyadmin/" style="font-size: 10px;">phpmyadmin</a> <a href="/helloworld/tags/phpstorm/" style="font-size: 10px;">phpstorm</a> <a href="/helloworld/tags/plsql/" style="font-size: 10px;">plsql</a> <a href="/helloworld/tags/proguard/" style="font-size: 10px;">proguard</a> <a href="/helloworld/tags/redis/" style="font-size: 11.67px;">redis</a> <a href="/helloworld/tags/room/" style="font-size: 10px;">room</a> <a href="/helloworld/tags/server/" style="font-size: 10px;">server</a> <a href="/helloworld/tags/snowflake/" style="font-size: 10px;">snowflake</a> <a href="/helloworld/tags/supervisor/" style="font-size: 10px;">supervisor</a> <a href="/helloworld/tags/ubuntu/" style="font-size: 13.33px;">ubuntu</a> <a href="/helloworld/tags/vscode/" style="font-size: 10px;">vscode</a> <a href="/helloworld/tags/vue/" style="font-size: 11.67px;">vue</a> <a href="/helloworld/tags/vue-router/" style="font-size: 10px;">vue-router</a> <a href="/helloworld/tags/web/" style="font-size: 10px;">web</a> <a href="/helloworld/tags/wsl/" style="font-size: 11.67px;">wsl</a> <a href="/helloworld/tags/zmq/" style="font-size: 10px;">zmq</a> <a href="/helloworld/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/" style="font-size: 10px;">微服务</a> <a href="/helloworld/tags/%E6%95%B0%E6%8D%AE%E9%9B%86/" style="font-size: 10px;">数据集</a> <a href="/helloworld/tags/%E8%B5%84%E6%96%99/" style="font-size: 13.33px;">资料</a> <a href="/helloworld/tags/%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2/" style="font-size: 10px;">项目部署</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2021/06/">六月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2021/03/">三月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2021/02/">二月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2020/12/">十二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2020/11/">十一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2020/08/">八月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2020/06/">六月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2020/05/">五月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2020/04/">四月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2020/02/">二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2020/01/">一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2019/12/">十二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2019/11/">十一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2019/10/">十月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2019/08/">八月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2019/07/">七月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2019/06/">六月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2019/05/">五月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2019/04/">四月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2019/03/">三月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2019/02/">二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2019/01/">一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2018/12/">十二月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2018/11/">十一月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2018/09/">九月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2018/08/">八月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2018/07/">七月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2018/06/">六月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2018/05/">五月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2018/04/">四月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2018/03/">三月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2017/11/">十一月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2017/10/">十月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2017/08/">八月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2017/07/">七月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2017/06/">六月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2017/05/">五月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/helloworld/archives/2017/04/">四月 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/helloworld/wsl.html">wsl</a>
          </li>
        
          <li>
            <a href="/helloworld/android-webview.html">Android Webview</a>
          </li>
        
          <li>
            <a href="/helloworld/android-constraintlayout.html">Android ConstraintLayout</a>
          </li>
        
          <li>
            <a href="/helloworld/android-media.html">Android Media</a>
          </li>
        
          <li>
            <a href="/helloworld/android-fragment.html">Android Fragment</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 He Fengbao<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/helloworld/" class="mobile-nav-link">Home</a>
  
    <a href="/helloworld/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/helloworld/about" class="mobile-nav-link">About</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/helloworld/fancybox/jquery.fancybox.css">

  
<script src="/helloworld/fancybox/jquery.fancybox.pack.js"></script>




<script src="/helloworld/js/script.js"></script>




  </div>
</body>
</html>